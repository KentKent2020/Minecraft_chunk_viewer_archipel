!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("deck"),require("h3"),require("s2Geometry")):"function"==typeof define&&define.amd?define(["deck","h3","s2Geometry"],t):"object"==typeof exports?exports.deck=t(require("deck"),require("h3"),require("s2Geometry")):e.deck=t(e.deck,e.h3,e.s2Geometry)}(window,(function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=72)}([function(e,t,r){"use strict";var n=r(49);r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return n.b})),r.d(t,"c",(function(){return n.c})),r.d(t,"d",(function(){return n.d})),r.d(t,"e",(function(){return n.e})),r.d(t,"f",(function(){return n.f})),r.d(t,"g",(function(){return n.g})),r.d(t,"h",(function(){return n.h})),r.d(t,"i",(function(){return n.i})),r.d(t,"j",(function(){return n.j})),r.d(t,"k",(function(){return n.k})),r.d(t,"l",(function(){return n.l})),r.d(t,"m",(function(){return n.m})),r.d(t,"n",(function(){return n.n})),r.d(t,"o",(function(){return n.o}))},function(e,t,r){e.exports=r(80)},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a}));var n=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,a=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",(function(){return n}))},function(t,r){t.exports=e},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s}));var n=r(7);function i(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function a(e,t,r){if(n.b.debug&&!function(e,t){if(e.length!==t)return!1;for(var r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(""|r," some fields set to invalid numbers'"));return e}var o={};function s(e,t){o[e]||(o[e]=!0,console.warn("".concat(e," has been removed in version ").concat(t,", see upgrade guide for more information")))}},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"h",(function(){return h})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return f})),r.d(t,"g",(function(){return d})),r.d(t,"d",(function(){return y}));r(10),r(39),r(28),r(26);var n=1/Math.PI*180,i=1/180*Math.PI,a={};function o(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,r=void 0===t?a.precision||4:t;return e=function(e){return Math.round(e/a.EPSILON)*a.EPSILON}(e),"".concat(parseFloat(e.toPrecision(r)))}function s(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&void 0!==e.length}function u(e,t,r){if(s(e)){r=r||((i=e).clone?i.clone():new Array(i.length));for(var n=0;n<r.length&&n<e.length;++n)r[n]=t(e[n],n,r);return r}var i;return t(e)}function c(e){return function(e,t){return u(e,(function(e){return e*i}),t)}(e)}function h(e){return l(e)}function l(e,t){return u(e,(function(e){return e*n}),t)}function f(e,t,r){return u(e,(function(e){return Math.max(t,Math.min(r,e))}))}function d(e,t,r){return s(e)?e.map((function(e,n){return d(e,t[n],r)})):r*t+(1-r)*e}function y(e,t,r){var n=a.EPSILON;r&&(a.EPSILON=r);try{if(e===t)return!0;if(s(e)&&s(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!y(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):!(!Number.isFinite(e)||!Number.isFinite(t))&&Math.abs(e-t)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{a.EPSILON=n}}a.EPSILON=1e-12,a.debug=!1,a.precision=4,a.printTypes=!1,a.printDegrees=!1,a.printRowMajor=!0},function(e,t,r){"use strict";r.d(t,"q",(function(){return i})),r.d(t,"f",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"h",(function(){return s})),r.d(t,"p",(function(){return u})),r.d(t,"o",(function(){return c})),r.d(t,"k",(function(){return h})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return f})),r.d(t,"n",(function(){return d})),r.d(t,"e",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return p})),r.d(t,"j",(function(){return g})),r.d(t,"i",(function(){return m})),r.d(t,"g",(function(){return b})),r.d(t,"b",(function(){return w}));var n=r(3);function i(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function a(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],d=t[11],y=t[12],v=t[13],p=t[14],g=t[15],m=r*s-n*o,b=r*u-i*o,w=r*c-a*o,O=n*u-i*s,_=n*c-a*s,k=i*c-a*u,x=h*v-l*y,T=h*p-f*y,E=h*g-d*y,S=l*p-f*v,j=l*g-d*v,M=f*g-d*p,P=m*M-b*j+w*S+O*E-_*T+k*x;return P?(P=1/P,e[0]=(s*M-u*j+c*S)*P,e[1]=(i*j-n*M-a*S)*P,e[2]=(v*k-p*_+g*O)*P,e[3]=(f*_-l*k-d*O)*P,e[4]=(u*E-o*M-c*T)*P,e[5]=(r*M-i*E+a*T)*P,e[6]=(p*w-y*k-g*b)*P,e[7]=(h*k-f*w+d*b)*P,e[8]=(o*j-s*E+c*x)*P,e[9]=(n*E-r*j-a*x)*P,e[10]=(y*_-v*w+g*m)*P,e[11]=(l*w-h*_-d*m)*P,e[12]=(s*T-o*S-u*x)*P,e[13]=(r*S-n*T+i*x)*P,e[14]=(v*b-y*O-p*m)*P,e[15]=(h*O-l*b+f*m)*P,e):null}function o(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],h=e[9],l=e[10],f=e[11],d=e[12],y=e[13],v=e[14],p=e[15];return(t*o-r*a)*(l*p-f*v)-(t*s-n*a)*(h*p-f*y)+(t*u-i*a)*(h*v-l*y)+(r*s-n*o)*(c*p-f*d)-(r*u-i*o)*(c*v-l*d)+(n*u-i*s)*(c*y-h*d)}function s(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],y=t[11],v=t[12],p=t[13],g=t[14],m=t[15],b=r[0],w=r[1],O=r[2],_=r[3];return e[0]=b*n+w*s+O*l+_*v,e[1]=b*i+w*u+O*f+_*p,e[2]=b*a+w*c+O*d+_*g,e[3]=b*o+w*h+O*y+_*m,b=r[4],w=r[5],O=r[6],_=r[7],e[4]=b*n+w*s+O*l+_*v,e[5]=b*i+w*u+O*f+_*p,e[6]=b*a+w*c+O*d+_*g,e[7]=b*o+w*h+O*y+_*m,b=r[8],w=r[9],O=r[10],_=r[11],e[8]=b*n+w*s+O*l+_*v,e[9]=b*i+w*u+O*f+_*p,e[10]=b*a+w*c+O*d+_*g,e[11]=b*o+w*h+O*y+_*m,b=r[12],w=r[13],O=r[14],_=r[15],e[12]=b*n+w*s+O*l+_*v,e[13]=b*i+w*u+O*f+_*p,e[14]=b*a+w*c+O*d+_*g,e[15]=b*o+w*h+O*y+_*m,e}function u(e,t,r){var n,i,a,o,s,u,c,h,l,f,d,y,v=r[0],p=r[1],g=r[2];return t===e?(e[12]=t[0]*v+t[4]*p+t[8]*g+t[12],e[13]=t[1]*v+t[5]*p+t[9]*g+t[13],e[14]=t[2]*v+t[6]*p+t[10]*g+t[14],e[15]=t[3]*v+t[7]*p+t[11]*g+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],y=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=c,e[7]=h,e[8]=l,e[9]=f,e[10]=d,e[11]=y,e[12]=n*v+s*p+l*g+t[12],e[13]=i*v+u*p+f*g+t[13],e[14]=a*v+c*p+d*g+t[14],e[15]=o*v+h*p+y*g+t[15]),e}function c(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function h(e,t,r,i){var a,o,s,u,c,h,l,f,d,y,v,p,g,m,b,w,O,_,k,x,T,E,S,j,M=i[0],P=i[1],L=i[2],A=Math.hypot(M,P,L);return A<n.b?null:(M*=A=1/A,P*=A,L*=A,a=Math.sin(r),s=1-(o=Math.cos(r)),u=t[0],c=t[1],h=t[2],l=t[3],f=t[4],d=t[5],y=t[6],v=t[7],p=t[8],g=t[9],m=t[10],b=t[11],w=M*M*s+o,O=P*M*s+L*a,_=L*M*s-P*a,k=M*P*s-L*a,x=P*P*s+o,T=L*P*s+M*a,E=M*L*s+P*a,S=P*L*s-M*a,j=L*L*s+o,e[0]=u*w+f*O+p*_,e[1]=c*w+d*O+g*_,e[2]=h*w+y*O+m*_,e[3]=l*w+v*O+b*_,e[4]=u*k+f*x+p*T,e[5]=c*k+d*x+g*T,e[6]=h*k+y*x+m*T,e[7]=l*k+v*x+b*T,e[8]=u*E+f*S+p*j,e[9]=c*E+d*S+g*j,e[10]=h*E+y*S+m*j,e[11]=l*E+v*S+b*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function l(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],h=t[9],l=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+c*n,e[5]=o*i+h*n,e[6]=s*i+l*n,e[7]=u*i+f*n,e[8]=c*i-a*n,e[9]=h*i-o*n,e[10]=l*i-s*n,e[11]=f*i-u*n,e}function f(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],c=t[8],h=t[9],l=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-c*n,e[1]=o*i-h*n,e[2]=s*i-l*n,e[3]=u*i-f*n,e[8]=a*n+c*i,e[9]=o*n+h*i,e[10]=s*n+l*i,e[11]=u*n+f*i,e}function d(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],c=t[4],h=t[5],l=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+c*n,e[1]=o*i+h*n,e[2]=s*i+l*n,e[3]=u*i+f*n,e[4]=c*i-a*n,e[5]=h*i-o*n,e[6]=l*i-s*n,e[7]=f*i-u*n,e}function y(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(u,c,h),e}function v(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,c=r*o,h=n*o,l=n*s,f=i*o,d=i*s,y=i*u,v=a*o,p=a*s,g=a*u;return e[0]=1-l-y,e[1]=h+g,e[2]=f-p,e[3]=0,e[4]=h-g,e[5]=1-c-y,e[6]=d+v,e[7]=0,e[8]=f+p,e[9]=d-v,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function p(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),c=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*c,e[15]=0,e}function g(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function m(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),c=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*c,e[15]=1,e}function b(e,t,r,i){var a,o,s,u,c,h,l,f,d,y,v=t[0],p=t[1],g=t[2],m=i[0],b=i[1],w=i[2],O=r[0],_=r[1],k=r[2];return Math.abs(v-O)<n.b&&Math.abs(p-_)<n.b&&Math.abs(g-k)<n.b?function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(e):(l=v-O,f=p-_,d=g-k,a=b*(d*=y=1/Math.hypot(l,f,d))-w*(f*=y),o=w*(l*=y)-m*d,s=m*f-b*l,(y=Math.hypot(a,o,s))?(a*=y=1/y,o*=y,s*=y):(a=0,o=0,s=0),u=f*s-d*o,c=d*a-l*s,h=l*o-f*a,(y=Math.hypot(u,c,h))?(u*=y=1/y,c*=y,h*=y):(u=0,c=0,h=0),e[0]=a,e[1]=u,e[2]=l,e[3]=0,e[4]=o,e[5]=c,e[6]=f,e[7]=0,e[8]=s,e[9]=h,e[10]=d,e[11]=0,e[12]=-(a*v+o*p+s*g),e[13]=-(u*v+c*p+h*g),e[14]=-(l*v+f*p+d*g),e[15]=1,e)}function w(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],y=e[11],v=e[12],p=e[13],g=e[14],m=e[15],b=t[0],w=t[1],O=t[2],_=t[3],k=t[4],x=t[5],T=t[6],E=t[7],S=t[8],j=t[9],M=t[10],P=t[11],L=t[12],A=t[13],N=t[14],I=t[15];return Math.abs(r-b)<=n.b*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=n.b*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-O)<=n.b*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(o-_)<=n.b*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-k)<=n.b*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(u-x)<=n.b*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-T)<=n.b*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-E)<=n.b*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(l-S)<=n.b*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(f-j)<=n.b*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(d-M)<=n.b*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(y-P)<=n.b*Math.max(1,Math.abs(y),Math.abs(P))&&Math.abs(v-L)<=n.b*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(p-A)<=n.b*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(g-N)<=n.b*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(m-I)<=n.b*Math.max(1,Math.abs(m),Math.abs(I))}},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return u})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return h})),r.d(t,"n",(function(){return l})),r.d(t,"m",(function(){return f})),r.d(t,"o",(function(){return d})),r.d(t,"j",(function(){return y})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return p})),r.d(t,"a",(function(){return g})),r.d(t,"f",(function(){return b}));var n=r(3);function i(){var e=new n.a(3);return n.a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function a(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)}function o(e,t,r){var i=new n.a(3);return i[0]=e,i[1]=t,i[2]=r,i}function s(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function u(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function c(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function h(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e}function l(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}function f(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function d(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=t[0],u=t[1],c=t[2],h=i*c-a*u,l=a*s-n*c,f=n*u-i*s,d=i*f-a*l,y=a*h-n*f,v=n*l-i*h,p=2*o;return h*=p,l*=p,f*=p,d*=2,y*=2,v*=2,e[0]=s+h+d,e[1]=u+l+y,e[2]=c+f+v,e}function y(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function v(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function p(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function g(e,t){var r=o(e[0],e[1],e[2]),n=o(t[0],t[1],t[2]);u(r,r),u(n,n);var i=c(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}var m,b=a;m=i()},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"l",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"k",(function(){return c})),r.d(t,"h",(function(){return h})),r.d(t,"m",(function(){return l})),r.d(t,"j",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"i",(function(){return y})),r.d(t,"n",(function(){return v})),r.d(t,"o",(function(){return p})),r.d(t,"f",(function(){return g})),r.d(t,"e",(function(){return m}));var n=r(3);function i(e){var t=new n.a(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,r,i){var a=new n.a(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function u(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function c(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function h(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function l(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function f(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o,e}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function y(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e}function v(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function p(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*a-u*i,l=c*i+u*n-o*a,f=c*a+o*i-s*n,d=-o*n-s*i-u*a;return e[0]=h*c+d*-o+l*-u-f*-s,e[1]=l*c+d*-s+f*-o-h*-u,e[2]=f*c+d*-u+h*-s-l*-o,e[3]=t[3],e}function g(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function m(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],u=t[1],c=t[2],h=t[3];return Math.abs(r-s)<=n.b*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=n.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=n.b*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=n.b*Math.max(1,Math.abs(o),Math.abs(h))}var b,w;b=new n.a(4),n.a!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0),w=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(10),i=r(37);function a(e,t){return!t||"object"!==Object(n.a)(t)&&"function"!=typeof t?Object(i.a)(e):t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(n.a)(e,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return h})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return f})),r.d(t,"f",(function(){return v}));var n=r(3);function i(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function a(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function o(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function s(e,t){return e[0]=-t[0],e[1]=-t[1],e}function u(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}function c(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function h(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function l(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function f(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}var d,y,v=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e};d=new n.a(2),n.a!=Float32Array&&(d[0]=0,d[1]=0),y=d},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},,function(e,t,r){var n=r(44),i=r(74);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?i(e):t}},function(e,t,r){var n=r(76);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){var n=r(77),i=r(78),a=r(79);e.exports=function(e,t){return n(e)||i(e,t)||a()}},function(e,r){e.exports=t},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"i",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"h",(function(){return c})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return l})),r.d(t,"c",(function(){return f}));var n=r(3);function i(){var e=new n.a(9);return n.a!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function a(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function o(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=h*o-s*c,f=-h*a+s*u,d=c*a-o*u,y=r*l+n*f+i*d;return y?(y=1/y,e[0]=l*y,e[1]=(-h*n+i*c)*y,e[2]=(s*n-i*o)*y,e[3]=f*y,e[4]=(h*r-i*u)*y,e[5]=(-s*r+i*a)*y,e[6]=d*y,e[7]=(-c*r+n*u)*y,e[8]=(o*r-n*a)*y,e):null}function s(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*(c*a-o*u)+r*(-c*i+o*s)+n*(u*i-a*s)}function u(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=r[0],d=r[1],y=r[2],v=r[3],p=r[4],g=r[5],m=r[6],b=r[7],w=r[8];return e[0]=f*n+d*o+y*c,e[1]=f*i+d*s+y*h,e[2]=f*a+d*u+y*l,e[3]=v*n+p*o+g*c,e[4]=v*i+p*s+g*h,e[5]=v*a+p*u+g*l,e[6]=m*n+b*o+w*c,e[7]=m*i+b*s+w*h,e[8]=m*a+b*u+w*l,e}function c(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=f*n+d*o+c,e[7]=f*i+d*s+h,e[8]=f*a+d*u+l,e}function h(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=Math.sin(r),d=Math.cos(r);return e[0]=d*n+f*o,e[1]=d*i+f*s,e[2]=d*a+f*u,e[3]=d*o-f*n,e[4]=d*s-f*i,e[5]=d*u-f*a,e[6]=c,e[7]=h,e[8]=l,e}function l(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function f(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,c=r*o,h=n*o,l=n*s,f=i*o,d=i*s,y=i*u,v=a*o,p=a*s,g=a*u;return e[0]=1-l-y,e[3]=h-g,e[6]=f+p,e[1]=h+g,e[4]=1-c-y,e[7]=d-v,e[2]=f-p,e[5]=d+v,e[8]=1-c-l,e}},function(e,t,r){"use strict";function n(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(e,t,r){var n=t[0],i=t[1],a=r[3]*n+r[7]*i||1;return e[0]=(r[0]*n+r[4]*i)/a,e[1]=(r[1]*n+r[5]*i)/a,e}function i(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a||1;return e[0]=(r[0]*n+r[4]*i+r[8]*a)/o,e[1]=(r[1]*n+r[5]*i+r[9]*a)/o,e[2]=(r[2]*n+r[6]*i+r[10]*a)/o,e}function a(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e[2]=t[2],e}function o(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=r[0]*n+r[3]*i+r[6]*a,e[1]=r[1]*n+r[4]*i+r[7]*a,e[2]=r[2]*n+r[5]*i+r[8]*a,e[3]=t[3],e}r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return o}))},function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(t,"a",(function(){return n}))},,function(e,t,r){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(30);var c=r(39);function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Object(c.a)(e,arguments,Object(o.a)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object(u.a)(n,e)})(e)}var l=r(7);r.d(t,"a",(function(){return f}));var f=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}},{key:"to",value:function(e){return e===this?this:Object(l.f)(e)?this.toArray(e):this.toObject(e)}},{key:"toTarget",value:function(e){return e?this.to(e):this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(l.b)}},{key:"formatString",value:function(e){for(var t="",r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+Object(l.e)(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}},{key:"equals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(!Object(l.d)(this[t],e[t]))return!1;return!0}},{key:"exactEquals",value:function(e){if(!e||this.length!==e.length)return!1;for(var t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}},{key:"negate",value:function(){for(var e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}},{key:"lerp",value:function(e,t,r){void 0===r&&(r=t,t=e,e=this);for(var n=0;n<this.ELEMENTS;++n){var i=e[n];this[n]=i+r*(t[n]-i)}return this.check()}},{key:"min",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}},{key:"max",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}},{key:"clamp",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var a=i[n],o=0;o<this.ELEMENTS;++o)this[o]+=a[o];return this.check()}},{key:"subtract",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var a=i[n],o=0;o<this.ELEMENTS;++o)this[o]-=a[o];return this.check()}},{key:"scale",value:function(e){if(Array.isArray(e))return this.multiply(e);for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"sub",value:function(e){return this.subtract(e)}},{key:"setScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}},{key:"addScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}},{key:"subScalar",value:function(e){return this.addScalar(-e)}},{key:"multiplyScalar",value:function(e){for(var t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}},{key:"divideScalar",value:function(e){return this.scale(1/e)}},{key:"clampScalar",value:function(e,t){for(var r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}},{key:"multiplyByScalar",value:function(e){return this.scale(e)}},{key:"check",value:function(){if(l.b.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var e=this.length===this.ELEMENTS,t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}},{key:"elements",get:function(){return this}}]),t}(h(Array))},function(e,t,r){var n=r(75);function i(t,r,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,r){var i=n(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(r):a.value}},i(t,r,a||t)}e.exports=i},function(e,t,r){"use strict";(function(e,n){r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var i=r(10),a={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e,document:"undefined"!=typeof document&&document},o=a.global||a.self||a.window,s="object"!==(void 0===n?"undefined":Object(i.a)(n))||"[object process]"!==String(n)||n.browser,u=void 0!==n&&n.version&&n.version.match(/v([0-9]*)/);u&&parseFloat(u[1])}).call(this,r(38),r(43))},function(e,t){e.exports=r},,function(e,t,r){"use strict";(function(e){function n(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var r=e.hrtime();t=1e3*r[0]+r[1]/1e6}else t=Date.now();return t}r.d(t,"a",(function(){return n}))}).call(this,r(43))},function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",(function(){return n}))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(30);function i(e,t,r){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return r&&Object(n.a)(a,r.prototype),a}).apply(null,arguments)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(31),c=r(6),h=r(26),l=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var e=0,t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(e){return Math.sqrt(this.distanceSquared(e))}},{key:"distanceSquared",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r){var n=this[r]-e[r];t+=n*n}return Object(c.a)(t)}},{key:"dot",value:function(e){for(var t=0,r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return Object(c.a)(t)}},{key:"normalize",value:function(){var e=this.magnitude();if(0!==e)for(var t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}},{key:"multiply",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var a=i[n],o=0;o<this.ELEMENTS;++o)this[o]*=a[o];return this.check()}},{key:"divide",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++)for(var a=i[n],o=0;o<this.ELEMENTS;++o)this[o]/=a[o];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(e){return this.distance(e)}},{key:"distanceToSquared",value:function(e){return this.distanceSquared(e)}},{key:"getComponent",value:function(e){return Object(h.a)(e>=0&&e<this.ELEMENTS,"index is out of range"),Object(c.a)(this[e])}},{key:"setComponent",value:function(e,t){return Object(h.a)(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}},{key:"addVectors",value:function(e,t){return this.copy(e).add(t)}},{key:"subVectors",value:function(e,t){return this.copy(e).subtract(t)}},{key:"multiplyVectors",value:function(e,t){return this.copy(e).multiply(t)}},{key:"addScaledVector",value:function(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=Object(c.a)(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=Object(c.a)(e)}}]),t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(31),c=r(6),h=r(7),l=function(e){function t(){return Object(n.a)(this,t),Object(a.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"toString",value:function(){var e="[";if(h.b.printRowMajor){e+="row-major:";for(var t=0;t<this.RANK;++t)for(var r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+t])}else{e+="column-major:";for(var n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]"}},{key:"getElementIndex",value:function(e,t){return t*this.RANK+e}},{key:"getElement",value:function(e,t){return this[t*this.RANK+e]}},{key:"setElement",value:function(e,t,r){return this[t*this.RANK+e]=Object(c.a)(r),this}},{key:"getColumn",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),r=e*this.RANK,n=0;n<this.RANK;++n)t[n]=this[r+n];return t}},{key:"setColumn",value:function(e,t){for(var r=e*this.RANK,n=0;n<this.RANK;++n)this[r+n]=t[n];return this}}]),t}(u.a)},,function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,c=[],h=!1,l=-1;function f(){h&&u&&(h=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!h){var e=s(f);h=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new y(e,t)),1!==c.length||h||s(d)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(t)}e.exports=n},function(e,t){function r(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)}))}}},function(e,t){},,,function(e,t,r){"use strict";(function(e){var n=r(0),i=r(50);r.d(t,"d",(function(){return i.a}));var a=r(51);r.d(t,"e",(function(){return a.a}));var o=r(52);r.d(t,"a",(function(){return o.a}));var s=r(53);r.d(t,"b",(function(){return s.a}));var u=r(55);r.d(t,"c",(function(){return u.a}));var c=r(7);r.d(t,"i",(function(){return c.b})),r.d(t,"l",(function(){return c.f})),r.d(t,"k",(function(){return c.d})),r.d(t,"o",(function(){return c.i})),r.d(t,"n",(function(){return c.h})),r.d(t,"j",(function(){return c.c})),r.d(t,"h",(function(){return c.a})),r.d(t,"m",(function(){return c.g}));var h=r(54);r.d(t,"f",(function(){return h.a}));var l=r(26);r.d(t,"g",(function(){return l.a}));var f={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==e&&e};(f.global||f.self||f.window).mathgl={config:n.i}}).call(this,r(38))},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(40),c=r(7),h=r(6),l=r(16),f=r(27),d=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(n.a)(this,t),e=Object(a.a)(this,Object(o.a)(t).call(this,2)),Object(c.f)(r)&&1===arguments.length?e.copy(r):(c.b.debug&&(Object(h.a)(r),Object(h.a)(i)),e[0]=r,e[1]=i),e}return Object(s.a)(t,e),Object(i.a)(t,[{key:"set",value:function(e,t,r){return this[0]=e,this[1]=t,this.check()}},{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this.check()}},{key:"fromObject",value:function(e){return c.b.debug&&(Object(h.a)(e.x),Object(h.a)(e.y)),this[0]=e.x,this[1]=e.y,this.check()}},{key:"toObject",value:function(e){return e.x=this[0],e.y=this[1],e}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(e){return this.transformAsPoint(e)}},{key:"transformAsPoint",value:function(e){return l.j(this,this,e),this.check()}},{key:"transformAsVector",value:function(e){return Object(f.a)(this,this,e),this.check()}},{key:"transformByMatrix3",value:function(e){return l.i(this,this,e),this.check()}},{key:"transformByMatrix2x3",value:function(e){return l.h(this,this,e),this.check()}},{key:"transformByMatrix2",value:function(e){return l.g(this,this,e),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(40),c=r(7),h=r(6),l=r(9),f=r(27),d=[0,0,0],y=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(n.a)(this,t),e=Object(a.a)(this,Object(o.a)(t).call(this,-0,-0,-0)),1===arguments.length&&Object(c.f)(r)?e.copy(r):(c.b.debug&&(Object(h.a)(r),Object(h.a)(i),Object(h.a)(s)),e[0]=r,e[1]=i,e[2]=s),e}return Object(s.a)(t,e),Object(i.a)(t,[{key:"set",value:function(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}},{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}},{key:"fromObject",value:function(e){return c.b.debug&&(Object(h.a)(e.x),Object(h.a)(e.y),Object(h.a)(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}},{key:"toObject",value:function(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}},{key:"angle",value:function(e){return l.a(this,e)}},{key:"cross",value:function(e){return l.c(this,this,e),this.check()}},{key:"rotateX",value:function(e){var t=e.radians,r=e.origin,n=void 0===r?d:r;return l.j(this,this,n,t),this.check()}},{key:"rotateY",value:function(e){var t=e.radians,r=e.origin,n=void 0===r?d:r;return l.k(this,this,n,t),this.check()}},{key:"rotateZ",value:function(e){var t=e.radians,r=e.origin,n=void 0===r?d:r;return l.l(this,this,n,t),this.check()}},{key:"transform",value:function(e){return this.transformAsPoint(e)}},{key:"transformAsPoint",value:function(e){return l.n(this,this,e),this.check()}},{key:"transformAsVector",value:function(e){return Object(f.c)(this,this,e),this.check()}},{key:"transformByMatrix3",value:function(e){return l.m(this,this,e),this.check()}},{key:"transformByMatrix2",value:function(e){return Object(f.b)(this,this,e),this.check()}},{key:"transformByQuaternion",value:function(e){return l.o(this,this,e),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=Object(h.a)(e)}}]),t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(4),i=r(14),a=r(12),o=r(2),s=r(15),u=r(41),c=r(6),h=r(27),l=r(25),f=r(16),d=r(9),y=Object.freeze([1,0,0,0,1,0,0,0,1]),v=Object.freeze([0,0,0,0,0,0,0,0,0]),p=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),g={},m=function(e){function t(e){var r;return Object(n.a)(this,t),r=Object(i.a)(this,Object(a.a)(t).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(e)?r.copy(e):r.identity(),r}return Object(s.a)(t,e),Object(o.a)(t,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return p}}],[{key:"IDENTITY",get:function(){return g.IDENTITY=g.IDENTITY||Object.freeze(new t(y)),g.IDENTITY}},{key:"ZERO",get:function(){return g.ZERO=g.ZERO||Object.freeze(new t(v)),g.ZERO}}]),Object(o.a)(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}},{key:"set",value:function(e,t,r,n,i,a,o,s,u){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=u,this.check()}},{key:"setRowMajor",value:function(e,t,r,n,i,a,o,s,u){return this[0]=e,this[1]=n,this[2]=o,this[3]=t,this[4]=i,this[5]=s,this[6]=r,this[7]=a,this[8]=u,this.check()}},{key:"determinant",value:function(){return l.b(this)}},{key:"identity",value:function(){return this.copy(y)}},{key:"fromQuaternion",value:function(e){return l.c(this,e),this.check()}},{key:"transpose",value:function(){return l.i(this,this),this.check()}},{key:"invert",value:function(){return l.d(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return l.e(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return l.e(this,this,e),this.check()}},{key:"rotate",value:function(e){return l.f(this,this,e),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?l.g(this,this,e):l.g(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return l.h(this,this,e),this.check()}},{key:"transform",value:function(e,t){switch(e.length){case 2:t=f.i(t||[-0,-0],e,this);break;case 3:t=d.m(t||[-0,-0,-0],e,this);break;case 4:t=Object(h.d)(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(t,e.length),t}},{key:"transformVector",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector2",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector3",value:function(e,t){return Object(c.c)("Matrix3.transformVector"),this.transform(e,t)}}]),t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r(11),i=r(4),a=r(14),o=r(12),s=r(2),u=r(15),c=r(6),h=r(41),l=r(27),f=r(8),d=r(16),y=r(9),v=r(13),p=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),g=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),m=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),b={},w=function(e){function t(e){var r;return Object(i.a)(this,t),r=Object(a.a)(this,Object(o.a)(t).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(e)?r.copy(e):r.identity(),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"INDICES",get:function(){return m}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return b.IDENTITY=b.IDENTITY||Object.freeze(new t(p)),b.IDENTITY}},{key:"ZERO",get:function(){return b.ZERO=b.ZERO||Object.freeze(new t(g)),b.ZERO}}]),Object(s.a)(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}},{key:"set",value:function(e,t,r,n,i,a,o,s,u,c,h,l,f,d,y,v){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=u,this[9]=c,this[10]=h,this[11]=l,this[12]=f,this[13]=d,this[14]=y,this[15]=v,this.check()}},{key:"setRowMajor",value:function(e,t,r,n,i,a,o,s,u,c,h,l,f,d,y,v){return this[0]=e,this[1]=i,this[2]=u,this[3]=f,this[4]=t,this[5]=a,this[6]=c,this[7]=d,this[8]=r,this[9]=o,this[10]=h,this[11]=y,this[12]=n,this[13]=s,this[14]=l,this[15]=v,this.check()}},{key:"toRowMajor",value:function(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}},{key:"identity",value:function(){return this.copy(p)}},{key:"fromQuaternion",value:function(e){return f.c(this,e),this.check()}},{key:"frustum",value:function(e){var r=e.left,n=e.right,i=e.bottom,a=e.top,o=e.near,s=e.far;return s===1/0?t._computeInfinitePerspectiveOffCenter(this,r,n,i,a,o):f.d(this,r,n,i,a,o,s),this.check()}},{key:"lookAt",value:function(e,t,r){if(1===arguments.length){var n=e;e=n.eye,t=n.center,r=n.up}return t=t||[0,0,0],r=r||[0,1,0],f.g(this,e,t,r),this.check()}},{key:"ortho",value:function(e){var t=e.left,r=e.right,n=e.bottom,i=e.top,a=e.near,o=void 0===a?.1:a,s=e.far,u=void 0===s?500:s;return f.i(this,t,r,n,i,o,u),this.check()}},{key:"orthographic",value:function(e){var r=e.fovy,n=void 0===r?45*Math.PI/180:r,i=e.aspect,a=void 0===i?1:i,o=e.focalDistance,s=void 0===o?1:o,u=e.near,c=void 0===u?.1:u,h=e.far,l=void 0===h?500:h;if(n>2*Math.PI)throw Error("radians");var f=n/2,d=s*Math.tan(f),y=d*a;return(new t).ortho({left:-y,right:y,bottom:-d,top:d,near:c,far:l})}},{key:"perspective",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fovy,r=e.fov,n=void 0===r?45*Math.PI/180:r,i=e.aspect,a=void 0===i?1:i,o=e.near,s=void 0===o?.1:o,u=e.far,c=void 0===u?500:u;if((t=t||n)>2*Math.PI)throw Error("radians");return f.j(this,t,a,s,c),this.check()}},{key:"determinant",value:function(){return f.a(this)}},{key:"getScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}},{key:"getTranslation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}},{key:"getRotation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],a=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*i,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*i,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"getRotationMatrix3",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getScale(t||[-0,-0,-0]),n=1/r[0],i=1/r[1],a=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*i,e[2]=this[2]*a,e[3]=this[4]*n,e[4]=this[5]*i,e[5]=this[6]*a,e[6]=this[8]*n,e[7]=this[9]*i,e[8]=this[10]*a,e}},{key:"transpose",value:function(){return f.q(this,this),this.check()}},{key:"invert",value:function(){return f.f(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return f.h(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return f.h(this,this,e),this.check()}},{key:"rotateX",value:function(e){return f.l(this,this,e),this.check()}},{key:"rotateY",value:function(e){return f.m(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return f.n(this,this,e),this.check()}},{key:"rotateXYZ",value:function(e){var t=Object(n.a)(e,3),r=t[0],i=t[1],a=t[2];return this.rotateX(r).rotateY(i).rotateZ(a)}},{key:"rotateAxis",value:function(e,t){return f.k(this,this,e,t),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?f.o(this,this,e):f.o(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return f.p(this,this,e),this.check()}},{key:"transform",value:function(e,t){return 4===e.length?(t=v.n(t||[-0,-0,-0,-0],e,this),Object(c.b)(t,4),t):this.transformAsPoint(e,t)}},{key:"transformAsPoint",value:function(e,t){switch(e.length){case 2:t=d.j(t||[-0,-0],e,this);break;case 3:t=y.n(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(t,e.length),t}},{key:"transformAsVector",value:function(e,t){switch(e.length){case 2:t=Object(l.a)(t||[-0,-0],e,this);break;case 3:t=Object(l.c)(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(t,e.length),t}},{key:"makeRotationX",value:function(e){return this.identity().rotateX(e)}},{key:"makeTranslation",value:function(e,t,r){return this.identity().translate([e,t,r])}},{key:"transformPoint",value:function(e,t){return Object(c.c)("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}},{key:"transformVector",value:function(e,t){return Object(c.c)("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}},{key:"transformDirection",value:function(e,t){return Object(c.c)("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(e,t,r,n,i,a){var o=2*a/(r-t),s=2*a/(i-n),u=(r+t)/(r-t),c=(i+n)/(i-n),h=-2*a;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=u,e[9]=c,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=h,e[15]=0,e}}]),t}(h.a)},function(e,t,r){"use strict";t.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},function(e,t,r){"use strict";var n=r(4),i=r(2),a=r(14),o=r(12),s=r(15),u=r(31),c=r(6),h=r(26),l=r(3),f=r(25),d=r(9),y=r(13);function v(){var e=new l.a(4);return l.a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function p(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function g(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],c=r[2],h=r[3];return e[0]=n*h+o*s+i*c-a*u,e[1]=i*h+o*u+a*s-n*c,e[2]=a*h+o*c+n*u-i*s,e[3]=o*h-n*s-i*u-a*c,e}function m(e,t,r,n){var i,a,o,s,u,c=t[0],h=t[1],f=t[2],d=t[3],y=r[0],v=r[1],p=r[2],g=r[3];return(a=c*y+h*v+f*p+d*g)<0&&(a=-a,y=-y,v=-v,p=-p,g=-g),1-a>l.b?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,u=Math.sin(n*i)/o):(s=1-n,u=n),e[0]=s*c+u*y,e[1]=s*h+u*v,e[2]=s*f+u*p,e[3]=s*d+u*g,e}function b(e,t){var r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*a+o]-t[3*o+a])*r,e[a]=(t[3*a+i]+t[3*i+a])*r,e[o]=(t[3*o+i]+t[3*i+o])*r}return e}y.b,y.g,y.c,y.l;var w,O,_,k,x,T,E=y.a,S=y.k,j=y.d,M=y.i,P=y.h,L=y.m,A=y.j,N=(y.f,y.e,w=d.b(),O=d.e(1,0,0),_=d.e(0,1,0),function(e,t,r){var n=d.d(t,r);return n<-.999999?(d.c(w,O,t),d.f(w)<1e-6&&d.c(w,_,t),d.i(w,w),p(e,w,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(d.c(w,t,r),e[0]=w[0],e[1]=w[1],e[2]=w[2],e[3]=1+n,A(e,e))});k=v(),x=v(),T=f.a();r.d(t,"a",(function(){return C}));var I=[0,0,0,1],C=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(n.a)(this,t),e=Object(a.a)(this,Object(o.a)(t).call(this,-0,-0,-0,-0)),Array.isArray(r)&&1===arguments.length?e.copy(r):e.set(r,i,s,u),e}return Object(s.a)(t,e),Object(i.a)(t,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}},{key:"set",value:function(e,t,r,n){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this.check()}},{key:"fromMatrix3",value:function(e){return b(this,e),this.check()}},{key:"identity",value:function(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}},{key:"fromAxisRotation",value:function(e,t){return p(this,e,t),this.check()}},{key:"setAxisAngle",value:function(e,t){return this.fromAxisRotation(e,t)}},{key:"len",value:function(){return P(this)}},{key:"lengthSquared",value:function(e){return L(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return j(this,e)}},{key:"rotationTo",value:function(e,t){return N(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return E(this,this,e),this.check()}},{key:"calculateW",value:function(){var e,t,r,n,i;return e=this,r=(t=this)[0],n=t[1],i=t[2],e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),this.check()}},{key:"conjugate",value:function(){var e,t;return t=this,(e=this)[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],this.check()}},{key:"invert",value:function(){var e,t,r,n,i,a,o,s;return e=this,r=(t=this)[0],n=t[1],i=t[2],a=t[3],s=(o=r*r+n*n+i*i+a*a)?1/o:0,e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,this.check()}},{key:"lerp",value:function(e,t,r){return M(this,e,t,r),this.check()}},{key:"multiplyRight",value:function(e,t){return Object(h.a)(!t),g(this,this,e),this.check()}},{key:"multiplyLeft",value:function(e,t){return Object(h.a)(!t),g(this,e,this),this.check()}},{key:"normalize",value:function(){var e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}},{key:"rotateX",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s}(this,this,e),this.check()}},{key:"scale",value:function(e){return S(this,this,e),this.check()}},{key:"slerp",value:function(e,t,r){switch(arguments.length){case 1:var n=arguments[0],i=n.start;e=void 0===i?I:i,t=n.target,r=n.ratio;break;case 2:var a=Array.prototype.slice.call(arguments);t=a[0],r=a[1],e=this}return m(this,e,t,r),this.check()}},{key:"transformVector4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return y.o(t,e,this),Object(c.b)(t,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(e,t){return this.setAxisAngle(e,t)}},{key:"premultiply",value:function(e,t){return this.multiplyLeft(e,t)}},{key:"multiply",value:function(e,t){return this.multiplyRight(e,t)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){return this[0]=Object(c.a)(e)}},{key:"y",get:function(){return this[1]},set:function(e){return this[1]=Object(c.a)(e)}},{key:"z",get:function(){return this[2]},set:function(e){return this[2]=Object(c.a)(e)}},{key:"w",get:function(){return this[3]},set:function(e){return this[3]=Object(c.a)(e)}}]),t}(u.a)},function(e,t,r){var n,i,a;
/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */i=[],void 0===(a="function"==typeof(n=function(){"use strict";function e(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var r={},n={};function i(e,t){var i,a,s;return t?(s=0<=(e>>>=0)&&e<256)&&(a=n[e])?a:(i=o(e,(0|e)<0?-1:0,!0),s&&(n[e]=i),i):(s=-128<=(e|=0)&&e<128)&&(a=r[e])?a:(i=o(e,e<0?-1:0,!1),s&&(r[e]=i),i)}function a(e,t){if(isNaN(e)||!isFinite(e))return t?v:y;if(t){if(e<0)return v;if(e>=l)return w}else{if(e<=-f)return O;if(e+1>=f)return b}return e<0?a(-e,t).neg():o(e%h|0,e/h|0,t)}function o(t,r,n){return new e(t,r,n)}e.fromInt=i,e.fromNumber=a,e.fromBits=o;var s=Math.pow;function u(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(e.substring(1),t,r).neg();for(var i=a(s(r,8)),o=y,c=0;c<e.length;c+=8){var h=Math.min(8,e.length-c),l=parseInt(e.substring(c,c+h),r);if(h<8){var f=a(s(r,h));o=o.mul(f).add(a(l))}else o=(o=o.mul(i)).add(a(l))}return o.unsigned=t,o}function c(t){return t instanceof e?t:"number"==typeof t?a(t):"string"==typeof t?u(t):o(t.low,t.high,t.unsigned)}e.fromString=u,e.fromValue=c;var h=4294967296,l=h*h,f=l/2,d=i(1<<24),y=i(0);e.ZERO=y;var v=i(0,!0);e.UZERO=v;var p=i(1);e.ONE=p;var g=i(1,!0);e.UONE=g;var m=i(-1);e.NEG_ONE=m;var b=o(-1,2147483647,!1);e.MAX_VALUE=b;var w=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=w;var O=o(0,-2147483648,!1);e.MIN_VALUE=O;var _=e.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},_.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(O)){var t=a(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=a(s(e,6),this.unsigned),o=this,u="";;){var c=o.div(i),h=(o.sub(c.mul(i)).toInt()>>>0).toString(e);if((o=c).isZero())return h+u;for(;h.length<6;)h="0"+h;u=""+h+u}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},_.isZero=function(){return 0===this.high&&0===this.low},_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return 1==(1&this.low)},_.isEven=function(){return 0==(1&this.low)},_.equals=function(e){return t(e)||(e=c(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},_.eq=_.equals,_.notEquals=function(e){return!this.eq(e)},_.neq=_.notEquals,_.lessThan=function(e){return this.comp(e)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(e){return this.comp(e)<=0},_.lte=_.lessThanOrEqual,_.greaterThan=function(e){return this.comp(e)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(e){return this.comp(e)>=0},_.gte=_.greaterThanOrEqual,_.compare=function(e){if(t(e)||(e=c(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(p)},_.neg=_.negate,_.add=function(e){t(e)||(e=c(e));var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,s=e.high>>>16,u=65535&e.high,h=e.low>>>16,l=0,f=0,d=0,y=0;return d+=(y+=a+(65535&e.low))>>>16,f+=(d+=i+h)>>>16,l+=(f+=n+u)>>>16,l+=r+s,o((d&=65535)<<16|(y&=65535),(l&=65535)<<16|(f&=65535),this.unsigned)},_.subtract=function(e){return t(e)||(e=c(e)),this.add(e.neg())},_.sub=_.subtract,_.multiply=function(e){if(this.isZero())return y;if(t(e)||(e=c(e)),e.isZero())return y;if(this.eq(O))return e.isOdd()?O:y;if(e.eq(O))return this.isOdd()?O:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(d)&&e.lt(d))return a(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,i=this.low>>>16,s=65535&this.low,u=e.high>>>16,h=65535&e.high,l=e.low>>>16,f=65535&e.low,v=0,p=0,g=0,m=0;return g+=(m+=s*f)>>>16,p+=(g+=i*f)>>>16,g&=65535,p+=(g+=s*l)>>>16,v+=(p+=n*f)>>>16,p&=65535,v+=(p+=i*l)>>>16,p&=65535,v+=(p+=s*h)>>>16,v+=r*f+n*l+i*h+s*u,o((g&=65535)<<16|(m&=65535),(v&=65535)<<16|(p&=65535),this.unsigned)},_.mul=_.multiply,_.divide=function(e){if(t(e)||(e=c(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?v:y;var r,n,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return g;i=v}else{if(this.eq(O))return e.eq(p)||e.eq(m)?O:e.eq(O)?p:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?p:m:(n=this.sub(e.mul(r)),i=r.add(n.div(e)));if(e.eq(O))return this.unsigned?v:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=y}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),u=o<=48?1:s(2,o-48),h=a(r),l=h.mul(e);l.isNegative()||l.gt(n);)l=(h=a(r-=u,this.unsigned)).mul(e);h.isZero()&&(h=p),i=i.add(h),n=n.sub(l)}return i},_.div=_.divide,_.modulo=function(e){return t(e)||(e=c(e)),this.sub(this.div(e).mul(e))},_.mod=_.modulo,_.not=function(){return o(~this.low,~this.high,this.unsigned)},_.and=function(e){return t(e)||(e=c(e)),o(this.low&e.low,this.high&e.high,this.unsigned)},_.or=function(e){return t(e)||(e=c(e)),o(this.low|e.low,this.high|e.high,this.unsigned)},_.xor=function(e){return t(e)||(e=c(e)),o(this.low^e.low,this.high^e.high,this.unsigned)},_.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?o(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):o(0,this.low<<e-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?o(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):o(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0==(e&=63))return this;var r=this.high;return e<32?o(this.low>>>e|r<<32-e,r>>>e,this.unsigned):o(32===e?r:r>>>e-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},_.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},_.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e})?n.apply(t,i):n)||(e.exports=a)},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},,,,,,,,,,,,,,,function(e,t,r){(function(t){var n=r(81),i=("undefined"==typeof window?t:window).deck||{};if(!i.LineLayer)throw new Error("@deck.gl/layers is not found");e.exports=Object.assign(i,n)}).call(this,r(38))},,function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,r){var n=r(17);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),o=new S(n||[]);return a._invoke=function(e,t,r){var n=h;return function(i,a){if(n===f)throw new Error("Generator is already running");if(n===d){if("throw"===i)throw a;return M()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=x(o,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var u=c(e,t,r);if("normal"===u.type){if(n=r.done?d:l,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(e,r,o),a}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",l="suspendedYield",f="executing",d="completed",y={};function v(){}function p(){}function g(){}var m={};m[a]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==r&&n.call(w,a)&&(m=w);var O=g.prototype=v.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function k(e){var t;this._invoke=function(r,i){function a(){return new Promise((function(t,a){!function t(r,i,a,o){var s=c(e[r],e,i);if("throw"!==s.type){var u=s.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?Promise.resolve(h.__await).then((function(e){t("next",e,a,o)}),(function(e){t("throw",e,a,o)})):Promise.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return t("throw",e,a,o)}))}o(s.arg)}(r,i,t,a)}))}return t=t?t.then(a,a):a()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=c(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function j(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:M}}function M(){return{value:t,done:!0}}return p.prototype=O.constructor=g,g.constructor=p,g[s]=p.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},_(k.prototype),k.prototype[o]=function(){return this},e.AsyncIterator=k,e.async=function(t,r,n,i){var a=new k(u(t,r,n,i));return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(O),O[s]="Generator",O[a]=function(){return this},O.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:j(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"dirname",(function(){return ht}));var i={};r.r(i),r.d(i,"decode",(function(){return Na})),r.d(i,"encode",(function(){return Ia}));var a={};r.r(a),r.d(a,"decode",(function(){return Ba})),r.d(a,"encode",(function(){return Fa}));var o={};r.r(o),r.d(o,"decode",(function(){return Va})),r.d(o,"encode",(function(){return qa}));var s=r(18),u=r.n(s),c=r(19),h=r.n(c),l=r(21),f=r.n(l),d=r(17),y=r.n(d),v=r(32),p=r.n(v),g=r(22),m=r.n(g),b=r(5),w=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"getShaders",value:function(){return Object.assign({},p()(y()(t.prototype),"getShaders",this).call(this),{vs:"#define SHADER_NAME great-circle-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) *\n    sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\n\nvec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {\n  if(abs(angularDist - PI) < 0.001) {\n    return (1.0 - t) * source + t * target;\n  }\n\n  float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n  float b = sin(t * angularDist) / sin(angularDist);\n  vec2 sin_source = sin(source);\n  vec2 cos_source = cos(source);\n  vec2 sin_target = sin(target);\n  vec2 cos_target = cos(target);\n\n  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n  float z = a * sin_source.y + b * sin_target.y;\n  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  \n  vec2 source = radians(instanceSourcePositions.xy);\n  vec2 target = radians(instanceTargetPositions.xy);\n  \n  float angularDist = getAngularDist(source, target);\n\n  vec3 currPos = vec3(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0);\n  vec3 nextPos = vec3(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0);\n\n  vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n  vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n\n  vec4 curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n  vec4 next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",modules:[b.picking,b.project32]})}}]),t}(b.ArcLayer);w.layerName="GreatCircleLayer";var O=r(23),_=r.n(O),k=r(34),x=r(56),T=r.n(x);var E=180/Math.PI,S=100;function j(e){if("string"==typeof e){if(e.indexOf("/")>0)return e;e=function(e){var t=e.padEnd(16,"0");return T.a.fromString(t,16)}(e)}return k.S2.S2Cell.toHilbertQuadkey(e.toString())}function M(e){var t=j(e);return function(e){for(var t,r,n,i,a,o,s=e.face,u=e.ij,c=e.level,h=[[0,0],[0,1],[1,1],[1,0],[0,0]],l=Math.max(1,Math.ceil(S*Math.pow(2,-c))),f=new Float64Array(4*l*2+2),d=0,y=0;y<4;y++)for(var v=h[y].slice(0),p=h[y+1],g=(p[0]-v[0])/l,m=(p[1]-v[1])/l,b=0;b<l;b++){v[0]+=g,v[1]+=m;var w=k.S2.IJToST(u,c,v),O=k.S2.STToUV(w),x=k.S2.FaceUVToXYZ(s,O),T=(t=x,r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,r=_()(t,3),n=r[0],i=r[1],a=r[2],o=Math.atan2(a,Math.sqrt(n*n+i*i)),[Math.atan2(i,n)*E,o*E]);f[d++]=T[0],f[d++]=T[1]}return f[d++]=f[0],f[d++]=f[1],f}(k.S2.S2Cell.FromHilbertQuadKey(t))}var P=Object.assign({getS2Token:{type:"accessor",value:function(e){return e.token}}},b.PolygonLayer.defaultProps),L=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"renderLayers",value:function(){var e=this.props,t=e.data,r=e.getS2Token,n=this.props,i=n.elevationScale,a=n.extruded,o=n.wireframe,s=n.filled,u=n.stroked,c=n.lineWidthUnits,h=n.lineWidthScale,l=n.lineWidthMinPixels,f=n.lineWidthMaxPixels,d=n.lineJointRounded,y=n.lineMiterLimit,v=n.lineDashJustified,p=n.getElevation,g=n.getFillColor,m=n.getLineColor,w=n.getLineWidth,O=n.getLineDashArray,_=this.props,k=_.updateTriggers,x=_.material;return new(this.getSubLayerClass("cell",b.PolygonLayer))({filled:s,wireframe:o,extruded:a,elevationScale:i,stroked:u,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:l,lineWidthMaxPixels:f,lineJointRounded:d,lineMiterLimit:y,lineDashJustified:v,material:x,getElevation:p,getFillColor:g,getLineColor:m,getLineWidth:w,getLineDashArray:O},this.getSubLayerProps({id:"cell",updateTriggers:{getElevation:k.getElevation,getFillColor:k.getFillColor,getLineColor:k.getLineColor,getLineWidth:k.getLineWidth,getLineDashArray:k.getLineDashArray}}),{data:t,_normalize:!1,positionFormat:"XY",getPolygon:function(e,t){return M(r(e,t))}})}}]),t}(b.CompositeLayer);function A(e,t,r){var n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r);return[n,180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))]}L.layerName="S2Layer",L.defaultProps=P;var N=function(){function e(t){var r=t.getTileData,n=t.x,i=t.y,a=t.z,o=t.onTileLoad,s=t.onTileError;u()(this,e),this.x=n,this.y=i,this.z=a,this.bbox=function(e,t,r){var n=A(e,t,r),i=_()(n,2),a=i[0],o=i[1],s=A(e+1,t+1,r),u=_()(s,2);return{west:a,north:o,east:u[0],south:u[1]}}(this.x,this.y,this.z),this.isVisible=!0,this.getTileData=r,this._data=null,this._isLoaded=!1,this._loader=this._loadData(),this.onTileLoad=o,this.onTileError=s}return h()(e,[{key:"_loadData",value:function(){var e=this,t=this.x,r=this.y,n=this.z,i=this.bbox;return this.getTileData?Promise.resolve(this.getTileData({x:t,y:r,z:n,bbox:i})).then((function(t){return e._data=t,e._isLoaded=!0,e.onTileLoad(e),t})).catch((function(t){e._isLoaded=!0,e.onTileError(t)})):null}},{key:"isOverlapped",value:function(e){var t=this.x,r=this.y,n=this.z,i=Math.pow(2,e.z-n);return Math.floor(e.x/i)===t&&Math.floor(e.y/i)===r}},{key:"data",get:function(){return this._data||this._loader}},{key:"isLoaded",get:function(){return this._isLoaded}}]),e}(),I=r(4),C=r(2),R=r(14),D=r(12),U=r(37),B=r(15),F=r(11),V=r(13);function q(e,t){var r=V.n([],t,e);return V.k(r,r,1/r[3]),r}var z=r(8),G=r(16),W=r(9);function H(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var Z=Math.PI,Q=Z/4,Y=Z/180,K=180/Z,J=512,X=4003e4,$=1.5;function ee(e){return Math.pow(2,e)}function te(e){var t=Object(F.a)(e,2),r=t[0],n=t[1];H(Number.isFinite(r)),H(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var i=n*Y;return[J*(r*Y+Z)/(2*Z),J*(Z+Math.log(Math.tan(Q+.5*i)))/(2*Z)]}function re(e){var t=Object(F.a)(e,2),r=t[0],n=t[1],i=r/J*(2*Z)-Z,a=2*(Math.atan(Math.exp(n/J*(2*Z)-Z))-Q);return[i*K,a*K]}function ne(e){var t=e.latitude,r=e.longitude,n=e.highPrecision,i=void 0!==n&&n;H(Number.isFinite(t)&&Number.isFinite(r));var a={},o=J,s=Math.cos(t*Y),u=o/360,c=u/s,h=o/X/s;if(a.unitsPerMeter=[h,h,h],a.metersPerUnit=[1/h,1/h,1/h],a.unitsPerDegree=[u,c,h],a.degreesPerUnit=[1/u,1/c,1/h],i){var l=Y*Math.tan(t*Y)/s,f=u*l/2,d=o/X*l,y=d/c*h;a.unitsPerDegree2=[0,f,d],a.unitsPerMeter2=[y,0,y]}return a}function ie(e){var t=e.width,r=e.height,n=e.pitch,i=function(e){var t=e.width,r=e.height,n=e.altitude,i=void 0===n?$:n,a=e.pitch,o=void 0===a?0:a,s=e.nearZMultiplier,u=void 0===s?1:s,c=e.farZMultiplier,h=void 0===c?1:c,l=o*Y,f=Math.atan(.5/i),d=Math.sin(f)*i/Math.sin(Math.PI/2-l-f);return{fov:2*f,aspect:t/r,focalDistance:i,near:u,far:(Math.cos(Math.PI/2-l)*d+i)*h}}({width:t,height:r,altitude:e.altitude,pitch:n,nearZMultiplier:e.nearZMultiplier,farZMultiplier:e.farZMultiplier}),a=i.fov,o=i.aspect,s=i.near,u=i.far;return z.j([],a,o,s,u)}function ae(e,t){var r=Object(F.a)(e,3),n=r[0],i=r[1],a=r[2],o=void 0===a?0:a;return H(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),q(t,[n,i,o,1])}function oe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Object(F.a)(e,3),i=n[0],a=n[1],o=n[2];if(H(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o))return q(t,[i,a,o,1]);var s=q(t,[i,a,0,1]),u=q(t,[i,a,1,1]),c=s[2],h=u[2],l=c===h?0:((r||0)-c)/(h-c);return G.c([],s,u,l)}var se=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function ue(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=void 0===i?0:i,o=e.maxZoom,s=void 0===o?24:o,u=e.padding,c=void 0===u?0:u,h=e.offset,l=void 0===h?[0,0]:h,f=Object(F.a)(n,2),d=Object(F.a)(f[0],2),y=d[0],v=d[1],p=Object(F.a)(f[1],2),g=p[0],m=p[1];if(Number.isFinite(c)){c={top:c,bottom:c,left:c,right:c}}else H(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var b=new ce({width:t,height:r,longitude:0,latitude:0,zoom:0}),w=b.project([y,m]),O=b.project([g,v]),_=[Math.max(Math.abs(O[0]-w[0]),a),Math.max(Math.abs(O[1]-w[1]),a)],k=[t-c.left-c.right-2*Math.abs(l[0]),r-c.top-c.bottom-2*Math.abs(l[1])];H(k[0]>0&&k[1]>0);var x=k[0]/_[0],T=k[1]/_[1],E=(c.right-c.left)/2/x,S=(c.bottom-c.top)/2/T,j=[(O[0]+w[0])/2+E,(O[1]+w[1])/2+S],M=b.unproject(j),P=Math.min(s,b.zoom+Math.log2(Math.abs(Math.min(x,T))));return H(Number.isFinite(P)),{longitude:M[0],latitude:M[1],zoom:P}}var ce=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.width,i=r.height,a=r.latitude,o=void 0===a?0:a,s=r.longitude,u=void 0===s?0:s,c=r.zoom,h=void 0===c?0:c,l=r.pitch,f=void 0===l?0:l,d=r.bearing,y=void 0===d?0:d,v=r.altitude,p=void 0===v?1.5:v,g=r.nearZMultiplier,m=void 0===g?.02:g,b=r.farZMultiplier,w=void 0===b?1.01:b;Object(I.a)(this,t),n=n||1,i=i||1;var O=ee(h);p=Math.max(.75,p);var _=te([u,o]);_[2]=0;var k=ie({width:n,height:i,pitch:f,bearing:y,altitude:p,nearZMultiplier:m,farZMultiplier:w}),x=function(e){var t=e.height,r=e.pitch,n=e.bearing,i=e.altitude,a=e.scale,o=e.center,s=void 0===o?null:o,u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return z.p(u,u,[0,0,-i]),z.l(u,u,-r*Y),z.n(u,u,n*Y),a/=t,z.o(u,u,[a,a,a]),s&&z.p(u,u,W.h([],s)),u}({height:i,scale:O,center:_,pitch:f,bearing:y,altitude:p});return(e=Object(R.a)(this,Object(D.a)(t).call(this,{width:n,height:i,scale:O,viewMatrix:x,projectionMatrix:k}))).latitude=o,e.longitude=u,e.zoom=h,e.pitch=f,e.bearing=y,e.altitude=p,e.center=_,e.unitsPerMeter=ne(Object(U.a)(e)).unitsPerMeter[2],Object.freeze(Object(U.a)(e)),e}return Object(B.a)(t,e),Object(C.a)(t,[{key:"projectFlat",value:function(e){return te(e)}},{key:"unprojectFlat",value:function(e){return re(e)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,r=oe(e.pos,this.pixelUnprojectionMatrix),n=te(t),i=G.a([],n,G.d([],r));return re(G.a([],this.center,i),this.scale)}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,r=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}},{key:"fitBounds",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,i=this.height,a=ue(Object.assign({width:n,height:i,bounds:e},r)),o=a.longitude,s=a.latitude,u=a.zoom;return new t({width:n,height:i,longitude:o,latitude:s,zoom:u})}}]),t}(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height,i=t.scale,a=t.viewMatrix,o=void 0===a?se:a,s=t.projectionMatrix,u=void 0===s?se:s;Object(I.a)(this,e),this.width=r||1,this.height=n||1,this.scale=i,this.unitsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=u;var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];z.h(c,c,this.projectionMatrix),z.h(c,c,this.viewMatrix),this.viewProjectionMatrix=c;var h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];z.o(h,h,[this.width/2,-this.height/2,1]),z.p(h,h,[1,-1,0]),z.h(h,h,this.viewProjectionMatrix);var l=z.f([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],h);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=h,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(C.a)(e,[{key:"equals",value:function(t){return t instanceof e&&(t.width===this.width&&t.height===this.height&&z.b(t.projectionMatrix,this.projectionMatrix)&&z.b(t.viewMatrix,this.viewMatrix))}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=void 0===r||r,i=this.projectPosition(e),a=ae(i,this.pixelProjectionMatrix),o=Object(F.a)(a,2),s=o[0],u=o[1],c=n?u:this.height-u;return 2===e.length?[s,c]:[s,c,a[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=void 0===r||r,i=t.targetZ,a=Object(F.a)(e,3),o=a[0],s=a[1],u=a[2],c=n?s:this.height-s,h=i&&i*this.unitsPerMeter,l=oe([o,c,u],this.pixelUnprojectionMatrix,h),f=this.unprojectPosition(l),d=Object(F.a)(f,3),y=d[0],v=d[1],p=d[2];return Number.isFinite(u)?[y,v,p]:Number.isFinite(i)?[y,v,i]:[y,v]}},{key:"projectPosition",value:function(e){var t=this.projectFlat(e),r=Object(F.a)(t,2);return[r[0],r[1],(e[2]||0)*this.unitsPerMeter]}},{key:"unprojectPosition",value:function(e){var t=this.unprojectFlat(e),r=Object(F.a)(t,2);return[r[0],r[1],(e[2]||0)/this.unitsPerMeter]}},{key:"projectFlat",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return e}},{key:"unprojectFlat",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return e}}]),e}());var he=512;function le(e,t){var r=te(e),n=_()(r,2),i=n[0],a=n[1];return[i*=t/he,a=(1-a/he)*t]}function fe(e,t){var r=e.x,n=e.y,i=e.z,a=Math.pow(2,i-t);return{x:Math.floor(r/a),y:Math.floor(n/a),z:t}}var de=function(){function e(t){var r=t.getTileData,n=t.maxSize,i=t.maxZoom,a=t.minZoom,o=t.onTileLoad,s=t.onTileError;u()(this,e),this._getTileData=r,this._maxSize=n,this.onTileError=s,this.onTileLoad=o,this._cache=new Map,this._tiles=[],Number.isFinite(i)&&(this._maxZoom=Math.floor(i)),Number.isFinite(a)&&(this._minZoom=Math.ceil(a))}return h()(e,[{key:"finalize",value:function(){this._cache.clear()}},{key:"update",value:function(e){var t=this._cache,r=this._getTileData,n=this._maxSize,i=this._maxZoom,a=this._minZoom;this._markOldTiles();var o=function(e,t,r){var n=Math.floor(e.zoom);if(r&&n<r)return[];var i=function(e){var t=[e.unproject([0,0]),e.unproject([e.width,0]),e.unproject([0,e.height]),e.unproject([e.width,e.height])];return[t.reduce((function(e,t){return e<t[0]?e:t[0]}),180),t.reduce((function(e,t){return e<t[1]?e:t[1]}),90),t.reduce((function(e,t){return e>t[0]?e:t[0]}),-180),t.reduce((function(e,t){return e>t[1]?e:t[1]}),-90)]}(e=new e.constructor(Object.assign({},e,{zoom:n}))),a=le([i[0],i[3]],e.scale),o=_()(a,2),s=o[0],u=o[1],c=le([i[2],i[1]],e.scale),h=_()(c,2),l=h[0],f=h[1];s=Math.max(0,Math.floor(s)),l=Math.min(e.scale,Math.ceil(l)),u=Math.max(0,Math.floor(u)),f=Math.min(e.scale,Math.ceil(f));for(var d=[],y=s;y<l;y++)for(var v=u;v<f;v++)t&&n>t?d.push(fe({x:y,y:v,z:n},t)):d.push({x:y,y:v,z:n});return d}(e,i,a);if(o&&0!==o.length){t.forEach((function(e){o.some((function(t){return e.isOverlapped(t)}))&&(e.isVisible=!0)}));for(var s=!1,u=0;u<o.length;u++){var c=o[u],h=c.x,l=c.y,f=c.z,d=this._getTile(h,l,f);d||((d=new N({getTileData:r,x:h,y:l,z:f,onTileLoad:this.onTileLoad,onTileError:this.onTileError})).isVisible=!0,s=!0);var y=this._getTileId(h,l,f);t.set(y,d)}if(s){this._resizeCache(n||5*o.length),this._tiles=Array.from(this._cache.values()).sort((function(e,t){return e.z-t.z}))}}}},{key:"_resizeCache",value:function(e){var t=this._cache;if(t.size>e){var r=t[Symbol.iterator](),n=!0,i=!1,a=void 0;try{for(var o,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;if(t.size<=e)break;var c=u[0];u[1].isVisible||t.delete(c)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"_markOldTiles",value:function(){this._cache.forEach((function(e){e.isVisible=!1}))}},{key:"_getTile",value:function(e,t,r){var n=this._getTileId(e,t,r);return this._cache.get(n)}},{key:"_getTileId",value:function(e,t,r){return"".concat(r,"-").concat(e,"-").concat(t)}},{key:"tiles",get:function(){return this._tiles}}]),e}(),ye={renderSubLayers:{type:"function",value:function(e){return new b.GeoJsonLayer(e)},compare:!1},getTileData:{type:"function",value:function(e){e.x,e.y,e.z;return Promise.resolve(null)},compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileError:{type:"function",value:function(e){return console.error(e)},compare:!1},maxZoom:null,minZoom:0,maxCacheSize:null},ve=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"initializeState",value:function(){"onViewportLoaded"in this.props&&b.log.removed("onViewportLoaded","onViewportLoad")(),this.state={tiles:[],isLoaded:!1}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.context),n=e.changeFlags,i=this.state.tileCache;if(!i||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getTileData)){var a=t.getTileData,o=t.maxZoom,s=t.minZoom,u=t.maxCacheSize;i&&i.finalize(),i=new de({getTileData:a,maxSize:u,maxZoom:o,minZoom:s,onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this)}),this.setState({tileCache:i})}else n.propsChanged&&this.state.tileCache.tiles.forEach((function(e){e.layer=null}));var c=r.viewport;if(n.viewportChanged&&"DEFAULT-INITIAL-VIEWPORT"!==c.id){var h=this.getLayerZoomLevel();i.update(c);var l=i.tiles.filter((function(e){return e.z===h}));this.setState({isLoaded:!1,tiles:l}),this._onTileLoad()}}},{key:"_onTileLoad",value:function(){var e=this.props.onViewportLoad,t=this.state.tiles,r=t.every((function(e){return e.isLoaded}));this.state.isLoaded!==r&&(this.setState({isLoaded:r}),r&&e&&e(t.filter((function(e){return e._data})).map((function(e){return e._data}))))}},{key:"_onTileError",value:function(e){this.props.onTileError(e),this._onTileLoad()}},{key:"getPickingInfo",value:function(e){var t=e.info,r=e.sourceLayer;return t.sourceLayer=r,t.tile=r.props.tile,t}},{key:"getLayerZoomLevel",value:function(){var e=Math.floor(this.context.viewport.zoom),t=this.props,r=t.maxZoom,n=t.minZoom;return Number.isFinite(r)&&e>r?Math.floor(r):Number.isFinite(n)&&e<n?Math.ceil(n):e}},{key:"renderLayers",value:function(){var e=this,t=this.props,r=t.renderSubLayers,n=t.visible,i=this.getLayerZoomLevel();return this.state.tileCache.tiles.map((function(t){var a=n&&t.isVisible&&(!e.state.isLoaded||t.z===i);return t.layer?t.layer.props.visible!==a&&(t.layer=t.layer.clone({visible:a})):t.layer=r(Object.assign({},e.props,{id:"".concat(e.id,"-").concat(t.x,"-").concat(t.y,"-").concat(t.z),data:t.data,visible:a,tile:t})),t.layer}))}}]),t}(b.CompositeLayer);ve.layerName="TileLayer",ve.defaultProps=ye;var pe=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"getShaders",value:function(){var e=p()(y()(t.prototype),"getShaders",this).call(this);return e.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || vTime < currentTime - trailLength) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"color.a *= 1.0 - (currentTime - vTime) / trailLength;"},e}},{key:"initializeState",value:function(e){p()(y()(t.prototype),"initializeState",this).call(this,e),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(e){var r=this.props,n=r.trailLength,i=r.currentTime;e.uniforms=Object.assign({},e.uniforms,{trailLength:n,currentTime:i}),p()(y()(t.prototype),"draw",this).call(this,e)}}]),t}(b.PathLayer);pe.layerName="TripsLayer",pe.defaultProps={trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var ge=r(24),me=Object.assign({getHexagons:{type:"accessor",value:function(e){return e.hexagons}}},b.PolygonLayer.defaultProps),be=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.changeFlags);if(r.dataChanged||r.updateTriggers&&r.updateTriggers.getHexagons){var n=t.data,i=t.getHexagons,a=[],o=Object(b.createIterable)(n),s=o.iterable,u=o.objectInfo,c=!0,h=!1,l=void 0;try{for(var f,d=s[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var y=f.value;u.index++;var v=i(y,u),p=Object(ge.h3SetToMultiPolygon)(v,!0),g=!0,m=!1,w=void 0;try{for(var O,_=p[Symbol.iterator]();!(g=(O=_.next()).done);g=!0){var k=O.value;a.push(this.getSubLayerRow({polygon:k},y,u.index))}}catch(e){m=!0,w=e}finally{try{g||null==_.return||_.return()}finally{if(m)throw w}}}}catch(e){h=!0,l=e}finally{try{c||null==d.return||d.return()}finally{if(h)throw l}}this.setState({polygons:a})}}},{key:"renderLayers",value:function(){var e=this.props,t=e.elevationScale,r=e.extruded,n=e.wireframe,i=e.filled,a=e.stroked,o=e.lineWidthScale,s=e.lineWidthMinPixels,u=e.lineWidthMaxPixels,c=e.lineJointRounded,h=e.lineMiterLimit,l=e.lineDashJustified,f=e.material,d=e.getFillColor,y=e.getLineColor,v=e.getLineWidth,p=e.getLineDashArray,g=e.getElevation,m=e.updateTriggers;return new(this.getSubLayerClass("cluster-region",b.PolygonLayer))({filled:i,wireframe:n,extruded:r,elevationScale:t,stroked:a,lineWidthScale:o,lineWidthMinPixels:s,lineWidthMaxPixels:u,lineJointRounded:c,lineMiterLimit:h,lineDashJustified:l,material:f,getFillColor:this.getSubLayerAccessor(d),getLineColor:this.getSubLayerAccessor(y),getLineWidth:this.getSubLayerAccessor(v),getLineDashArray:this.getSubLayerAccessor(p),getElevation:this.getSubLayerAccessor(g)},this.getSubLayerProps({id:"cluster-region",updateTriggers:m}),{data:this.state.polygons,getPolygon:function(e){return e.polygon}})}}]),t}(b.CompositeLayer);be.defaultProps=me,be.layerName="H3ClusterLayer";var we=r(44),Oe=r.n(we),_e=r(0);function ke(e,t){t=void 0===t?e[0][0]:t;var r=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value,u=s[0]-t;u>180?s[0]-=360:u<-180&&(s[0]+=360)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}function xe(e,t,r){var n=e(t,r),i=Object(ge.h3ToGeo)(n),a=_()(i,2),o=a[0];return[a[1],o]}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Object(ge.h3ToGeoBoundary)(e,!0);if(1!==t?function(e,t,r){var n=Object(ge.h3ToGeo)(e),i=_()(n,2),a=i[0],o=i[1],s=t.length;ke(t,o);for(var u=t[0]===t[s-1]?s-1:s,c=0;c<u;c++)t[c][0]=Object(_e.m)(o,t[c][0],r),t[c][1]=Object(_e.m)(a,t[c][1],r)}(e,n,t):ke(n),r){var i=new Float64Array(2*n.length),a=0,o=!0,s=!1,u=void 0;try{for(var c,h=n[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var l=c.value;i[a++]=l[0],i[a++]=l[1]}}catch(e){s=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(s)throw u}}return i}return n}var Ee=Object.assign({},b.PolygonLayer.defaultProps,{highPrecision:!1,coverage:{type:"number",min:0,max:1,value:1},getHexagon:{type:"accessor",value:function(e){return e.hexagon}},extruded:!0});delete Ee.getLineDashArray;var Se=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"shouldUpdateState",value:function(e){var t=e.changeFlags;return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=(e.oldProps,e.changeFlags);if(r.dataChanged||r.updateTriggers&&r.updateTriggers.getHexagon){var n=-1,i=!1,a=Object(b.createIterable)(t.data),o=a.iterable,s=a.objectInfo,u=!0,c=!1,h=void 0;try{for(var l,f=o[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;s.index++;var y=t.getHexagon(d,s);if(n=n<0?Object(ge.h3GetResolution)(y):n,Object(ge.h3IsPentagon)(y)){i=!0;break}}}catch(e){c=!0,h=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw h}}this.setState({resolution:n,edgeLengthKM:n>=0?Object(ge.edgeLength)(n,ge.UNITS.km):0,hasPentagon:i})}this._updateVertices(this.context.viewport)}},{key:"_shouldUseHighPrecision",value:function(){var e=this.state,t=e.resolution,r=e.hasPentagon;return this.props.highPrecision||r||t>=0&&t<=5}},{key:"_updateVertices",value:function(e){if(!this._shouldUseHighPrecision()){var t=this.state,r=t.resolution,n=t.edgeLengthKM,i=t.centerHex;if(!(r<0)){var a=Object(ge.geoToH3)(e.latitude,e.longitude,r);if(!(i===a||i&&Object(ge.h3Distance)(i,a)*n<10)){var o=e.distanceScales.unitsPerMeter,s=Te(a),u=Object(ge.h3ToGeo)(a),c=_()(u,2),h=c[0],l=c[1],f=e.projectFlat([l,h]),d=_()(f,2),y=d[0],v=d[1];s=s.map((function(t){var r=e.projectFlat(t);return r[0]=(r[0]-y)/o[0],r[1]=(r[1]-v)/o[1],r})),this.setState({centerHex:a,vertices:s})}}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var e=this.props,t=e.elevationScale,r=e.material,n=e.coverage,i=e.extruded,a=e.wireframe,o=e.stroked,s=e.filled,u=e.lineWidthUnits,c=e.lineWidthScale,h=e.lineWidthMinPixels,l=e.lineWidthMaxPixels,f=e.getFillColor,d=e.getElevation,y=e.getLineColor,v=e.getLineWidth,p=e.updateTriggers;return{elevationScale:t,extruded:i,coverage:n,wireframe:a,stroked:o,filled:s,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:l,material:r,getElevation:d,getFillColor:f,getLineColor:y,getLineWidth:v,updateTriggers:{getFillColor:p.getFillColor,getElevation:p.getElevation,getLineColor:p.getLineColor,getLineWidth:p.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var e=this.props,t=e.data,r=e.getHexagon,n=e.updateTriggers,i=e.coverage,a=this.getSubLayerClass("hexagon-cell-hifi",b.PolygonLayer),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(e,t){return null==e?t:"object"===Oe()(e)?Object.assign({},e,{coverage:t}):{getHexagon:e,coverage:t}}(n.getHexagon,i),new a(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,positionFormat:"XY",getPolygon:function(e,t){return Te(r(e,t),i,!0)}})}},{key:"_renderColumnLayer",value:function(){var e=this.props,t=e.data,r=e.getHexagon,n=e.updateTriggers,i=this.getSubLayerClass("hexagon-cell",b.ColumnLayer),a=this._getForwardProps();return a.updateTriggers.getPosition=n.getHexagon,new i(a,this.getSubLayerProps({id:"hexagon-cell",updateTriggers:a.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:xe.bind(null,r)})}}]),t}(b.CompositeLayer);Se.defaultProps=Ee,Se.layerName="H3HexagonLayer";var je=r(1),Me=r.n(je),Pe=r(57),Le=r.n(Pe),Ae=r(45),Ne=r.n(Ae);function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Math.max(6378137,6378137,6356752.314245179);var Ce=function(e){return e},Re=new _e.e;function De(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ce;return Object(_e.l)(e)?(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]):"longitude"in e?(t[0]=r(e.longitude),t[1]=r(e.latitude),t[2]=e.height):(t[0]=r(e.x),t[1]=r(e.y),t[2]=e.z),t}function Ue(e){return De(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Re,_e.i.cartographicRadians?Ce:_e.o)}function Be(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ce;return Object(_e.l)(t)?(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]):"longitude"in t?(t.longitude=r(e[0]),t.latitude=r(e[1]),t.height=e[2]):(t.x=r(e[0]),t.y=r(e[1]),t.z=e[2]),t}function Fe(e,t){return Be(e,t,_e.i.cartographicRadians?Ce:_e.n)}var Ve=new _e.e,qe=new _e.e,ze=new _e.e;var Ge=1e-14,We=new _e.e,He={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Ze={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Qe={east:new _e.e,north:new _e.e,up:new _e.e,west:new _e.e,south:new _e.e,down:new _e.e},Ye=new _e.e,Ke=new _e.e,Je=new _e.e;function Xe(e,t,r,n,i,a){var o,s,u,c=He[t]&&He[t][r];Object(_e.g)(c&&(!n||n===c));var h=We.copy(i);if(Object(_e.k)(h.x,0,Ge)&&Object(_e.k)(h.y,0,Ge)){var l=Math.sign(h.z);o=Ye.fromArray(Ze[t]),"east"!==t&&"west"!==t&&o.scale(l),s=Ke.fromArray(Ze[r]),"east"!==r&&"west"!==r&&s.scale(l),u=Je.fromArray(Ze[n]),"east"!==n&&"west"!==n&&u.scale(l)}else{var f=Qe.up,d=Qe.east,y=Qe.north;d.set(-h.y,h.x,0).normalize(),e.geodeticSurfaceNormal(h,f),y.copy(f).cross(d);var v=Qe.down,p=Qe.west,g=Qe.south;v.copy(f).scale(-1),p.copy(d).scale(-1),g.copy(y).scale(-1),o=Qe[t],s=Qe[r],u=Qe[n]}return a[0]=o.x,a[1]=o.y,a[2]=o.z,a[3]=0,a[4]=s.x,a[5]=s.y,a[6]=s.z,a[7]=0,a[8]=u.x,a[9]=u.y,a[10]=u.z,a[11]=0,a[12]=h.x,a[13]=h.y,a[14]=h.z,a[15]=1,a}var $e,et=new _e.e,tt=new _e.e,rt=new _e.e,nt=new _e.e,it=new _e.e,at=new _e.e,ot=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(I.a)(this,e),Object(_e.g)(t>=0),Object(_e.g)(r>=0),Object(_e.g)(n>=0),this.radii=new _e.e(t,r,n),this.radiiSquared=new _e.e(t*t,r*r,n*n),this.radiiToTheFourth=new _e.e(t*t*t*t,r*r*r*r,n*n*n*n),this.oneOverRadii=new _e.e(0===t?0:1/t,0===r?0:1/r,0===n?0:1/n),this.oneOverRadiiSquared=new _e.e(0===t?0:1/(t*t),0===r?0:1/(r*r),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,r,n),this.maximumRadius=Math.max(t,r,n),this.centerToleranceSquared=_e.f.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(C.a)(e,null,[{key:"WGS84",get:function(){return $e=$e||new e(6378137,6378137,6356752.314245179)}}]),Object(C.a)(e,[{key:"equals",value:function(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=tt,n=rt,i=Object(F.a)(e,3),a=i[2];this.geodeticSurfaceNormalCartographic(e,r),n.copy(this.radiiSquared).scale(r);var o=Math.sqrt(r.dot(n));return n.scale(1/o),r.scale(a),n.add(r),n.to(t)}},{key:"cartesianToCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];at.from(e);var r=this.scaleToGeodeticSurface(at,nt);if(r){var n=this.geodeticSurfaceNormal(r,tt),i=it;i.copy(at).subtract(r);var a=Math.atan2(n.y,n.x),o=Math.asin(n.z),s=Math.sign(W.d(i,at))*W.g(i);return Fe([a,o,s],t)}}},{key:"eastNorthUpToFixedFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _e.b;return Xe(this,"east","north","up",e,t)}},{key:"localFrameToFixedFrame",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new _e.b;return Xe(this,e,t,r,n,i)}},{key:"geocentricSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return et.from(e).normalize().to(t)}},{key:"geodeticSurfaceNormalCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Ue(e),n=r[0],i=r[1],a=Math.cos(i);return et.set(a*Math.cos(n),a*Math.sin(n),Math.sin(i)).normalize(),et.to(t)}},{key:"geodeticSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return et.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}},{key:"scaleToGeodeticSurface",value:function(e,t){return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _e.e,n=t.oneOverRadii,i=t.oneOverRadiiSquared,a=t.centerToleranceSquared;Ve.from(e);var o=e.x,s=e.y,u=e.z,c=n.x,h=n.y,l=n.z,f=o*o*c*c,d=s*s*h*h,y=u*u*l*l,v=f+d+y,p=Math.sqrt(1/v);if(Number.isFinite(p)){var g=qe;if(g.copy(e).scale(p),v<a)return g.to(r);var m=i.x,b=i.y,w=i.z,O=ze;O.set(g.x*m*2,g.y*b*2,g.z*w*2);var _,k,x,T,E=(1-p)*e.len()/(.5*O.len()),S=0;do{var j=(_=1/(1+(E-=S)*m))*_,M=(k=1/(1+E*b))*k,P=(x=1/(1+E*w))*x;S=(T=f*j+d*M+y*P-1)/(-2*(f*(j*_)*m+d*(M*k)*b+y*(P*x)*w))}while(Math.abs(T)>_e.f.EPSILON12);return Ve.scale([_,k,x]).to(r)}}(e,this,t)}},{key:"scaleToGeocentricSurface",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];nt.from(e);var r=nt.x,n=nt.y,i=nt.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(r*r*a.x+n*n*a.y+i*i*a.z);return nt.multiplyScalar(o).to(t)}},{key:"transformPositionToScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return nt.from(e).scale(this.oneOverRadii).to(t)}},{key:"transformPositionFromScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return nt.from(e).scale(this.radii).to(t)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(_e.g)(Object(_e.k)(this.radii.x,this.radii.y,_e.f.EPSILON15)),Object(_e.g)(this.radii.z>0),nt.from(e);var n=nt.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(n)>=this.radii.z-t))return nt.set(0,0,n).to(r)}}]),e}(),st=r(36),ut=function(){function e(t,r){Object(I.a)(this,e),this.name=t,this.type=r,this.sampleSize=1,this.reset()}return Object(C.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(st.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(st.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),ct=function(){function e(t){var r=t.id,n=t.stats;Object(I.a)(this,e),this.id=r,this.stats={},this._initializeStats(n),Object.seal(this)}return Object(C.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,r=e.type;return this.stats[t]||(this.stats[t]=e instanceof ut?e:new ut(t,r)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}();function ht(e){var t=e&&e.lastIndexOf("/");return t>=0?e.substr(0,t):""}function lt(e,t){if(!e)throw new Error(t||"3d-tile loader: assertion failed.")}function ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ft(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var yt="Queued Requests",vt="Active Requests",pt="Cancelled Requests",gt="Queued Requests Ever",mt="Active Requests Ever",bt={id:"request-scheduler",throttleRequests:!0,maxRequests:6},wt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(I.a)(this,e),this.props=dt({},t,{},bt),this.requestQueue=[],this.activeRequestCount=0,this.requestMap={},this.stats=new ct({id:t.id}),this.stats.get(yt),this.stats.get(vt),this.stats.get(pt),this.stats.get(gt),this.stats.get(mt)}return Object(C.a)(e,[{key:"scheduleRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve(e);if(this.requestMap[e.id])return this.requestMap[e.id];var r=null,n=new Promise((function(n,i){return r={handle:e,callback:t,resolve:n,reject:i}}));return this.requestQueue.push(dt({promise:n},r)),this.requestMap[e.id]=n,this._issueNewRequests(),n}},{key:"startRequest",value:function(e){this.activeRequestCount++}},{key:"endRequest",value:function(e){this.requestMap[e.id]&&delete this.requestMap[e.id],this.activeRequestCount--,this._issueNewRequests()}},{key:"trackRequestPromise",value:function(e,t){var r=this;this.startRequest(e),t.then((function(){return r.endRequest(e)})).catch((function(){return r.endRequest(e)}))}},{key:"_issueNewRequests",value:function(){var e=this;this._updateNeeded=!0,setTimeout((function(){return e._issueNewRequestsAsync()}),0)}},{key:"_issueNewRequestsAsync",value:function(){this._updateNeeded=!1;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t){if(this.requestQueue.length>0)this.requestQueue.shift().resolve(!0)}}}},{key:"_updateAllRequests",value:function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var r=e[t];this._updateRequest(r)||(e.splice(t,1),delete this.requestMap[r.handle.id],t--)}e.sort((function(e,t){return e.priority-t.priority}))}},{key:"_updateRequest",value:function(e){return e.priority=e.callback(e.handle),!(e.priority<0)||(e.resolve(!1),!1)}}]),e}(),Ot=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),_t=Ot,kt=new _e.e,xt=new _e.e,Tt=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(I.a)(this,e),n=n||kt.copy(t).add(r).scale(.5),this.minimum=new _e.e(t),this.maximum=new _e.e(r),this.center=new _e.e(n)}Object(C.a)(e,[{key:"fromPoints",value:function(e){if(!e||0===e.length)return this.minimum.set(0,0,0),this.maximum.set(0,0,0),this.center.set(0,0,0),this;var t=e[0][0],r=e[0][1],n=e[0][2],i=e[0][0],a=e[0][1],o=e[0][2],s=!0,u=!1,c=void 0;try{for(var h,l=e[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var f=h.value,d=f[0],y=f[1],v=f[2];t=Math.min(d,t),i=Math.max(d,i),r=Math.min(y,r),a=Math.max(y,a),n=Math.min(v,n),o=Math.max(v,o)}}catch(e){u=!0,c=e}finally{try{s||null==l.return||l.return()}finally{if(u)throw c}}return this.minimum.set(t,r,n),this.maximum.set(i,a,o),this.center.copy(this.minimum).add(this.maximum).scale(.5),this}},{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}},{key:"intersectPlane",value:function(e){var t=kt.copy(this.maximum).subtract(this.minimum).scale(.5),r=xt.from(e.normal),n=t.x*Math.abs(r.x)+t.y*Math.abs(r.y)+t.z*Math.abs(r.z),i=this.center.dot(r)+e.distance;return i-n>0?_t.INSIDE:i+n<0?_t.OUTSIDE:_t.INTERSECTING}}])}(),new _e.e),Et=new _e.e,St=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,e),this.radius=-0,this.center=new _e.e,this.fromCenterRadius(t,r)}return Object(C.a)(e,[{key:"fromCenterRadius",value:function(e,t){return this.center.from(e),this.radius=t,this}},{key:"fromCornerPoints",value:function(e,t){return t=Tt.from(t),this.center=(new _e.e).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(e){var t=this.center,r=this.radius,n=e.center,i=e.radius,a=Tt.copy(n).subtract(t),o=a.magnitude();if(r>=o+i)return this.clone();if(i>=o+r)return e.clone();var s=.5*(r+o+i);return Et.copy(a).scale((-r+s)/o).add(t),this.center.copy(Et),this.radius=s,this}},{key:"expand",value:function(e){var t=(e=Tt.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}},{key:"intersectPlane",value:function(e){var t=this.center,r=this.radius,n=e.normal.dot(t)+e.distance;return n<-r?_t.OUTSIDE:n<r?_t.INTERSECTING:_t.INSIDE}},{key:"transform",value:function(e){this.center.transform(e);var t=z.e(Tt,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(e){return(e=Tt.from(e)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}}]),e}(),jt=new _e.a,Mt=new _e.a,Pt=new _e.a,Lt=new _e.a,At=new _e.a;function Nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=_e.f.EPSILON20,n=0,i=0,a=Mt,o=Pt;a.identity(),o.copy(e);for(var s=r*function(e){for(var t=0,r=0;r<9;++r){var n=e[r];t+=n*n}return Math.sqrt(t)}(o);i<10&&Rt(o)>s;)Dt(o,Lt),At.copy(Lt).transpose(),o.multiplyRight(Lt),o.multiplyLeft(At),a.multiplyRight(Lt),++n>2&&(++i,n=0);return t.unitary=a.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}var It=[1,0,0],Ct=[2,2,1];function Rt(e){for(var t=0,r=0;r<3;++r){var n=e[jt.getElementIndex(Ct[r],It[r])];t+=2*n*n}return Math.sqrt(t)}function Dt(e,t){for(var r=_e.f.EPSILON15,n=0,i=1,a=0;a<3;++a){var o=Math.abs(e[jt.getElementIndex(Ct[a],It[a])]);o>n&&(i=a,n=o)}var s=It[i],u=Ct[i],c=1,h=0;if(Math.abs(e[jt.getElementIndex(u,s)])>r){var l,f=(e[jt.getElementIndex(u,u)]-e[jt.getElementIndex(s,s)])/2/e[jt.getElementIndex(u,s)];h=(l=f<0?-1/(-f+Math.sqrt(1+f*f)):1/(f+Math.sqrt(1+f*f)))*(c=1/Math.sqrt(1+l*l))}return _e.a.IDENTITY.to(t),t[jt.getElementIndex(s,s)]=t[jt.getElementIndex(u,u)]=c,t[jt.getElementIndex(u,s)]=h,t[jt.getElementIndex(s,u)]=-h,t}var Ut=new _e.e,Bt=new _e.e,Ft=new _e.e,Vt=new _e.e,qt=new _e.e,zt=new _e.a,Gt={diagonal:new _e.a,unitary:new _e.a};function Wt(e,t){if(!e||0===e.length)return t.halfAxes=new _e.a([0,0,0,0,0,0,0,0,0]),t.center=new _e.e,t;var r=e.length,n=new _e.e(0,0,0),i=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;n.add(c)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}var h=1/r;n.multiplyByScalar(h);var l=0,f=0,d=0,y=0,v=0,p=0,g=!0,m=!1,b=void 0;try{for(var w,O=e[Symbol.iterator]();!(g=(w=O.next()).done);g=!0){var _=w.value,k=Ut.copy(_).subtract(n);l+=k.x*k.x,f+=k.x*k.y,d+=k.x*k.z,y+=k.y*k.y,v+=k.y*k.z,p+=k.z*k.z}}catch(e){m=!0,b=e}finally{try{g||null==O.return||O.return()}finally{if(m)throw b}}l*=h,f*=h,d*=h,y*=h,v*=h,p*=h;var x=zt;x[0]=l,x[1]=f,x[2]=d,x[3]=f,x[4]=y,x[5]=v,x[6]=d,x[7]=v,x[8]=p;var T=Nt(x,Gt).unitary,E=t.halfAxes.copy(T),S=E.getColumn(0,Ft),j=E.getColumn(1,Vt),M=E.getColumn(2,qt),P=-Number.MAX_VALUE,L=-Number.MAX_VALUE,A=-Number.MAX_VALUE,N=Number.MAX_VALUE,I=Number.MAX_VALUE,C=Number.MAX_VALUE,R=!0,D=!1,U=void 0;try{for(var B,F=e[Symbol.iterator]();!(R=(B=F.next()).done);R=!0){var V=B.value;P=Math.max(V.dot(S),P),L=Math.max(V.dot(j),L),A=Math.max(V.dot(M),A),N=Math.min(V.dot(S),N),I=Math.min(V.dot(j),I),C=Math.min(V.dot(M),C)}}catch(e){D=!0,U=e}finally{try{R||null==F.return||F.return()}finally{if(D)throw U}}S=S.multiplyByScalar(.5*(N+P)),j=j.multiplyByScalar(.5*(I+L)),M=M.multiplyByScalar(.5*(C+A)),t.center.copy(S).add(j).add(M);var q=Bt.set(P-N,L-I,A-C).multiplyByScalar(.5);return t.halfAxes.multiplyByScalar(q),t}var Ht=new _e.e,Zt=new _e.e,Qt=new _e.e,Yt=new _e.e,Kt=new _e.e,Jt=new _e.e,Xt=new _e.e,$t=new _e.e,er=new _e.e,tr=new _e.e,rr=new _e.e,nr=0,ir=1,ar=2,or=3,sr=4,ur=5,cr=6,hr=7,lr=8,fr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(I.a)(this,e),this.center=(new _e.e).from(t),this.halfAxes=new _e.a(r)}return Object(C.a)(e,[{key:"clone",value:function(t){return new e(this.center,this.halfAxes)}},{key:"fromPoints",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return Wt(t,r)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}},{key:"getBoundingSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new St,t=this.halfAxes,r=t.getColumn(0,er),n=t.getColumn(1,tr),i=t.getColumn(2,rr),a=Ht.copy(r).add(n).add(i);return e.center.copy(this.center),e.radius=a.magnitude(),e}},{key:"intersectPlane",value:function(e){var t=this.center,r=e.normal,n=this.halfAxes,i=r.x,a=r.y,o=r.z,s=Math.abs(i*n[nr]+a*n[ir]+o*n[ar])+Math.abs(i*n[or]+a*n[sr]+o*n[ur])+Math.abs(i*n[cr]+a*n[hr]+o*n[lr]),u=r.dot(t)+e.distance;return u<=-s?_t.OUTSIDE:u>=s?_t.INSIDE:_t.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t=Zt.from(e).subtract(this.center),r=this.halfAxes,n=r.getColumn(0,Qt),i=r.getColumn(1,Yt),a=r.getColumn(2,Kt),o=n.magnitude(),s=i.magnitude(),u=a.magnitude();n.normalize(),i.normalize(),a.normalize();var c=Jt;c.x=t.dot(n),c.y=t.dot(i),c.z=t.dot(a);var h,l=0;return c.x<-o?l+=(h=c.x+o)*h:c.x>o&&(l+=(h=c.x-o)*h),c.y<-s?l+=(h=c.y+s)*h:c.y>s&&(l+=(h=c.y-s)*h),c.z<-u?l+=(h=c.z+u)*h:c.z>u&&(l+=(h=c.z-u)*h),l}},{key:"computePlaneDistances",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[],[]],n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.center,o=this.halfAxes,s=o.getColumn(0,Qt),u=o.getColumn(1,Yt),c=o.getColumn(2,Kt),h=Xt.copy(s).add(u).add(c).add(a),l=$t.copy(h).subtract(e),f=t.dot(l);return n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(s).add(u).subtract(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(s).subtract(u).add(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),h.copy(a).add(s).subtract(u).subtract(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(s).add(u).add(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(s).add(u).subtract(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(s).subtract(u).add(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),a.copy(h).subtract(s).subtract(u).subtract(c),l.copy(h).subtract(e),f=t.dot(l),n=Math.min(f,n),i=Math.max(f,i),r.start=n,r.stop=i,r}},{key:"getTransform",value:function(){}}]),e}(),dr=new _e.e,yr=new _e.e,vr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,e),this.normal=new _e.e,this.distance=-0,this.fromNormalDistance(t,r)}return Object(C.a)(e,[{key:"fromNormalDistance",value:function(e,t){return Object(_e.g)(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}},{key:"fromPointNormal",value:function(e,t){e=dr.from(e),this.normal.from(t).normalize();var r=-this.normal.dot(e);return this.distance=r,this}},{key:"fromCoefficients",value:function(e,t,r,n){return this.normal.set(e,t,r),Object(_e.g)(Object(_e.k)(this.normal.len(),1)),this.distance=n,this}},{key:"clone",value:function(t){return new e(this.normal,this.distance)}},{key:"equals",value:function(e){return Object(_e.k)(this.distance,e.distance)&&Object(_e.k)(this.normal,e.normal)}},{key:"getPointDistance",value:function(e){return this.normal.dot(e)+this.distance}},{key:"transform",value:function(e){var t=yr.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,t)}},{key:"projectPointOntoPlane",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];e=dr.from(e);var r=this.getPointDistance(e),n=yr.copy(this.normal).scale(r);return e.subtract(n).to(t)}}]),e}(),pr=[new _e.e([1,0,0]),new _e.e([0,1,0]),new _e.e([0,0,1])],gr=new _e.e,mr=new _e.e,br=(new vr(new _e.e(1,0,0),0),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(I.a)(this,e),this.planes=t,Object(_e.g)(this.planes.every((function(e){return e instanceof vr})))}return Object(C.a)(e,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(C.a)(e,[{key:"fromBoundingSphere",value:function(e){this.planes.length=2*pr.length;var t=e.center,r=e.radius,n=0,i=!0,a=!1,o=void 0;try{for(var s,u=pr[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,h=this.planes[n],l=this.planes[n+1];h||(h=this.planes[n]=new vr),l||(l=this.planes[n+1]=new vr);var f=gr.copy(c).scale(-r).add(t);c.dot(f);h.fromPointNormal(f,c);var d=gr.copy(c).scale(r).add(t),y=mr.copy(c).negate();y.dot(d);l.fromPointNormal(d,y),n+=2}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}return this}},{key:"computeVisibility",value:function(e){Object(_e.g)(e);var t=_t.INSIDE,r=!0,n=!1,i=void 0;try{for(var a,o=this.planes[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;switch(e.intersectPlane(s)){case _t.OUTSIDE:return _t.OUTSIDE;case _t.INTERSECTING:t=_t.INTERSECTING}}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return t}},{key:"computeVisibilityWithPlaneMask",value:function(t,r){if(Object(_e.g)(t,"boundingVolume is required."),Object(_e.g)(Number.isFinite(r),"parentPlaneMask is required."),r===e.MASK_OUTSIDE||r===e.MASK_INSIDE)return r;for(var n=e.MASK_INSIDE,i=this.planes,a=0;a<this.planes.length;++a){var o=a<31?1<<a:0;if(!(a<31&&0==(r&o))){var s=i[a],u=t.intersectPlane(s);if(u===_t.OUTSIDE)return e.MASK_OUTSIDE;u===_t.INTERSECTING&&(n|=o)}}return n}}]),e}());function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Or=new _e.e,_r=new _e.e,kr=new _e.e,xr=new _e.e,Tr=new _e.e,Er=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(I.a)(this,e),t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(r,!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({near:1,far:5e8},t),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this._cullingVolume=new br([new vr,new vr,new vr,new vr,new vr,new vr]),this._perspectiveMatrix=new _e.b,this._infinitePerspective=new _e.b}return Object(C.a)(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"computeCullingVolume",value:function(e,t,r){Object(_e.g)(e,"position is required."),Object(_e.g)(t,"direction is required."),Object(_e.g)(r,"up is required.");var n=this._cullingVolume.planes;r=Or.copy(r).normalize();var i=_r.copy(t).cross(r).normalize(),a=kr.copy(t).multiplyByScalar(this.near).add(e),o=xr.copy(t).multiplyByScalar(this.far).add(e),s=Tr;return s.copy(i).multiplyByScalar(this.left).add(a).subtract(e).cross(r),n[0].fromPointNormal(e,s),s.copy(i).multiplyByScalar(this.right).add(a).subtract(e).cross(r).negate(),n[1].fromPointNormal(e,s),s.copy(r).multiplyByScalar(this.bottom).add(a).subtract(e).cross(i).negate(),n[2].fromPointNormal(e,s),s.copy(r).multiplyByScalar(this.top).add(a).subtract(e).cross(i),n[3].fromPointNormal(e,s),s=(new _e.e).copy(t),n[4].fromPointNormal(a,s),s.negate(),n[5].fromPointNormal(o,s),this._cullingVolume}},{key:"getPixelDimensions",value:function(e,t,r,n){Sr(this),Object(_e.g)(Number.isFinite(e)&&Number.isFinite(t)),Object(_e.g)(e>0),Object(_e.g)(t>0),Object(_e.g)(r>0),Object(_e.g)(n);var i=1/this.near,a=this.top*i,o=2*r*a/t,s=2*r*(a=this.right*i)/e;return n.x=s,n.y=o,n}},{key:"projectionMatrix",get:function(){return Sr(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return Sr(this),this._infinitePerspective}}]),e}();function Sr(e){Object(_e.g)(Number.isFinite(e.right)&&Number.isFinite(e.left)&&Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e.top,r=e.bottom,n=e.right,i=e.left,a=e.near,o=e.far;t===e._top&&r===e._bottom&&i===e._left&&n===e._right&&a===e._near&&o===e._far||(Object(_e.g)(e.near>0&&e.near<e.far,"near must be greater than zero and less than far."),e._left=i,e._right=n,e._top=t,e._bottom=r,e._near=a,e._far=o,e._perspectiveMatrix=(new _e.b).frustum({left:i,right:n,bottom:r,top:t,near:a,far:o}),e._infinitePerspective=(new _e.b).frustum({left:i,right:n,bottom:r,top:t,near:a,far:1/0}))}function jr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(I.a)(this,e),t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jr(r,!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({near:1,far:5e8,xOffset:0,yOffset:0},t),this._offCenterFrustum=new Er,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this.xOffset=t.xOffset,this._xOffset=this.xOffset,this.yOffset=t.yOffset,this._yOffset=this.yOffset}Object(C.a)(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return null!=t&&t instanceof e&&(Mr(this),Mr(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"computeCullingVolume",value:function(e,t,r){return Mr(this),this._offCenterFrustum.computeCullingVolume(e,t,r)}},{key:"getPixelDimensions",value:function(e,t,r,n){return Mr(this),this._offCenterFrustum.getPixelDimensions(e,t,r,n)}},{key:"projectionMatrix",get:function(){return Mr(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return Mr(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return Mr(this),this._fovy}},{key:"sseDenominator",get:function(){return Mr(this),this._sseDenominator}}])}();function Mr(e){Object(_e.g)(Number.isFinite(e.fov)&&Number.isFinite(e.aspectRatio)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(Object(_e.g)(e.fov>=0&&e.fov<Math.PI),Object(_e.g)(e.aspectRatio>0),Object(_e.g)(e.near>=0&&e.near<e.far),e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,new _e.e,Math.PI;var Pr=new _e.e,Lr=new _e.e,Ar=new br([new vr,new vr,new vr,new vr,new vr,new vr]);function Nr(e,t){var r=e.cameraDirection,n=e.cameraUp,i=e.height,a=e.distanceScales.metersPerUnit,o=[e.longitude,e.latitude,0],s=ot.WGS84.cartographicToCartesian(o,new _e.e),u=ot.WGS84.eastNorthUpToFixedFrame(s),c=e.unprojectPosition(e.cameraPosition),h=ot.WGS84.cartographicToCartesian(c,new _e.e),l=new _e.e(u.transformAsVector(new _e.e(r).scale(a))).normalize(),f=new _e.e(u.transformAsVector(new _e.e(n).scale(a))).normalize();return function(e,t){var r=e.getFrustumPlanes(),n=0;for(var i in r){var a=r[i],o=a.normal.dot(e.center);Lr.copy(a.normal).scale(a.distance-o).add(e.center);var s=e.unprojectPosition(Lr),u=ot.WGS84.cartographicToCartesian(s,new _e.e);Ar.planes[n++].fromPointNormal(u,Pr.copy(t).subtract(u))}}(e,s),{camera:{position:h,direction:l,up:f},height:i,cullingVolume:Ar,frameNumber:t,sseDenominator:1.15}}function Ir(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Cr(e,t){Ir(e),Ir(t);var r=t.rtcCenter,n=t.rotateYtoZ,i=e.computedTransform,a=e._boundingVolume.center,o=new _e.b(i);if(r&&o.translate(r),n){var s=(new _e.b).rotateX(Math.PI/2);o=o.multiplyRight(s)}t.isQuantized&&o.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);var u=new _e.e(a);t.cartesianModelMatrix=o,t.cartesianOrigin=u;var c=ot.WGS84.cartesianToCartographic(u,new _e.e),h=ot.WGS84.eastNorthUpToFixedFrame(u).invert();t.cartographicModelMatrix=h.multiplyRight(o),t.cartographicOrigin=c,t.modelMatrix=t.cartographicModelMatrix}var Rr=r(10),Dr="",Ur={};function Br(e){for(var t in Ur)if(e.startsWith(t)){var r=Ur[t];return e.replace(t,r)}return e+=Dr}var Fr=function(e){return"undefined"!=typeof Response&&e instanceof Response||e.arrayBuffer&&e.text&&e.json},Vr=function(e){return function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)},qr=function(){function e(t){Object(I.a)(this,e),this._fileOrBlob=t,this.bodyUsed=!1}return Object(C.a)(e,[{key:"arrayBuffer",value:function(){var e,t,r;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this._getFileReader(),t=e.reader,r=e.promise,t.readAsArrayBuffer(this._fileOrBlob),n.abrupt("return",r);case 3:case"end":return n.stop()}}),null,this)}},{key:"text",value:function(){var e,t,r;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this._getFileReader(),t=e.reader,r=e.promise,t.readAsText(this._fileOrBlob),n.abrupt("return",r);case 3:case"end":return n.stop()}}),null,this)}},{key:"json",value:function(){var e;return Me.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Me.a.awrap(this.text());case 2:return e=t.sent,t.abrupt("return",JSON.parse(e));case 4:case"end":return t.stop()}}),null,this)}},{key:"_getFileReader",value:function(){var e;Ir(!this.bodyUsed),this.bodyUsed=!0;var t=new Promise((function(t,r){try{(e=new FileReader).onerror=function(e){return r(new Error(e))},e.onabort=function(){return r(new Error("Read aborted."))},e.onload=function(){return t(e.result)}}catch(e){r(e)}}));return{reader:e,promise:t}}},{key:"headers",get:function(){return new Headers({"Content-Length":this._fileOrBlob.size,"Content-Type":this._fileOrBlob.type})}},{key:"ok",get:function(){return!0}},{key:"status",get:function(){return 200}},{key:"url",get:function(){return this._fileOrBlob.name||""}}]),e}();function zr(e,t){return Promise.resolve(new qr(e,t))}function Gr(e,t){return Me.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!Vr(e)){r.next=2;break}return r.abrupt("return",zr(e,t));case 2:return e=Br(e),r.abrupt("return",fetch(e,t));case 4:case"end":return r.stop()}}))}var Wr="2.0.0";function Hr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wr;Ir(e,"no loader provided");var r=e.version;t&&r&&(t=Zr(t),r=Zr(r))}function Zr(e){var t=e.split(".").map(Number);return{major:t[0],minor:t[1]}}function Qr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Kr(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);var t=e.parseTextSync||e.parseSync||e.parse||e.parseStream||e.parseInBatches,r=e.options&&e.options[e.id];return t=t||r&&r.workerUrl}function Jr(e){var t;return Ir(e,"null loader"),Ir(Kr(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=Yr({},e=e[0],{options:Yr({},e.options,{},t)})),e.extension&&(e.extensions=e.extensions||e.extension,delete e.extension),Array.isArray(e.extensions)||(e.extensions=[e.extensions]),Ir(e.extensions&&e.extensions.length>0&&e.extensions[0]),e.parseTextSync&&(e.text=!0),e.text||(e.binary=!0),e}var Xr=function(){function e(){Object(I.a)(this,e)}return Object(C.a)(e,[{key:"log",value:function(){return function(e){}}},{key:"info",value:function(){return function(e){}}},{key:"warn",value:function(){return function(e){}}},{key:"error",value:function(){return function(e){}}}]),e}(),$r={CDN:"https://unpkg.com/@loaders.gl",worker:!0,log:new(function(){function e(){Object(I.a)(this,e),this.console=console}return Object(C.a)(e,[{key:"log",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.log).bind.apply(e,[this.console].concat(r))}},{key:"info",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.info).bind.apply(e,[this.console].concat(r))}},{key:"warn",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.warn).bind.apply(e,[this.console].concat(r))}},{key:"error",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.console.error).bind.apply(e,[this.console].concat(r))}}]),e}()),dataType:"arraybuffer"};function en(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?en(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):en(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var rn=function(e){return e&&"object"===Object(Rr.a)(e)&&e.constructor==={}.constructor},nn=tn({},$r);function an(e,t,r){var n=tn({},e&&(e.DEFAULT_LOADER_OPTIONS||e.defaultOptions||e.options||{}));return function(e,t){!t||"baseUri"in e||(e.baseUri=t)}(n,r),null===n.log&&(n.log=new Xr),on(n,nn),on(n,t),n}function on(e,t){for(var r in t)if(r in t){var n=t[r];rn(n)&&rn(e[r])?e[r]=tn({},e[r],{},t[r]):e[r]=t[r]}}function sn(e){this.wrapped=e}function un(e){var t,r;function n(t,r){try{var a=e[t](r),o=a.value,s=o instanceof sn;Promise.resolve(s?o.wrapped:o).then((function(e){s?n("next",e):i(a.done?"return":"normal",e)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise((function(a,o){var s={key:e,arg:i,resolve:a,reject:o,next:null};r?r=r.next=s:(t=r=s,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(un.prototype[Symbol.asyncIterator]=function(){return this}),un.prototype.next=function(e){return this._invoke("next",e)},un.prototype.throw=function(e){return this._invoke("throw",e)},un.prototype.return=function(e){return this._invoke("return",e)};r(84);function cn(e){var t,r;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.ok){n.next=12;break}return t="fetch failed ".concat(e.status," "),n.prev=2,n.next=5,Me.a.awrap(e.text());case 5:r=n.sent,t+=r,n.next=11;break;case 9:n.prev=9,n.t0=n.catch(2);case 11:throw new Error(t);case 12:case"end":return n.stop()}}),null,null,[[2,9]])}var hn="Cannot convert supplied data type";function ln(e,t){return Fr(e)?t=t||e.url:Vr(t)&&(t=t.name),"string"==typeof t?t.replace(/\?.*/,""):t}function fn(e,t){if(t.text&&"string"==typeof e)return e;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){var r=e.buffer||e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}throw new Error(hn)}function dn(e,t){var r;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Me.a.awrap(e);case 2:if(e=n.sent,r=e instanceof ArrayBuffer||ArrayBuffer.isView(e),"string"!=typeof e&&!r){n.next=6;break}return n.abrupt("return",fn(e,t));case 6:if(!Vr(e)){n.next=10;break}return n.next=9,Me.a.awrap(zr(e));case 9:e=n.sent;case 10:if(!Fr(e)){n.next=23;break}return n.next=13,Me.a.awrap(cn(e));case 13:if(!t.binary){n.next=19;break}return n.next=16,Me.a.awrap(e.arrayBuffer());case 16:n.t0=n.sent,n.next=22;break;case 19:return n.next=21,Me.a.awrap(e.text());case 21:n.t0=n.sent;case 22:return n.abrupt("return",n.t0);case 23:throw new Error(hn);case 24:case"end":return n.stop()}}))}var yn=r(28);function vn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pn(e,t,r){return r||(e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({fetch:e.fetch||Gr},e),Array.isArray(e.loaders)||(e.loaders=null),e)}function gn(e,t){if(!t&&!Array.isArray(e))return e;var r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){var n=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[].concat(Object(yn.a)(r),Object(yn.a)(n)):n}return r&&r.length?r:null}var mn=r(46);function bn(e){if(mn.toArrayBuffer&&(e=Object(mn.toArrayBuffer)(e)),e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer;if("string"==typeof e){var t=e;return(new TextEncoder).encode(t).buffer}return Ir(!1)}var wn=new Map;function On(e){return!!e&&(e instanceof ArrayBuffer||e.buffer instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}function _n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){if(On(e))r.push(e);else if(On(e.buffer))r.push(e.buffer);else if(t&&"object"===Object(Rr.a)(e))for(var n in e)_n(e[n],t,r)}else;return r}var kn=0;function xn(e){var t=e.data;(0,e.resolve)(t)}var Tn=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"web-worker-".concat(kn++):n,a=t.onMessage;Object(I.a)(this,e);var o=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],Ir("string"==typeof e,"worker source"),e.startsWith("url(")&&e.endsWith(")")){var t=e.match(/^url\((.*)\)$/)[1];if(t&&!t.startsWith("http"))return t;e=function(e){return"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n}")}(t)}var r=wn.get(e);if(!r){var n=new Blob([e],{type:"application/javascript"});r=URL.createObjectURL(n),wn.set(e,r)}return r}(r,i);this.worker=new Worker(o,{name:i}),this.name=i,this.onMessage=a||xn}return Object(C.a)(e,[{key:"process",value:function(e){var t=this;return Me.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,n){t.worker.onmessage=function(e){return t.onMessage({worker:t.worker,data:e.data,resolve:r,reject:n})},t.worker.onerror=function(e){var r="".concat(t.name,": WorkerThread.process() failed");e.message&&(r+=" ".concat(e.message," ").concat(e.filename,":").concat(e.lineno,":").concat(e.colno));var i=new Error(r);console.error(e),n(i)};var i=_n(e);t.worker.postMessage(e,i)})));case 1:case"end":return r.stop()}}))}},{key:"destroy",value:function(){this.worker.terminate(),this.worker=null}}]),e}(),En=function(){function e(t){var r=t.source,n=t.name,i=void 0===n?"unnamed":n,a=t.maxConcurrency,o=void 0===a?1:a,s=t.onMessage,u=t.onDebug,c=void 0===u?function(){}:u;Object(I.a)(this,e),this.source=r,this.name=i,this.maxConcurrency=o,this.onMessage=s,this.onDebug=c,this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1}return Object(C.a)(e,[{key:"destroy",value:function(){this.idleQueue.forEach((function(e){return e.destroy()})),this.isDestroyed=!0}},{key:"process",value:function(e,t){var r=this;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,i){r.jobQueue.push({data:e,jobName:t,resolve:n,reject:i}),r._startQueuedJob()})));case 1:case"end":return n.stop()}}))}},{key:"_startQueuedJob",value:function(){var e=this;if(this.jobQueue.length){var t=this._getAvailableWorker();if(t){var r=this.jobQueue.shift();this.onDebug({message:"processing",worker:t.name,job:r.jobName,backlog:this.jobQueue.length}),t.process(r.data).then((function(e){return r.resolve(e)})).catch((function(e){return r.reject(e)})).then((function(){return e._onWorkerDone(t)}))}}}},{key:"_onWorkerDone",value:function(e){this.isDestroyed?e.destroy():(this.idleQueue.push(e),this._startQueuedJob())}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift();if(this.count<this.maxConcurrency){this.count++;var e="".concat(this.name.toLowerCase(),"-worker-").concat(this.count,"-of-").concat(this.maxConcurrency);return new Tn({source:this.source,onMessage:this.onMessage,name:e})}return null}}]),e}(),Sn=5,jn=function(){function e(t){var r=t.maxConcurrency,n=void 0===r?Sn:r,i=t.onMessage,a=t.onDebug,o=void 0===a?function(){}:a;Object(I.a)(this,e),this.maxConcurrency=n,this.onMessage=i,this.onDebug=o,this.workerPools=new Map}return Object(C.a)(e,null,[{key:"isSupported",value:function(){return"undefined"!=typeof Worker}}]),Object(C.a)(e,[{key:"setProps",value:function(e){"maxConcurrency"in e&&(this.maxConcurrency=e.maxConcurrency),"onDebug"in e&&(this.onDebug=e.onDebug)}},{key:"destroy",value:function(){this.workerPools.forEach((function(e){return e.destroy()}))}},{key:"process",value:function(e,t,r){var n;return Me.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=this._getWorkerPool(e,t),i.abrupt("return",n.process(r));case 2:case"end":return i.stop()}}),null,this)}},{key:"_getWorkerPool",value:function(e,t){var r=this.workerPools.get(t);return r||(r=new En({source:e,name:t,onMessage:this.onMessage,maxConcurrency:this.maxConcurrency,onDebug:this.onDebug}),this.workerPools.set(t,r)),r}}]),e}();function Mn(e,t,r,n){if(!jn.isSupported())return!1;var i=r&&r[e.id];return!!("local"===r.worker&&i&&i.localWorkerUrl||r.worker&&i&&i.workerUrl)&&(!e.useWorker||e.useWorker(r))}function Pn(e,t,r,n){var i=(r||{}).worker,a=r&&r[e.id]||{},o="local"===i?a.localWorkerUrl:a.workerUrl,s="url(".concat(o,")"),u=e.name,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};e.maxConcurrency&&(t.maxConcurrency=e.maxConcurrency);e.onDebug&&(t.onDebug=e.onDebug);Ln||(Ln=new jn({onMessage:An}));return Ln.setProps(t),Ln}(r);return r=JSON.parse(JSON.stringify(r)),c.process(s,"loaders.gl-".concat(u),{arraybuffer:bn(t),options:r,source:"loaders.gl@".concat("2.0.0"),type:"parse"})}var Ln=null;function An(e){var t,r,n,i,a;return Me.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:t=e.worker,r=e.data,n=e.resolve,i=e.reject,o.t0=r.type,o.next="done"===o.t0?4:"parse"===o.t0?6:"error"===o.t0?17:19;break;case 4:return n(r.result),o.abrupt("break",19);case 6:return o.prev=6,o.next=9,Me.a.awrap(Vn(r.arraybuffer,r.options,r.url));case 9:a=o.sent,t.postMessage({type:"parse-done",id:r.id,result:a},_n(a)),o.next=16;break;case 13:o.prev=13,o.t1=o.catch(6),t.postMessage({type:"parse-error",id:r.id,message:o.t1.message});case 16:return o.abrupt("break",19);case 17:return i(r.message),o.abrupt("break",19);case 19:case"end":return o.stop()}}),null,null,[[6,13]])}var Nn=[];var In=/\.([^.]+)$/,Cn=/^data:(.*?)(;|,)/;function Rn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).nothrow,i=void 0!==n&&n;if(t=t||"",e&&!Array.isArray(e)){var a=e;return Jr(a),a}!function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){Jr(i.value)}}catch(e){r=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw n}}}(e=[].concat(Object(yn.a)(e||[]),Object(yn.a)(Nn)));var o=function(e,t){var r=t.match(Cn),n=r&&r[1];if(n)return Dn(e,n);var i=(r=t.match(In))&&r[1];return i&&function(e,t){t=t.toLowerCase();var r=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value,u=!0,c=!1,h=void 0;try{for(var l,f=s.extensions[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){if(l.value.toLowerCase()===t)return s}}catch(e){c=!0,h=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw h}}}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}(e,i)}(e,t=t.replace(/\?.*/,""));if(!(o=(o=o||function(e,t){if(!t||!Fr(t)||!t.headers)return null;var r=t.headers.get("content-type");return Dn(e,r)}(e,r))||function(e,t){if(!t)return null;var r=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;if("string"==typeof t){if(Un(t,s))return s}else if(ArrayBuffer.isView(t)){if(Bn(t.buffer,t.byteOffset,s))return s}else if(t instanceof ArrayBuffer){if(Bn(t,0,s))return s}}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}(e,r))){if(i)return null;var s="No valid loader found";throw r&&(s+=' for data starting with "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Fn(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return Fn(e,0,t)}return""}(r),'"')),t&&(s+=" for ".concat(t)),new Error(s)}return o}function Dn(e,t){var r=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;if(s.mimeTypes&&s.mimeTypes.includes(t))return s}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}function Un(e,t){return t.testText&&t.testText(e)}function Bn(e,t,r){switch(Array.isArray(r.test)?"array":Object(Rr.a)(r.test)){case"function":return r.test(e,r);case"string":case"array":return(Array.isArray(r.test)?r.test:[r.test]).some((function(r){return r===Fn(e,t,r.length)}));default:return!1}}function Fn(e,t,r){if(e.byteLength<=t+r)return"";for(var n=new DataView(e),i="",a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(t+a));return i}function Vn(e,t,r,n){var i,a,o,s;return Me.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(!t||Array.isArray(t)||Kr(t)||(n=r,r=t,t=null),i="","string"==typeof n&&(i=n,n=null),r=r||{},a=ln(e,i),o=gn(t,n),s=Rn(o,a,e)){u.next=9;break}return u.abrupt("return",null);case 9:return r=an(s,r,a),n=pn({url:a,parse:Vn,loaders:o},0,n),u.next=13,Me.a.awrap(qn(s,e,r,n));case 13:return u.abrupt("return",u.sent);case 14:case"end":return u.stop()}}))}function qn(e,t,r,n){return Me.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return Hr(e),i.next=3,Me.a.awrap(dn(t,e));case 3:if(t=i.sent,!e.parseTextSync||"string"!=typeof t){i.next=7;break}return r.dataType="text",i.abrupt("return",e.parseTextSync(t,r,n,e));case 7:if(!Mn(e,0,r)){i.next=11;break}return i.next=10,Me.a.awrap(Pn(e,t,r));case 10:return i.abrupt("return",i.sent);case 11:if(!e.parse){i.next=15;break}return i.next=14,Me.a.awrap(e.parse(t,r,n,e));case 14:return i.abrupt("return",i.sent);case 15:return Ir(!e.parseSync),i.abrupt("return",Ir(!1));case 17:case"end":return i.stop()}}))}var zn={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},Gn=(Object.keys(zn),{UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5}),Wn={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0},Hn=0,Zn=1;function Qn(e,t,r){Ir(e instanceof ArrayBuffer);var n=new TextDecoder("utf8"),i=new Uint8Array(e,t,r);return n.decode(i)}function Yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e);return"".concat(String.fromCharCode(r.getUint8(t+0))).concat(String.fromCharCode(r.getUint8(t+1))).concat(String.fromCharCode(r.getUint8(t+2))).concat(String.fromCharCode(r.getUint8(t+3)))}function Kn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Jn,Xn={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},$n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},{},Xn),ei=(Ie(Jn={},Xn.DOUBLE,Float64Array),Ie(Jn,Xn.FLOAT,Float32Array),Ie(Jn,Xn.UNSIGNED_SHORT,Uint16Array),Ie(Jn,Xn.UNSIGNED_INT,Uint32Array),Ie(Jn,Xn.UNSIGNED_BYTE,Uint8Array),Ie(Jn,Xn.BYTE,Int8Array),Ie(Jn,Xn.SHORT,Int16Array),Ie(Jn,Xn.INT,Int32Array),Jn),ti={DOUBLE:Xn.DOUBLE,FLOAT:Xn.FLOAT,UNSIGNED_SHORT:Xn.UNSIGNED_SHORT,UNSIGNED_INT:Xn.UNSIGNED_INT,UNSIGNED_BYTE:Xn.UNSIGNED_BYTE,BYTE:Xn.BYTE,SHORT:Xn.SHORT,INT:Xn.INT},ri=function(){function e(){Object(I.a)(this,e)}return Object(C.a)(e,null,[{key:"fromTypedArray",value:function(e){for(var t in e=ArrayBuffer.isView(e)?e.constructor:e,ei){if(ei[t]===e)return t}throw new Error("Failed to convert GL type")}},{key:"fromName",value:function(e){var t=ti[e];if(!t)throw new Error("Failed to convert GL type");return t}},{key:"getArrayType",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case Xn.UNSIGNED_SHORT_5_6_5:case Xn.UNSIGNED_SHORT_4_4_4_4:case Xn.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var t=ei[e];if(!t)throw new Error("Failed to convert GL type");return t}}},{key:"getByteSize",value:function(t){return e.getArrayType(t).BYTES_PER_ELEMENT}},{key:"validate",value:function(t){return Boolean(e.getArrayType(t))}},{key:"createTypedArray",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;void 0===i&&(i=(r.byteLength-n)/e.getByteSize(t));var a=e.getArrayType(t);return new a(r,n,i)}}]),e}(),ni=function(){function e(t,r){Object(I.a)(this,e),this.json=t,this.buffer=r,this.featuresLength=0,this._cachedTypedArrays={}}return Object(C.a)(e,[{key:"getExtension",value:function(e){return this.json.extensions&&this.json.extensions[e]}},{key:"hasProperty",value:function(e){return Boolean(this.json[e])}},{key:"getGlobalProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$n.UNSIGNED_INT,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.json[e];return n&&Number.isFinite(n.byteOffset)?this._getTypedArrayFromBinary(e,t,r,1,n.byteOffset):n}},{key:"getPropertyArray",value:function(e,t,r){var n=this.json[e];return n&&Number.isFinite(n.byteOffset)?("componentType"in n&&(t=ri.fromName(n.componentType)),this._getTypedArrayFromBinary(e,t,r,this.featuresLength,n.byteOffset)):this._getTypedArrayFromArray(e,t,n)}},{key:"getProperty",value:function(e,t,r,n,i){var a=this.json[e];if(!a)return a;var o=this.getPropertyArray(e,t,r);if(1===r)return o[n];for(var s=0;s<r;++s)i[s]=o[r*n+s];return i}},{key:"_getTypedArrayFromBinary",value:function(e,t,r,n,i){var a=this._cachedTypedArrays,o=a[e];return o||(o=ri.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,n*r),a[e]=o),o}},{key:"_getTypedArrayFromArray",value:function(e,t,r){var n=this._cachedTypedArrays,i=n[e];return i||(i=ri.createTypedArray(t,r),n[e]=i),i}}]),e}(),ii={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ai={SCALAR:function(e,t){return e[t]},VEC2:function(e,t){return[e[2*t+0],e[2*t+1]]},VEC3:function(e,t){return[e[3*t+0],e[3*t+1],e[3*t+2]]},VEC4:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT2:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT3:function(e,t){return[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]]},MAT4:function(e,t){return[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]}},oi={SCALAR:function(e,t,r){t[r]=e},VEC2:function(e,t,r){t[2*r+0]=e[0],t[2*r+1]=e[1]},VEC3:function(e,t,r){t[3*r+0]=e[0],t[3*r+1]=e[1],t[3*r+2]=e[2]},VEC4:function(e,t,r){t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT2:function(e,t,r){t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT3:function(e,t,r){t[9*r+0]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t[9*r+9]=e[9]},MAT4:function(e,t,r){t[16*r+0]=e[0],t[16*r+1]=e[1],t[16*r+2]=e[2],t[16*r+3]=e[3],t[16*r+4]=e[4],t[16*r+5]=e[5],t[16*r+6]=e[6],t[16*r+7]=e[7],t[16*r+8]=e[8],t[16*r+9]=e[9],t[16*r+10]=e[10],t[16*r+11]=e[11],t[16*r+12]=e[12],t[16*r+13]=e[13],t[16*r+14]=e[14],t[16*r+15]=e[15]}};function si(e){throw new Error('"'+e+'" is read-only')}var ui=function(e){return void 0!==e};function ci(e,t,r){if(!t)return null;var n=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?function(e,t){var r,n,i,a,o=e.instancesLength,s=e.classes,u=e.classIds,c=e.parentCounts,h=e.parentIds,l=o;ui(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),si("classIds"),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,o));if(ui(c))for(ui(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),si("parentCounts"),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,o)),a=new Uint16Array(o),si("parentIdsLength"),l=0,r=0;r<o;++r)a[r]=l,l+=(si("parentIdsLength"),c[r]);ui(h)&&ui(h.byteOffset)&&(h.componentType=defaultValue(h.componentType,GL.UNSIGNED_SHORT),h.type=AttributeType.SCALAR,i=getBinaryAccessor(h),si("parentIds"),h=i.createArrayBufferView(t.buffer,t.byteOffset+h.byteOffset,l));var f=s.length;for(r=0;r<f;++r){var d=s[r].length,y=s[r].instances,v=getBinaryProperties(d,y,t);s[r].instances=combine(v,y)}var p=new Array(f).fill(0),g=new Uint16Array(o);for(r=0;r<o;++r)n=u[r],g[r]=p[n],++p[n];var m={classes:s,classIds:u,classIndexes:g,parentCounts:c,parentIndexes:a,parentIds:h};return function(e){for(var t=e.classIds.length,r=0;r<t;++r)li(e,r,stack)}(m),m}(n,r):null}function hi(e,t,r){if(e){var n=e.parentCounts;return e.parentIds?r(e,t):n>0?function(e,t,r){var n=e.classIds,i=e.parentCounts,a=e.parentIds,o=e.parentIndexes,s=n.length,u=scratchVisited;u.length=Math.max(u.length,s);var c=++marker,h=scratchStack;h.length=0,h.push(t);for(;h.length>0;)if(t=h.pop(),u[t]!==c){u[t]=c;var l=r(e,t);if(ui(l))return l;for(var f=i[t],d=o[t],y=0;y<f;++y){var v=a[d+y];v!==t&&h.push(v)}}return null}(e,t,r):function(e,t,r){var n=!0;for(;n;){var i=r(e,t);if(ui(i))return i;var a=e.parentIds[t];n=a!==t,t=a}throw new Error("traverseHierarchySingleParent")}(e,t,r)}}function li(e,t,r){var n=e.parentCounts,i=e.parentIds,a=e.parentIndexes,o=e.classIds.length;if(ui(i)){assert(t<o,"Parent index ".concat(t," exceeds the total number of instances: ").concat(o)),assert(-1===r.indexOf(t),"Circular dependency detected in the batch table hierarchy."),r.push(t);for(var s=ui(n)?n[t]:1,u=ui(n)?a[t]:t,c=0;c<s;++c){var h=i[u+c];h!==t&&li(e,h,r)}r.pop(t)}}var fi=function(e){return void 0!==e},di=function(e){return e},yi={HIERARCHY:!0,extensions:!0,extras:!0},vi=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(var a in Object(I.a)(this,e),lt(n>=0),this.json=t||{},this.binary=r,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)yi[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=ci(this,this.json,this.binary))}return Object(C.a)(e,[{key:"getExtension",value:function(e){return this.json&&this.json.extensions&&this.json.extensions[e]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(e,t){if(this._checkBatchId(e),lt("string"==typeof t,t),this._hierarchy){var r=hi(this._hierarchy,e,(function(e,r){var n=e.classIds[r];return e.classes[n].name===t}));return fi(r)}return!1}},{key:"isExactClass",value:function(e,t){return lt("string"==typeof t,t),this.getExactClassName(e)===t}},{key:"getExactClassName",value:function(e){if(this._checkBatchId(e),this._hierarchy){var t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}},{key:"hasProperty",value:function(e,t){return this._checkBatchId(e),lt("string"==typeof t,t),fi(this._properties[t])||this._hasPropertyInHierarchy(e,t)}},{key:"getPropertyNames",value:function(e,t){var r;this._checkBatchId(e),(t=fi(t)?t:[]).length=0;var n=Object.keys(this._properties);return(r=t).push.apply(r,Object(yn.a)(n)),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}},{key:"getProperty",value:function(e,t){if(this._checkBatchId(e),lt("string"==typeof t,t),this._binaryProperties){var r=this._binaryProperties[t];if(fi(r))return this._getBinaryProperty(r,e)}var n=this._properties[t];if(fi(n))return di(n[e]);if(this._hierarchy){var i=this._getHierarchyProperty(e,t);if(fi(i))return i}}},{key:"setProperty",value:function(e,t,r){var n=this.featureCount;if(this._checkBatchId(e,n),lt("string"==typeof t,t),this._binaryProperties){var i=this._binaryProperties[t];if(i)return void this._setBinaryProperty(i,e,r)}if(!this._hierarchy||!this._setHierarchyProperty(this,e,t,r)){var a=this._properties[t];fi(a)||(this._properties[t]=new Array(n),a=this._properties[t]),a[e]=di(r)}}},{key:"_checkBatchId",value:function(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(e,t){return e.unpack(e.typedArray,t)}},{key:"_setBinaryProperty",value:function(e,t,r){e.pack(r,e.typedArray,t)}},{key:"_initializeBinaryProperties",value:function(){var e=null;for(var t in this._properties){var r=this._properties[t],n=this._initializeBinaryProperty(t,r);n&&((e=e||{})[t]=n)}return e}},{key:"_initializeBinaryProperty",value:function(e,t){if("byteOffset"in t){var r=t;lt(this.binary,"Property ".concat(e," requires a batch table binary.")),lt(r.type,"Property ".concat(e," requires a type."));var n=function(e,t,r,n){var i=e.componentType;Ir(e.componentType);var a="string"==typeof i?ri.fromName(i):i,o=ii[e.type],s=ai[e.type],u=oi[e.type];return r+=e.byteOffset,{values:ri.createTypedArray(a,t,r,o*n),type:a,size:o,unpacker:s,packer:u}}(r,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:n.values,componentCount:n.size,unpack:n.unpacker,pack:n.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(e,t){if(!this._hierarchy)return!1;var r=hi(this._hierarchy,e,(function(e,r){var n=e.classIds[r],i=e.classes[n].instances;return fi(i[t])}));return fi(r)}},{key:"_getPropertyNamesInHierarchy",value:function(e,t){hi(this._hierarchy,e,(function(e,r){var n=e.classIds[r],i=e.classes[n].instances;for(var a in i)i.hasOwnProperty(a)&&-1===t.indexOf(a)&&t.push(a)}))}},{key:"_getHierarchyProperty",value:function(e,t){var r=this;return hi(this._hierarchy,e,(function(e,n){var i=e.classIds[n],a=e.classes[i],o=e.classIndexes[n],s=a.instances[t];return fi(s)?fi(s.typedArray)?r._getBinaryProperty(s,o):di(s[o]):null}))}},{key:"_setHierarchyProperty",value:function(e,t,r,n){var i=this,a=hi(this._hierarchy,t,(function(e,a){var o=e.classIds[a],s=e.classes[o],u=e.classIndexes[a],c=s.instances[r];return!!fi(c)&&(lt(a===t,'Inherited property "'.concat(r,'" is read-only.')),fi(c.typedArray)?i._setBinaryProperty(c,u,n):c[u]=di(n),!0)}));return fi(a)}}]),e}(),pi=4;function gi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new DataView(t);if(e.magic=n.getUint32(r,!0),r+=pi,e.version=n.getUint32(r,!0),r+=pi,e.byteLength=n.getUint32(r,!0),r+=pi,1!==e.version)throw new Error("3D Tile Version ".concat(e.version," not supported"));return r}var mi=4;function bi(e,t,r){var n=new DataView(t);return e.header=e.header||{},e.header.featureTableJsonByteLength=n.getUint32(r,!0),r+=mi,e.header.featureTableBinaryByteLength=n.getUint32(r,!0),r+=mi,e.header.batchTableJsonByteLength=n.getUint32(r,!0),r+=mi,e.header.batchTableBinaryByteLength=n.getUint32(r,!0),r+=mi}function wi(e,t,r,n){return r=function(e,t,r,n){var i=e.header,a=i.featureTableJsonByteLength,o=i.featureTableBinaryByteLength;if(e.featureTableJson={BATCH_LENGTH:0},a>0){var s=Qn(t,r,a);e.featureTableJson=JSON.parse(s)}return r+=a,e.featureTableBinary=new Uint8Array(t,r,o),r+=o}(e,t,r),r=function(e,t,r,n){var i=e.header,a=i.batchTableJsonByteLength,o=i.batchTableBinaryByteLength;if(a>0){var s=Qn(t,r,a);e.batchTableJson=JSON.parse(s),r+=a,o>0&&(e.batchTableBinary=new Uint8Array(t,r,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),r+=o)}return r}(e,t,r)}function Oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=e>>11&31,n=e>>5&63,i=31&e;return t[0]=r<<3,t[1]=n<<2,t[2]=i<<3,t}function _i(e,t,r){if(!(t||e&&e.batchIds&&r))return null;var n=e.batchIds,i=e.isRGB565,a=e.pointCount;if(n&&r){for(var o=new Uint8ClampedArray(3*a),s=0;s<a;s++){var u=n[s],c=r.getProperty(u,"dimensions").map((function(e){return 255*e}));o[3*s]=c[0],o[3*s+1]=c[1],o[3*s+2]=c[2]}return{type:$n.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){for(var h=new Uint8ClampedArray(3*a),l=0;l<a;l++){var f=Oi(t[l]);h[3*l]=f[0],h[3*l+1]=f[1],h[3*l+2]=f[2]}return{type:$n.UNSIGNED_BYTE,value:h,size:3,normalized:!0}}return t&&t.length===3*a?{type:$n.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:$n.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}function ki(e,t){if(!e)throw new Error("math.gl assertion failed. ".concat(t))}new _e.d,new _e.e,new _e.d,new _e.d,new Uint8Array(1);function xi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return Object(_e.h)(e,0,t)/t*2-1}function Ti(e){return e<0?-1:1}function Ei(e,t,r,n){if(ki(n),e<0||e>r||t<0||t>r)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(r));if(n.x=xi(e,r),n.y=xi(t,r),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){var i=n.x;n.x=(1-Math.abs(n.y))*Ti(i),n.y=(1-Math.abs(i))*Ti(n.y)}return n.normalize()}function Si(e,t,r){return Ei(e,t,255,r)}var ji=new _e.e;function Mi(e,t,r){return e.isQuantized?r.decodeQuantizedPositions?(e.isQuantized=!1,function(e,t){for(var r=new _e.e,n=new Float32Array(3*e.pointCount),i=0;i<e.pointCount;i++)r.set(t[3*i],t[3*i+1],t[3*i+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(n,3*i);return n}(e,t)):{type:$n.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function Pi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Li(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pi(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ai(e,t,r,n,i){var a,o,s;return Me.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=gi(e,t,r,n),r=bi(e,t,r),r=wi(e,t,r),Ni(e),a=Ii(e),o=a.featureTable,s=a.batchTable,u.next=7,Me.a.awrap(Ui(e,o,s,n,i));case 7:return Ci(e,o,n),Ri(e,o,s),Di(e,o),u.abrupt("return",r);case 11:case"end":return u.stop()}}))}function Ni(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function Ii(e){var t=new ni(e.featureTableJson,e.featureTableBinary),r=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(r))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=r,e.featuresLength=r,e.pointsLength=r,e.pointCount=r,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",$n.FLOAT,3);var n=function(e,t){var r=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",$n.UNSIGNED_SHORT,1),e.batchIds)){var n=t.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=e.batchTableJson,a=e.batchTableBinary;r=new vi(i,a,n)}return r}(e,t);return{featureTable:t,batchTable:n}}function Ci(e,t,r){if(!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",$n.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){var n=t.getPropertyArray("POSITION_QUANTIZED",$n.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",$n.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",$n.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Mi(e,n,r)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function Ri(e,t,r){if(!e.attributes.colors){var n=null;t.hasProperty("RGBA")?(n=t.getPropertyArray("RGBA",$n.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?n=t.getPropertyArray("RGB",$n.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(n=t.getPropertyArray("RGB565",$n.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=_i(e,n,r)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",$n.UNSIGNED_BYTE,4))}function Di(e,t){if(!e.attributes.normals){var r=null;t.hasProperty("NORMAL")?r=t.getPropertyArray("NORMAL",$n.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(r=t.getPropertyArray("NORMAL_OCT16P",$n.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(!t)return null;if(e.isOctEncoded16P){for(var r=new Float32Array(3*e.pointsLength),n=0;n<e.pointsLength;n++)Si(t[2*n],t[2*n+1],ji),ji.toArray(r,3*n);return{type:$n.FLOAT,size:2,value:r}}return{type:$n.FLOAT,size:2,value:t}}(e,r)}}function Ui(e,t,r,n,i){var a,o,s,u,c,h,l,f;return Me.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:if((u=r&&r.getExtension("3DTILES_draco_point_compression"))&&(s=u.properties),!(c=t.getExtension("3DTILES_draco_point_compression"))){d.next=15;break}if(o=c.properties,h=c.byteOffset,l=c.byteLength,o&&Number.isFinite(h)&&l){d.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:a=e.featureTableBinary.slice(h,h+l),e.hasPositions=Number.isFinite(o.POSITION),e.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),e.hasNormals=Number.isFinite(o.NORMAL),e.hasBatchIds=Number.isFinite(o.BATCH_ID),e.isTranslucent=Number.isFinite(o.RGBA);case 15:if(a){d.next=17;break}return d.abrupt("return",!0);case 17:return f={buffer:a,properties:Li({},o,{},s),featureTableProperties:o,batchTableProperties:s,dequantizeInShader:!1},d.next=20,Me.a.awrap(Bi(e,f,n,i));case 20:return d.abrupt("return",d.sent);case 21:case"end":return d.stop()}}))}function Bi(e,t,r,n){var i,a,o,s,u,c,h,l,f,d;return Me.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.parse,r.next=3,Me.a.awrap(i(t.buffer,{}));case 3:a=r.sent,o=a.attributes.POSITION&&a.attributes.POSITION.value,s=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,u=a.attributes.NORMAL&&a.attributes.NORMAL.value,c=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,h=o&&a.attributes.POSITION.value.quantization,l=u&&a.attributes.NORMAL.value.quantization,h&&(f=a.POSITION.data.quantization,d=f.range,e.quantizedVolumeScale=new _e.e(d,d,d),e.quantizedVolumeOffset=new _e.e(f.minValues),e.quantizedRange=(1<<f.quantizationBits)-1,e.isQuantizedDraco=!0),l&&(e.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0),e.attributes={positions:o,colors:_i(e,s),normals:u,batchIds:c};case 13:case"end":return r.stop()}}))}function Fi(e,t){if(!e)throw new Error(t)}var Vi=r(33),qi="undefined"!=typeof ImageBitmap,zi=void 0!==("undefined"==typeof Image?"undefined":Object(Rr.a)(Image)),Gi=Boolean(Vi.a._parseImageNode);function Wi(e){switch(e){case"imagebitmap":return qi;case"html":return zi;case"ndarray":return Gi;default:throw new Error("Unknown image format ".concat(e))}}function Hi(){var e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).image||{}).type||"auto";switch(e){case"imagebitmap":case"html":case"ndarray":if(!Wi(e))throw new Error("Requested image type ".concat(e," not available in current environment"));return e;case"auto":return function(){if(Wi("ndarray"))return"ndarray";if(Wi("html"))return"html";if(Wi("imagebitmap"))return"imagebitmap";if(!Vi.b)throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js");return Fi(!1)}();default:throw new Error("Unknown image format ".concat(e))}}var Zi=!1,Qi=!0,Yi=new Map([["image/png",{test:Ki,getSize:function(e){return{width:e.getUint32(16,Zi),height:e.getUint32(20,Zi)}}}],["image/jpeg",{test:$i,getSize:function(e){if(e.byteLength<2||65496!==e.getUint16(0,Zi))return null;var t=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);var r=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:r}}(),r=t.tableMarkers,n=t.sofMarkers,i=2;for(;i<e.byteLength;){var a=e.getUint16(i,Zi);if(n.has(a))return{height:e.getUint16(i+5,Zi),width:e.getUint16(i+7,Zi)};if(!r.has(a))return null;i+=2,i+=e.getUint16(i,Zi)}return null}}],["image/gif",{test:Ji,getSize:function(e){return{width:e.getUint16(6,Qi),height:e.getUint16(8,Qi)}}}],["image/bmp",{test:Xi,getSize:function(e){return{width:e.getUint32(18,Qi),height:e.getUint32(22,Qi)}}}]]);function Ki(e){return e.byteLength>=24&&2303741511===e.getUint32(0,Zi)}function Ji(e){return e.byteLength>=10&&1195984440===e.getUint32(0,Zi)}function Xi(e){return e.byteLength>=2&&16973===e.getUint16(0,Zi)}function $i(e){return e.byteLength>=3&&65496===e.getUint16(0,Zi)&&255===e.getUint8(2,Zi)}"Invalid MIME type. Supported MIME types are: ".concat(Array.from(Yi.keys()).join(", "));function ea(e){var t=ta(e),r=!0,n=!1,i=void 0;try{for(var a,o=Yi.entries()[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=Object(F.a)(a.value,2),u=s[0];if((0,s[1].test)(t))return u}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}return null}function ta(e){if((e=e.buffer||e)instanceof ArrayBuffer||ArrayBuffer.isView(e))return new DataView(e.buffer||e);throw new Error("toDataView")}function ra(e,t){Fi(Vi.a._parseImageNode);var r=ea(e);return Vi.a._parseImageNode(e,r,t)}function na(e,t){var r,n,i;return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return"image/jpeg",r=new Blob([e],{type:"image/jpeg"}),n=self.URL||self.webkitURL,i=n.createObjectURL(r),a.prev=4,a.next=7,Me.a.awrap(ia(i,t));case 7:return a.abrupt("return",a.sent);case 8:return a.prev=8,n.revokeObjectURL(i),a.finish(8);case 11:case"end":return a.stop()}}),null,null,[[4,,8,11]])}function ia(e,t){var r;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=new Image).src=e,!(t.image&&t.image.decode&&r.decode)){n.next=6;break}return n.next=5,Me.a.awrap(r.decode());case 5:return n.abrupt("return",r);case 6:return n.next=8,Me.a.awrap(new Promise((function(t,n){try{r.onload=function(){return t(r)},r.onerror=function(t){return n(new Error("Could not load image ".concat(e,": ").concat(t)))}}catch(e){n(e)}})));case 8:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}))}function aa(e,t){var r=new Blob([new Uint8Array(e)]),n=t&&t.imagebitmap;return n?createImageBitmap(r):createImageBitmap(r,n)}function oa(e,t){var r,n,i;return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return r=new TextDecoder,n=r.decode(e),i="data:image/svg+xml;base64,".concat(btoa(n)),a.next=5,Me.a.awrap(ia(i,t));case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}))}function sa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ua(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sa(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ca={name:"Images",version:"2.0.0",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vndmicrosofticon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(e,t,r){var n,i;return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("image"in t&&(t=ua({},t,{image:{}})),!(n=(r||{}).url)||!/\.svg((\?|#).*)?$/.test(n)){a.next=7;break}return console.warn("@loaders.gl/images: SVG parsing needs to be fixed for 2.0"),a.next=6,Me.a.awrap(oa(e,t));case 6:return a.abrupt("return",a.sent);case 7:i=Hi(t),a.t0=i,a.next="imagebitmap"===a.t0?11:"html"===a.t0?14:"ndarray"===a.t0?17:20;break;case 11:return a.next=13,Me.a.awrap(aa(e,t));case 13:return a.abrupt("return",a.sent);case 14:return a.next=16,Me.a.awrap(na(e,t));case 16:return a.abrupt("return",a.sent);case 17:return a.next=19,Me.a.awrap(ra(e,t));case 19:return a.abrupt("return",a.sent);case 20:return a.abrupt("return",Fi(!1));case 21:case"end":return a.stop()}}))},test:function(e){var t=new DataView(e);return $i(t)||Xi(t)||Ji(t)||Ki(t)},options:{images:{format:"auto",decodeHTML:!0}}};function ha(e,t,r){if(e.byteLength<=t+r)return"";for(var n=new DataView(e),i="",a=0;a<r;a++)i+=String.fromCharCode(n.getUint8(t+a));return i}function la(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return ha(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return ha(e,0,t)}return""}(e),'"'))}}function fa(e){return e+3&-4}function da(e,t,r){var n=r?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}function ya(e,t,r){var n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{var i=e.byteOffset,a=e.byteLength;n=new Uint8Array(e.buffer,i,a)}return t.set(n,r),r+fa(n.byteLength)}function va(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function pa(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var r=t.baseUri||t.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return r.substr(0,r.lastIndexOf("/")+1)+e}function ga(e,t,r){var n=e.bufferViews[r];va(n);var i=t[n.buffer];va(i);var a=(n.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,a,n.byteLength)}var ma=["SCALAR","VEC2","VEC3","VEC4"],ba=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),wa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Oa={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},_a={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function ka(e){return ma[e-1]||ma[0]}function xa(e){var t=ba.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function Ta(e,t){var r=_a[e.componentType],n=wa[e.type],i=Oa[e.componentType],a=e.count*n,o=e.count*n*i;return va(o>=0&&o<=t.byteLength),{ArrayType:r,length:a,byteLength:o}}var Ea=function(){function e(t){if(Object(I.a)(this,e),t instanceof e)return t;t||(t={json:{version:2,buffers:[]},buffers:[]}),this.gltf=t,va(this.gltf.json)}return Object(C.a)(e,[{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),r=this.json.extensions||{};return t?r[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(e,t){return(e.extensions||{})[t]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,t){if("object"===Object(Rr.a)(t))return t;var r=this.json[e]&&this.json[e][t];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return r}},{key:"getTypedArrayForBufferView",value:function(e){var t=(e=this.getBufferView(e)).buffer,r=this.gltf.buffers[t];va(r);var n=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,n,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,n=Ta(e,t),i=n.ArrayType,a=n.length;return new i(r,t.byteOffset+e.byteOffset,a)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}},{key:"addApplicationData",value:function(e,t){return this.json[e]=t,this}},{key:"addExtraData",value:function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}},{key:"addObjectExtension",value:function(e,t,r){return va(r),e.extensions=e.extensions||{},e.extensions[t]=r,this.registerUsedExtension(t),this}},{key:"removeObjectExtension",value:function(e,t){return delete(e.extensions||{})[t],this}},{key:"addExtension",value:function(e,t){return va(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),this}},{key:"addRequiredExtension",value:function(e,t){return va(t),this.addExtension(e,t),this.registerRequiredExtension(e),this}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"setObjectExtension",value:function(e,t,r){(e.extensions||{})[t]=r}},{key:"addMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=this._addAttributes(e),i={primitives:[{attributes:n,indices:t,mode:r}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}},{key:"addImage",value:function(e,t){t=t||ea(e);var r={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(r),this.json.images.length-1}},{key:"addBufferView",value:function(e){var t=e.byteLength;va(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var r={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=fa(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,t){var r={bufferView:e,type:ka(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},r=this.addBufferView(e),n={size:t.size,componentType:xa(e),count:Math.round(e.length/t.size)};return this.addAccessor(r,Object.assign(n,t))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),r=new Uint8Array(t),n=0,i=0;i<this.sourceBuffers.length;i++){n=ya(this.sourceBuffers[i],r,n)}this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}}},{key:"_removeStringFromArray",value:function(e,t){for(var r=!0;r;){var n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}},{key:"json",get:function(){return this.gltf.json}}]),e}(),Sa="KHR_draco_mesh_compression",ja="KHR_lights_punctual",Ma="KHR_materials_unlit";function Pa(e){var t={};for(var r in e){var n=e[r];if("indices"!==r){var i=La(n);t[r]=i}}return t}function La(e,t){var r=function(e,t){var r=e,n=1,i=0;e&&e.value&&(r=e.value,n=e.size||1);r&&(ArrayBuffer.isView(r)||(r=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;if(Array.isArray(e))return new t(e);if(r&&!(e instanceof t))return new t(e);return e}(r,Float32Array)),i=r.length/n);return{buffer:r,size:n,count:i}}(e),n=r.buffer,i=r.size;return{value:n,size:i,bufferView:null,byteOffset:0,count:r.count,type:ka(i),componentType:xa(n)}}var Aa=Me.a.mark(Ua);function Na(e,t,r){var n,i,a,o,s,u,c,h;return Me.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(t.gltf.decompressMeshes){l.next=2;break}return l.abrupt("return");case 2:for(n=new Ea(e),i=[],a=!0,o=!1,s=void 0,l.prev=7,u=Ua(n)[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)h=c.value,n.getObjectExtension(h,Sa)&&i.push(Ca(h,n,t,r));l.next=15;break;case 11:l.prev=11,l.t0=l.catch(7),o=!0,s=l.t0;case 15:l.prev=15,l.prev=16,a||null==u.return||u.return();case 18:if(l.prev=18,!o){l.next=21;break}throw s;case 21:return l.finish(18);case 22:return l.finish(15);case 23:return l.next=25,Me.a.awrap(Promise.all(i));case 25:n.removeExtension(Sa);case 26:case"end":return l.stop()}}),null,null,[[7,11,15,23],[16,,18,22]])}function Ia(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Ea(e),n=!0,i=!1,a=void 0;try{for(var o,s=(r.json.meshes||[])[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){Ra(o.value,t),r.addRequiredExtension(Sa)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}}function Ca(e,t,r,n){var i,a,o,s,u;return Me.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return i=t.getObjectExtension(e,Sa),a=t.getTypedArrayForBufferView(i.bufferView),o=da(a.buffer,a.byteOffset),s=n.parse,c.next=6,Me.a.awrap(s(o,[],r,n));case 6:u=c.sent,e.attributes=Pa(u.attributes),u.indices&&(e.indices=La(u.indices)),Da(e);case 10:case"end":return c.stop()}}))}function Ra(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!n.DracoWriter||!n.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var a=n.DracoWriter.encodeSync({attributes:e}),o=(0,i.parseSync)({attributes:e}),s=n._addFauxAttributes(o.attributes),u=n.addBufferView(a);return{primitives:[{attributes:s,mode:r,extensions:Ie({},Sa,{bufferView:u,attributes:s})}]}}function Da(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function Ua(e){var t,r,n,i,a,o,s,u,c,h,l,f;return Me.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:t=!0,r=!1,n=void 0,d.prev=3,i=(e.json.meshes||[])[Symbol.iterator]();case 5:if(t=(a=i.next()).done){d.next=36;break}o=a.value,s=!0,u=!1,c=void 0,d.prev=10,h=o.primitives[Symbol.iterator]();case 12:if(s=(l=h.next()).done){d.next=19;break}return f=l.value,d.next=16,f;case 16:s=!0,d.next=12;break;case 19:d.next=25;break;case 21:d.prev=21,d.t0=d.catch(10),u=!0,c=d.t0;case 25:d.prev=25,d.prev=26,s||null==h.return||h.return();case 28:if(d.prev=28,!u){d.next=31;break}throw c;case 31:return d.finish(28);case 32:return d.finish(25);case 33:t=!0,d.next=5;break;case 36:d.next=42;break;case 38:d.prev=38,d.t1=d.catch(3),r=!0,n=d.t1;case 42:d.prev=42,d.prev=43,t||null==i.return||i.return();case 45:if(d.prev=45,!r){d.next=48;break}throw n;case 48:return d.finish(45);case 49:return d.finish(42);case 50:case"end":return d.stop()}}),Aa,null,[[3,38,42,50],[10,21,25,33],[26,,28,32],[43,,45,49]])}function Ba(e,t){var r=new Ea(e),n=r.json,i=r.getExtension(ja);i&&(r.json.lights=i.lights,r.removeExtension(ja));var a=!0,o=!1,s=void 0;try{for(var u,c=(n.nodes||[])[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var h=u.value,l=r.getObjectExtension(h,ja);l&&(h.light=l.light),r.removeObjectExtension(h,ja)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}}function Fa(e,t){var r=new Ea(e),n=r.json;if(n.lights){var i=r.addExtensions(ja);va(!i.lights),i.lights=n.lights,delete n.lights}if(r.json.lights){var a=!0,o=!1,s=void 0;try{for(var u,c=r.json.lights[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var h=u.value,l=h.node;r.addObjectExtension(l,ja,h)}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}delete r.json.lights}}function Va(e,t){var r=new Ea(e),n=r.json;r.removeExtension(Ma);var i=!0,a=!1,o=void 0;try{for(var s,u=(n.materials||[])[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;c.extensions&&c.extensions.KHR_materials_unlit&&(c.unlit=!0),r.removeObjectExtension(c,Ma)}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}function qa(e,t){var r=new Ea(e),n=r.json;if(r.materials){var i=!0,a=!1,o=void 0;try{for(var s,u=n.materials[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;c.unlit&&(delete c.unlit,r.addObjectExtension(c,Ma),r.addExtensions(Ma))}}catch(e){a=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw o}}}}var za={KHR_draco_mesh_compression:i,KHR_lights_punctual:a,KHR_materials_unlit:o};function Ga(e){var t,r,n,i,a,o=arguments;return Me.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:t=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2?o[2]:void 0,t.gltf=t.gltf||{},s.t0=Me.a.keys(za);case 4:if((s.t1=s.t0()).done){s.next=14;break}if(n=s.t1.value,i=t.gltf.excludeExtensions||{},n in i&&!i[n]){s.next=12;break}return a=za[n],s.next=12,Me.a.awrap(a.decode(e,t,r));case 12:s.next=4;break;case 14:case"end":return s.stop()}}))}var Wa,Ha=1735152710,Za=12,Qa=8,Ya=1313821514,Ka=5130562,Ja=0,Xa=1,$a=!0;function eo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new DataView(e),i=r.magic,a=void 0===i?Ha:i,o=n.getUint32(t,!1);return o===a||o===Ha}function to(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new DataView(t);e.type=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}(i,r+0),e.version=i.getUint32(r+4,$a);var a=i.getUint32(r+8,$a);return e.header={byteOffset:r,byteLength:a},Ir(2===e.version,"Invalid GLB version ".concat(e.version,". Only supports v2.")),Ir(e.header.byteLength>Za+Qa),e.json={},e.binChunks=[],function(e,t,r,n){for(;r+8<=e.header.byteLength;){var i=t.getUint32(r+0,$a),a=t.getUint32(r+4,$a);switch(r+=Qa,a){case Ya:ro(e,t,r,i,n);break;case Ka:no(e,t,r,i,n);break;case Ja:n.glb.strict||ro(e,t,r,i,n);break;case Xa:n.glb.strict||no(e,t,r,i,n)}r+=fa(i)}}(e,i,r+Za,n),r+e.header.byteLength}function ro(e,t,r,n,i){var a=new Uint8Array(t.buffer,r,n),o=new TextDecoder("utf8").decode(a);e.json=JSON.parse(o)}function no(e,t,r,n,i){e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:t.buffer})}function io(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ao(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?io(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):io(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oo={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},so={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},uo={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},co={magFilter:uo.TEXTURE_MAG_FILTER,minFilter:uo.TEXTURE_MIN_FILTER,wrapS:uo.TEXTURE_WRAP_S,wrapT:uo.TEXTURE_WRAP_T},ho=(Ie(Wa={},uo.TEXTURE_MAG_FILTER,uo.LINEAR),Ie(Wa,uo.TEXTURE_MIN_FILTER,uo.NEAREST_MIPMAP_LINEAR),Ie(Wa,uo.TEXTURE_WRAP_S,uo.REPEAT),Ie(Wa,uo.TEXTURE_WRAP_,uo.REPEAT),Wa);var lo=function(){function e(){Object(I.a)(this,e)}return Object(C.a)(e,[{key:"postProcess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.json,n=e.buffers,i=void 0===n?[]:n,a=e.images,o=void 0===a?[]:a,s=e.baseUri,u=void 0===s?"":s;return va(r),this.baseUri=u,this.json=r,this.buffers=i,this.images=o,this._resolveTree(this.json,t),this.json}},{key:"_resolveTree",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,r){return t._resolveBufferView(e,r)}))),e.images&&(e.images=e.images.map((function(e,n){return t._resolveImage(e,n,r)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,r){return t._resolveSampler(e,r)}))),e.textures&&(e.textures=e.textures.map((function(e,r){return t._resolveTexture(e,r)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,n){return t._resolveAccessor(e,n,r)}))),e.materials&&(e.materials=e.materials.map((function(e,r){return t._resolveMaterial(e,r)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,r){return t._resolveMesh(e,r)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,r){return t._resolveNode(e,r)}))),e.skins&&(e.skins=e.skins.map((function(e,r){return t._resolveSkin(e,r)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,r){return t._resolveScene(e,r)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Object(Rr.a)(t))return t;var r=this.json[e]&&this.json[e][t];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),r}},{key:"_resolveScene",value:function(e,t){var r=this;return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map((function(e){return r.getNode(e)})),e}},{key:"_resolveNode",value:function(e,t){var r=this;return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map((function(e){return r.getNode(e)}))),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}},{key:"_resolveSkin",value:function(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}},{key:"_resolveMesh",value:function(e,t){var r=this;return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=ao({},e)).attributes;for(var n in e.attributes={},t)e.attributes[n]=r.getAccessor(t[n]);return void 0!==e.indices&&(e.indices=r.getAccessor(e.indices)),void 0!==e.material&&(e.material=r.getMaterial(e.material)),e}))),e}},{key:"_resolveMaterial",value:function(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture=ao({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ao({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ao({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ao({},e.pbrMetallicRoughness);var r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture=ao({},r.baseColorTexture),r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture=ao({},r.metallicRoughnessTexture),r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}},{key:"_resolveAccessor",value:function(e,t){var r,n;if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(r=e.componentType,so[r]),e.components=(n=e.type,oo[n]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,a=Ta(e,e.bufferView),o=a.ArrayType,s=a.length,u=(e.bufferView.byteOffset||0)+i.byteOffset;e.value=new o(i.arrayBuffer,u,s)}return e}},{key:"_resolveTexture",value:function(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):ho,e.source=this.getImage(e.source),e}},{key:"_resolveSampler",value:function(e,t){for(var r in e.id=e.id||"sampler-".concat(t),e.parameters={},e){var n=this._enumSamplerParameter(r);void 0!==n&&(e.parameters[n]=e[r])}return e}},{key:"_enumSamplerParameter",value:function(e){return co[e]}},{key:"_resolveImage",value:function(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var r=this.images[t];return r&&(e.image=r),e}},{key:"_resolveBufferView",value:function(e,t){e.id=e.id||"bufferView-".concat(t);var r=e.buffer;e.buffer=this.buffers[r];var n=this.buffers[r].arrayBuffer,i=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(n,i,e.byteLength),e}},{key:"_resolveCamera",value:function(e,t){return e.id=e.id||"camera-".concat(t),e.perspective,e.orthographic,e}}]),e}();function fo(e,t){return(new lo).postProcess(e,t)}function yo(e,t){var r,n,i,a,o,s,u=arguments;return Me.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:0,n=u.length>3?u[3]:void 0,i=u.length>4?u[4]:void 0,vo(e,t,r,n),a=[],n.gltf.loadImages&&(o=go(e,n,i),a.push(o)),!n.gltf.loadBuffers){c.next=9;break}return c.next=9,Me.a.awrap(po(e,n,i));case 9:return s=Ga(e,n,i),a.push(s),c.next=13,Me.a.awrap(Promise.all(a));case 13:return c.abrupt("return",n.gltf.postProcess?fo(e,n):e);case 14:case"end":return c.stop()}}))}function vo(e,t,r,n){(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!eo(t,r,n))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=la(t);else if(t instanceof ArrayBuffer){var i={};r=to(i,t,r,n),va("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else va(!1,"GLTF: must be ArrayBuffer or string");var a=e.json.buffers||[];if(e.buffers=new Array(a.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var o=e._glb.binChunks;e.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}var s=e.json.images||[];e.images=new Array(s.length).fill({})}function po(e,t,r){var n,i,a,o,s,u;return Me.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:n=0;case 1:if(!(n<e.json.buffers.length)){c.next=18;break}if(!(i=e.json.buffers[n]).uri){c.next=15;break}return va(a=r.fetch),o=pa(i.uri,t),c.next=9,Me.a.awrap(a(o));case 9:return s=c.sent,c.next=12,Me.a.awrap(s.arrayBuffer());case 12:u=c.sent,e.buffers[n]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete i.uri;case 15:++n,c.next=1;break;case 18:case"end":return c.stop()}}))}function go(e,t,r){var n,i,a;return Me.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:for(n=e.json.images||[],i=[],a=0;a<n.length;++a)i.push(mo(e,n[a],a,t,r));return o.next=5,Me.a.awrap(Promise.all(i));case 5:return o.abrupt("return",o.sent);case 6:case"end":return o.stop()}}))}function mo(e,t,r,n,i){var a,o,s,u,c,h,l;return Me.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(a=i.fetch,o=i.parse,!t.uri){f.next=9;break}return u=pa(t.uri,n),f.next=5,Me.a.awrap(a(u));case 5:return c=f.sent,f.next=8,Me.a.awrap(c.arrayBuffer());case 8:s=f.sent;case 9:return Number.isFinite(t.bufferView)&&(h=ga(e.json,e.buffers,t.bufferView),s=da(h.buffer,h.byteOffset,h.byteLength)),va(s,"glTF image has no data"),f.next=13,Me.a.awrap(o(s,ca,{},i));case 13:l=f.sent,e.images[r]=l;case 15:case"end":return f.stop()}}))}function bo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Oo={id:"gltf",name:"glTF",version:"2.0.0",extensions:["gltf","glb"],mimeType:"model/gltf+json",text:!0,binary:!0,test:"glTF",parse:function(e){var t,r,n,i,a,o=arguments;return Me.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},r=o.length>2?o[2]:void 0,(t=wo({},Oo.options,{},t)).gltf=wo({},Oo.options.gltf,{},t.gltf),ko(t),n=t.byteOffset,i=void 0===n?0:n,a={},s.next=9,Me.a.awrap(yo(a,e,i,t,r));case 9:return s.abrupt("return",s.sent);case 10:case"end":return s.stop()}}))},options:{gltf:{loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console}},_o=Oo;function ko(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}var xo={URI:0,EMBEDDED:1};function To(e,t,r){e.rotateYtoZ=!0;var n=e.byteOffset+e.byteLength-r;if(0===n)throw new Error("glTF byte length must be greater than 0.");return e.gltfArrayBuffer=da(t,r,n),e.gltfByteOffset=0,e.gltfByteLength=n,r%4==0||console.warn("".concat(e.type,": embedded glb is not aligned to a 4-byte boundary.")),e.byteOffset+e.byteLength}function Eo(e,t,r,n){var i,a;return Me.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(So(e,t,r),!r.loadGLTF){o.next=15;break}if(i=n.parse,a=n.fetch,!e.gltfUrl){o.next=8;break}return o.next=6,Me.a.awrap(a(e.gltfUrl,r));case 6:e.gltfArrayBuffer=o.sent,e.gltfByteOffset=0;case 8:if(!e.gltfArrayBuffer){o.next=15;break}return o.next=11,Me.a.awrap(i(e.gltfArrayBuffer,_o,r,n));case 11:e.gltf=o.sent,delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;case 15:case"end":return o.stop()}}))}function So(e,t,r){switch(t){case xo.URI:var n=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=(new TextDecoder).decode(n);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case xo.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}function jo(e,t,r,n,i){return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return r=Mo(e,t,r,n,i),a.next=3,Me.a.awrap(Eo(e,xo.EMBEDDED,n,i));case 3:return a.abrupt("return",r);case 4:case"end":return a.stop()}}))}function Mo(e,t,r,n,i){r=To(e,t,r=wi(e,t,r=bi(e,t,r=gi(e,t,r,n))));var a=new ni(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=a.getGlobalProperty("RTC_CENTER",$n.FLOAT,3),Eo(e,xo.EMBEDDED,n,i),r}function Po(e,t,r,n,i){return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return r=Lo(e,t,r,n,i),a.next=3,Me.a.awrap(Eo(e,e.gltfFormat,n,i));case 3:return a.abrupt("return",r);case 4:case"end":return a.stop()}}))}function Lo(e,t,r,n,i){if(r=gi(e,t,r,n),1!==e.version)throw new Error("Instanced 3D Model version ".concat(e.version," is not supported"));r=bi(e,t,r);var a=new DataView(t);if(e.gltfFormat=a.getUint32(r,!0),r=To(e,t,r=wi(e,t,r+=4)),0===e.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new ni(e.featureTableJson,e.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",$n.FLOAT,3);new vi(e.batchTableJson,e.batchTableBinary,s);return function(e,t,r,n){for(var i=[new Array(n),e._batchTable][0],a=new _e.e,o=(new _e.e,new _e.e,new _e.e,new _e.a),s=new _e.c,u=new _e.e,c={},h=new _e.b,l=[],f=[],d=new _e.e,y=new _e.e,v=0;v<n;v++){var p=void 0;if(t.hasProperty("POSITION"))p=t.getProperty("POSITION",$n.FLOAT,3,v,a);else if(t.hasProperty("POSITION_QUANTIZED")){p=t.getProperty("POSITION_QUANTIZED",$n.UNSIGNED_SHORT,3,v,a);var g=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",$n.FLOAT,3,d);if(!g)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var m=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",$n.FLOAT,3,y);if(!m)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var b=0;b<3;b++)p[b]=p[b]/65535*m[b]+g[b]}if(!p)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(p),c.translation=a,e.normalUp=t.getProperty("NORMAL_UP",$n.FLOAT,3,v,l),e.normalRight=t.getProperty("NORMAL_RIGHT",$n.FLOAT,3,v,f);if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",$n.UNSIGNED_SHORT,2,l),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",$n.UNSIGNED_SHORT,2,f),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(ot.WGS84.eastNorthUpToFixedFrame(a,h),h.getRotationMatrix3(o)):o.identity()}!1,s.fromMatrix3(o),c.rotation=s,u.set(1,1,1);var w=t.getProperty("SCALE",$n.FLOAT,1,v);Number.isFinite(w)&&u.multiplyByScalar(w);var O=t.getProperty("SCALE_NON_UNIFORM",$n.FLOAT,3,v,l);O&&u.scale(O),c.scale=u;var _=t.getProperty("BATCH_ID",$n.UNSIGNED_SHORT,1,v);void 0===_&&(_=v);var k=(new _e.b).fromQuaternion(c.rotation);h.identity(),h.translate(c.translation),h.multiplyRight(k),h.scale(c.scale);var x=h.clone();i[v]={modelMatrix:x,batchId:_}}e.instances=i}(e,o,0,s),r}function Ao(e,t,r,n,i,a){var o,s;return Me.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:r=gi(e,t,r,n),o=new DataView(t),e.tilesLength=o.getUint32(r,!0),r+=4,e.tiles=[];case 5:if(!(e.tiles.length<e.tilesLength&&e.byteLength-r>12)){u.next=13;break}return s={},e.tiles.push(s),u.next=10,Me.a.awrap(a(t,r,n,i,s));case 10:r=u.sent,u.next=5;break;case 13:return u.abrupt("return",r);case 14:case"end":return u.stop()}}))}function No(e){var t,r,n,i,a=arguments;return Me.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:t=a.length>1&&void 0!==a[1]?a[1]:0,r=a.length>2?a[2]:void 0,n=a.length>3?a[3]:void 0,i=a.length>4&&void 0!==a[4]?a[4]:{},r=r["3d-tiles"]||{},i.byteOffset=t,i.type=Yn(e,t),o.t0=i.type,o.next=o.t0===zn.COMPOSITE?10:o.t0===zn.BATCHED_3D_MODEL?13:o.t0===zn.INSTANCED_3D_MODEL?16:o.t0===zn.POINT_CLOUD?19:22;break;case 10:return o.next=12,Me.a.awrap(Ao(i,e,t,r,n,No));case 12:return o.abrupt("return",o.sent);case 13:return o.next=15,Me.a.awrap(jo(i,e,t,r,n));case 15:return o.abrupt("return",o.sent);case 16:return o.next=18,Me.a.awrap(Po(i,e,t,r,n));case 18:return o.abrupt("return",o.sent);case 19:return o.next=21,Me.a.awrap(Ai(i,e,t,r,n));case 21:return o.abrupt("return",o.sent);case 22:throw new Error("3DTileLoader: unknown type ".concat(i.type));case 23:case"end":return o.stop()}}))}var Io={id:"3d-tiles",name:"3D Tiles",version:"2.0.0",extensions:["cmpt","pnts","b3dm","i3dm"],mimeType:"application/octet-stream",test:["cmpt","pnts","b3dm","i3dm"],parse:function(e,t,r,n){var i;return Me.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return i={},0,n.next=4,Me.a.awrap(No(e,0,t,r,i));case 4:return n.abrupt("return",i);case 5:case"end":return n.stop()}}))},binary:!0,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1}}},Co={id:"3d-tileset",name:"3D Tileset",extensions:["json"],parse:function(e){return Me.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",JSON.parse((new TextDecoder).decode(e)));case 1:case"end":return t.stop()}}))},parseTextSync:JSON.parse,testText:function(e){return e.indexOf(!1)}},Ro=function(e){return void 0!==e},Do=(new _e.a,new _e.e),Uo=new _e.e,Bo=new _e.e;new _e.b;function Fo(e,t,r){if(lt(e,"3D Tile: boundingVolume must be defined"),e.box)return function(e,t,r){var n=new _e.e(e[0],e[1],e[2]);t.transform(n,n);var i=t.transformAsVector(e.slice(3,6)),a=t.transformAsVector(e.slice(6,9)),o=t.transformAsVector(e.slice(9,12)),s=new _e.a([i[0],i[1],i[2],a[0],a[1],a[2],o[0],o[1],o[2]]);if(Ro(r))return r.center=n,r.halfAxes=s,r;return new fr(n,s)}(e.box,t,r);if(e.region){var n=Object(F.a)(e.region,6),i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],c=n[5],h=ot.WGS84.cartographicToCartesian([Object(_e.j)(i),Object(_e.j)(s),u],Uo),l=ot.WGS84.cartographicToCartesian([Object(_e.j)(o),Object(_e.j)(a),c],Bo),f=(new _e.e).addVectors(h,l).multiplyScalar(.5),d=(new _e.e).subVectors(h,l).len()/2;return Vo([f[0],f[1],f[2],d],new _e.b)}if(e.sphere)return Vo(e.sphere,t,r);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Vo(e,t,r){var n=new _e.e(e[0],e[1],e[2]);t.transform(n,n);var i=t.getScale(Do),a=Math.max(Math.max(i[0],i[1]),i[2]),o=e[3]*a;return Ro(r)?(r.center=n,r.radius=o,r):new St(n,o)}var qo=function(e){return null!=e},zo=new _e.e,Go=function(){function e(t,r,n,i){Object(I.a)(this,e),lt("object"===Object(Rr.a)(r)),this._tileset=t,this._header=r,this._basePath=i,this._content=null,this._contentState=Gn.UNLOADED,this._gpuMemoryUsageInBytes=0,this.parent=n,this.children=[],this.refine=this._getRefine(r.refine),this.cacheNode=void 0,this.userData={},"geometricError"in r?this.geometricError=r.geometricError:(this.geometricError=this.parent&&this.parent.geometricError||t.geometricError,console.warn("3D Tile: Required prop geometricError is undefined. Using parent error")),this._initializeTransforms(r),this._initializeBoundingVolumes(r),this._initializeContent(r),this._initializeCache(r),this._optimChildrenWithinParent=Wn.NOT_COMPUTED,this._initializeRenderingState(),Object.seal(this)}return Object(C.a)(e,[{key:"destroy",value:function(){this._header=null}},{key:"isDestroyed",value:function(){return null===this._header}},{key:"getScreenSpaceError",value:function(e,t){var r=this._tileset,n=this.parent&&this.parent.geometricError||r.geometricError,i=t?n:this.geometricError;if(0===i)return 0;var a=Math.max(this._distanceToCamera,1e-7),o=i*e.height/(a*e.sseDenominator);return o-=this._getDynamicScreenSpaceError(a)}},{key:"_getDynamicScreenSpaceError",value:function(e){var t=this._tileset;if(t.dynamicScreenSpaceError&&t._dynamicScreenSpaceErrorComputedDensity){var r=t._dynamicScreenSpaceErrorComputedDensity,n=t.dynamicScreenSpaceErrorFactor;return function(e,t){var r=e*t;return 1-Math.exp(-r*r)}(e,r)*n}return 0}},{key:"loadContent",value:function(e){var t,r,i;return Me.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(e){return e._visible?e._contentState===Gn.UNLOADED?-1:Math.max(1e7-e._priority,0)||0:-1},!this.hasEmptyContent){e.next=3;break}return e.abrupt("return",!1);case 3:if(!this._content){e.next=5;break}return e.abrupt("return",!0);case 5:return this.contentExpired&&(this.expireDate=void 0),this._contentState=Gn.LOADING,e.next=10,Me.a.awrap(this.tileset._requestScheduler.scheduleRequest(this,t));case 10:if(!!e.sent){e.next=14;break}return this._contentState=Gn.UNLOADED,e.abrupt("return",!1);case 14:return e.prev=14,r=this.uri,e.prev=16,this.tileset._requestScheduler.startRequest(this),e.next=20,Me.a.awrap(Gr(r,this.tileset.options.fetchOptions));case 20:i=e.sent;case 21:return e.prev=21,this.tileset._requestScheduler.endRequest(this),e.finish(21);case 24:return e.next=26,Me.a.awrap(Vn(i,[Io,Co]));case 26:return this._content=e.sent,-1!==r.indexOf(".json")&&this._tileset._initializeTileHeaders(this._content,this,n.dirname(this.uri)),this._contentState=Gn.READY,this._contentLoaded(),e.abrupt("return",!0);case 33:throw e.prev=33,e.t0=e.catch(14),this._contentState=Gn.FAILED,e.t0;case 37:case"end":return e.stop()}}),null,this,[[14,33],[16,,21,24]])}},{key:"unloadContent",value:function(){return!!this.hasRenderContent&&(this._content&&this._content.destroy&&this._content.destroy(),this._content=null,this._contentState=Gn.UNLOADED,!0)}},{key:"updateVisibility",value:function(e){var t=this._tileset;if(this._updatedVisibilityFrame!==t._updatedVisibilityFrame){var r=this.parent,n=r?r.computedTransform:this._tileset.modelMatrix,i=r?r._visibilityPlaneMask:br.MASK_INDETERMINATE;this._updateTransform(n),this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==br.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._updatedVisibilityFrame=t._updatedVisibilityFrame}}},{key:"updateExpiration",value:function(){if(qo(this.expireDate)&&this.contentReady&&!this.hasEmptyContent){var e=Date.now();Date.lessThan(this.expireDate,e)&&(this._contentState=Gn.EXPIRED,this._expiredContent=this._content)}}},{key:"visibility",value:function(e,t){var r=e.cullingVolume,n=this.boundingVolume,i=this.tileset,a=i.clippingPlanes,o=i.clippingPlanesOriginMatrix;if(a&&a.enabled){var s=a.computeIntersectionWithBoundingVolume(n,o);if(this._isClipped=s!==Ot.INSIDE,s===Ot.OUTSIDE)return br.MASK_OUTSIDE}return r.computeVisibilityWithPlaneMask(n,t)}},{key:"contentVisibility",value:function(e){return!0}},{key:"distanceToTile",value:function(e){var t=this._boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))}},{key:"cameraSpaceZDepth",value:function(e){var t=e.camera,r=this.boundingVolume;return zo.subVectors(r.center,t.position),t.direction.dot(zo)}},{key:"insideViewerRequestVolume",value:function(e){var t=this._viewerRequestVolume;return!t||0===t.distanceToCamera(e)}},{key:"_initializeCache",value:function(e){this.cacheNode=void 0;var t,r,n=e.expire;n&&(t=n.duration,n.date&&(r=Date.fromIso8601(n.date))),this.expireDuration=t,this.expireDate=r}},{key:"_initializeTransforms",value:function(e){this.transform=e.transform?new _e.b(e.transform):new _e.b;var t=this.parent,r=this._tileset,n=t&&t.computedTransform?t.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new _e.b(n).multiplyRight(this.transform);var i=t&&t._initialTransform?t._initialTransform.clone():new _e.b;this._initialTransform=new _e.b(i).multiplyRight(this.transform)}},{key:"_initializeBoundingVolumes",value:function(e){this._boundingVolume=Fo(e.boundingVolume,this.computedTransform),this._contentBoundingVolume=null,this._viewerRequestVolume=null,e.content&&e.content.boundingVolume&&(this._contentBoundingVolume=Fo(e.boundingVolume,this.computedTransform)),e.viewerRequestVolume&&(this._viewerRequestVolume=Fo(e.viewerRequestVolume,this.computedTransform))}},{key:"_initializeContent",value:function(e){this._content={_tileset:this._tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Gn.UNLOADED,this._expiredContent=void 0,this._serverKey=null,this.hasTilesetContent=!1,e.content&&(this.contentUri=e.content.uri||e.content.url,"url"in e&&(console.warn('Tileset 3D: "content.url" property deprecated. Use "content.uri" instead.'),this.contentUri=e.url),this._content=null,this.hasEmptyContent=!1,this.contentState=Gn.UNLOADED,this.fullUri="".concat(this._basePath,"/").concat(this.contentUri),this.id=this.fullUri)}},{key:"_initializeRenderingState",value:function(){this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=br.MASK_INDETERMINATE,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._priority=0}},{key:"_getRefine",value:function(e){switch(e){case"REPLACE":case"replace":return Zn;case"ADD":case"add":return Hn;default:return this.parent?this.parent.refine:Zn}}},{key:"_isTileset",value:function(e){return Boolean(e.asset)}},{key:"_contentLoaded",value:function(){switch(this._content&&this._content.type){case"vctr":case"geom":this.tileset.traverser.disableSkipLevelOfDetail=!0}this._isTileset(this._content)&&(this.hasTilesetContent=!0)}},{key:"_updateTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new _e.b,t=e.clone().multiplyRight(this.transform),r=!t.equals(this.computedTransform);if(r){this.computedTransform=t;var n=this._header,i=this._header.content;this._boundingVolume=Fo(n.boundingVolume,this.computedTransform,this._boundingVolume),this._contentBoundingVolume&&(this._contentBoundingVolume=Fo(i.boundingVolume,this.computedTransform,this._contentBoundingVolume)),this._viewerRequestVolume&&(this._viewerRequestVolume=Fo(n.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume))}}},{key:"gpuMemoryUsageInBytes",get:function(){return this._gpuMemoryUsageInBytes}},{key:"tileset",get:function(){return this._tileset}},{key:"depth",get:function(){return this._depth}},{key:"selectedFrame",get:function(){return this._selectedFrame}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"content",get:function(){return this._content}},{key:"contentReady",get:function(){return this._contentState===Gn.READY}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"contentAvailable",get:function(){return this.contentReady&&this.hasRenderContent||qo(this._expiredContent)&&!this.contentFailed}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this._contentState===Gn.UNLOADED}},{key:"contentExpired",get:function(){return this._contentState===Gn.EXPIRED}},{key:"contentFailed",get:function(){return this._contentState===Gn.FAILED}},{key:"url",get:function(){return this.tileset.getTileUrl(this.contentUri,this._basePath)}},{key:"uri",get:function(){return this.tileset.getTileUrl(this.contentUri,this._basePath)}},{key:"boundingVolume",get:function(){return this._boundingVolume}},{key:"contentBoundingVolume",get:function(){return this._contentBoundingVolume||this._boundingVolume}},{key:"boundingSphere",get:function(){return this._boundingVolume.boundingSphere}},{key:"extras",get:function(){return this._header.extras}},{key:"hasChildren",get:function(){return this.children.length>0||this._header.children&&this.children.length>0}}]),e}(),Wo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(I.a)(this,e),this._array=new Array(t),this._map=new Map,this._length=t}return Object(C.a)(e,[{key:"get",value:function(e){return lt(e<this._array.length),this._array[e]}},{key:"set",value:function(e,t){lt(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)}},{key:"delete",value:function(e){var t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)}},{key:"peek",value:function(){return this._array[this._length-1]}},{key:"push",value:function(e){if(!this._map.has(e)){var t=this.length++;this._array[t]=e,this._map.set(e,t)}}},{key:"pop",value:function(){var e=this._array[--this.length];return this._map.delete(e),e}},{key:"reserve",value:function(e){lt(e>=0),e>this._array.length&&(this._array.length=e)}},{key:"resize",value:function(e){lt(e>=0),this.length=e}},{key:"trim",value:function(e){null==e&&(e=this.length),this._array.length=e}},{key:"reset",value:function(){this._array=[],this._map=new Map,this._length=0}},{key:"find",value:function(e){return this._map.has(e)}},{key:"length",get:function(){return this._length},set:function(e){this._length=e,e>this._array.length&&(this._array.length=e)}},{key:"values",get:function(){return this._array}}]),e}();function Ho(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ho(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qo={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2},Yo=function(e){function t(){return Object(I.a)(this,t),Object(R.a)(this,Object(D.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(C.a)(t,[{key:"compareDistanceToCamera",value:function(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}},{key:"updateTileVisibility",value:function(e,t){if(e.updateVisibility(t),e.isVisibleAndInRequestVolume){var r=e.children.length>0;if(e.hasTilesetContent&&r){var n=e.children[0];return this.updateTileVisibility(n,t),void(e._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(e,t))e._visible=!1;else{var i=e.refine===Zn,a=e._optimChildrenWithinParent===Wn.USE_OPTIMIZATION;i&&a&&r&&!this.anyChildrenVisible(e,t)&&(e._visible=!1)}}}},{key:"meetsScreenSpaceErrorEarly",value:function(e,t){var r=e.parent;return!(!r||r.hasTilesetContent||r.refine!==Hn)&&!this.shouldRefine(e,t,!0)}}]),t}(function(){function e(t){Object(I.a)(this,e),this.options=Zo({},Qo,{},t),this._traversalStack=new Wo,this._emptyTraversalStack=new Wo,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}return Object(C.a)(e,[{key:"traverse",value:function(e,t,r){return this.root=e,this.options=Zo({},this.options,{},r),this.reset(),this.updateTile(e,t),!!this.canTraverse(e,t,!0)&&(this._frameNumber=t.frameNumber,this.executeTraversal(e,t),!0)}},{key:"reset",value:function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}},{key:"executeTraversal",value:function(e,t){var r=this._traversalStack;for(r.push(e);r.length>0;){var n=r.pop(),i=!1;this.canTraverse(n,t)&&(this.updateChildTiles(n,t),i=this.updateAndPushChildren(n,t,r));var a=n.parent,o=Boolean(!a||a._refines),s=!i;n.hasRenderContent?n.refine===Hn?(this.loadTile(n,t),this.selectTile(n,t)):n.refine===Zn&&(this.loadTile(n,t),s&&this.selectTile(n,t)):(this.emptyTiles[n.id]=n,this.loadTile(n,t),s&&this.selectTile(n,t)),this.touchTile(n,t),n._refines=i&&o}this.options.onTraverseEnd&&this.options.onTraverseEnd()}},{key:"updateChildTiles",value:function(e,t){var r=e.children,n=!0,i=!1,a=void 0;try{for(var o,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;this.updateTile(u,t)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return!0}},{key:"updateAndPushChildren",value:function(e,t,r){var n=this.options,i=n.loadSiblings,a=n.skipLevelOfDetail,o=e.children;o.sort(this.compareDistanceToCamera);var s=!a&&e.refine===Zn&&e.hasRenderContent,u=!0,c=!1,h=!0,l=!1,f=void 0;try{for(var d,y=o[Symbol.iterator]();!(h=(d=y.next()).done);h=!0){var v=d.value;if(v.isVisibleAndInRequestVolume?(r.find(v)&&r.delete(v),r.push(v),c=!0):(s||i)&&(this.loadTile(v,t),this.touchTile(v,t)),s){var p=void 0;p=!!v._inRequestVolume&&(v.hasRenderContent?v.contentAvailable:this.executeEmptyTraversal(v,t)),u=u&&p}}}catch(e){l=!0,f=e}finally{try{h||null==y.return||y.return()}finally{if(l)throw f}}return c||(u=!1),u}},{key:"updateTile",value:function(e,t){this.updateTileVisibility(e,t),e.updateExpiration()}},{key:"selectTile",value:function(e,t){this.shouldSelectTile(e,t)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.fullUri]=e)}},{key:"loadTile",value:function(e,t){this.shouldLoadTile(e,t)&&(e._requestedFrame=t.frameNumber,e._priority=this.getPriority(e),this.requestedTiles[e.id]=e)}},{key:"touchTile",value:function(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber}},{key:"canTraverse",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!(!n&&!e.isVisibleAndInRequestVolume)&&(!!e.hasChildren&&(e.hasTilesetContent?!e.contentExpired:this.shouldRefine(e,t,r)))}},{key:"shouldLoadTile",value:function(e,t){return e.hasUnloadedContent||e.contentExpired}},{key:"shouldSelectTile",value:function(e,t){return e.contentAvailable&&!this.options.skipLevelOfDetail}},{key:"shouldRefine",value:function(e,t,r){var n=e._screenSpaceError;return r&&(n=e.getScreenSpaceError(t,!0)),n>this.options.maximumScreenSpaceError}},{key:"updateTileVisibility",value:function(e,t){e.updateVisibility(t)}},{key:"compareDistanceToCamera",value:function(e,t){return e._distanceToCamera-t._distanceToCamera}},{key:"getPriority",value:function(e){var t=this.options;switch(e.refine){case Hn:return e._distanceToCamera;case Zn:var r=e.parent,n=r&&(!t.skipLevelOfDetail||0===e._screenSpaceError||r.hasTilesetContent)?r._screenSpaceError:e._screenSpaceError;return this.root._screenSpaceError-n;default:return lt(!1)}}},{key:"anyChildrenVisible",value:function(e,t){var r=!1,n=!0,i=!1,a=void 0;try{for(var o,s=e.children[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;u.updateVisibility(t),r=r||u.isVisibleAndInRequestVolume}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}},{key:"executeEmptyTraversal",value:function(e,t){for(var r=!0,n=this._emptyTraversalStack;n.length>0;){var i=n.pop();this.updateTile(i,t),i.isVisibleAndInRequestVolume||(this.loadTile(i,t),this.touchTile(i,t));var a=!i.hasRenderContent&&this.canTraverse(i,t,!1,!0);if(a||i.contentAvailable||(r=!1),a){var o=i.children.filter((function(e){return e})),s=!0,u=!1,c=void 0;try{for(var h,l=o[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var f=h.value;n.find(f)&&n.delete(f),n.push(f)}}catch(e){u=!0,c=e}finally{try{s||null==l.return||l.return()}finally{if(u)throw c}}}}return r}}]),e}()),Ko=function e(t,r,n){Object(I.a)(this,e),this.item=t,this.previous=r,this.next=n},Jo=function(e){return void 0!==e},Xo=function(){function e(){Object(I.a)(this,e),this.head=void 0,this.tail=void 0,this._length=0}return Object(C.a)(e,[{key:"add",value:function(e){var t=new Ko(e,this.tail,void 0);return Jo(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t}},{key:"remove",value:function(e){Jo(e)&&(Jo(e.previous)&&Jo(e.next)?(e.previous.next=e.next,e.next.previous=e.previous):Jo(e.previous)?(e.previous.next=void 0,this.tail=e.previous):Jo(e.next)?(e.next.previous=void 0,this.head=e.next):(this.head=void 0,this.tail=void 0),e.next=void 0,e.previous=void 0,--this._length)}},{key:"splice",value:function(e,t){if(e!==t){this.remove(t);var r=e.next;e.next=t,this.tail===e?this.tail=t:r.previous=t,t.next=r,t.previous=e}}},{key:"length",get:function(){return this._length}}]),e}(),$o=function(e){return void 0!==e},es=function(){function e(){Object(I.a)(this,e),this._list=new Xo,this._sentinel=this._list.add(),this._trimTiles=!1}return Object(C.a)(e,[{key:"reset",value:function(){this._list.splice(this._list.tail,this._sentinel)}},{key:"touch",value:function(e){var t=e.cacheNode;$o(t)&&this._list.splice(this._sentinel,t)}},{key:"add",value:function(e,t,r){$o(t.cacheNode)||(t.cacheNode=this._list.add(t),r&&r(e,t))}},{key:"unloadTile",value:function(e,t,r){var n=t.cacheNode;$o(n)&&(this._list.remove(n),t.cacheNode=void 0,r&&r(e,t))}},{key:"unloadTiles",value:function(e,t){var r=this._trimTiles;this._trimTiles=!1;for(var n=this._list,i=1024*e.maximumMemoryUsage*1024,a=this._sentinel,o=n.head;o!==a&&(e.gpuMemoryUsageInBytes>i||r);){var s=o.item;o=o.next,this.unloadTile(e,s,t)}}},{key:"trim",value:function(){this._trimTiles=!0}}]),e}();function ts(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var rs=6378137,ns=6378137,is=6356752.314245179,as=new _e.e;var os={basePath:"",ellipsoid:ot.WGS84,modelMatrix:new _e.b,throttleRequests:!1,maximumScreenSpaceError:8,maximumMemoryUsage:32,dynamicScreenSpaceError:!1,dynamicScreenSpaceErrorDensity:.00278,dynamicScreenSpaceErrorFactor:4,skipLevelOfDetail:!1,baseScreenSpaceError:1024,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(e,t,r){}};var ss=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(I.a)(this,e),lt(t),this.options=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ts(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},os,{},i),this.url=r,this.basePath=n.dirname(r),this.modelMatrix=this.options.modelMatrix,this.stats=new ct({id:r}),this._initializeStats(),this.gpuMemoryUsageInBytes=0,this.geometricError=void 0,this.userData={},this._queryParams={},this._requestScheduler=new wt({throttleRequests:this.options.throttleRequests}),this._traverser=new Yo,this._cache=new es,this._processingQueue=[],this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this.asset={},this.credits={},this.description=this.options.description,this._root=void 0,this._properties=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._extras=void 0,this._allTilesAdditive=!0,this._hasMixedContent=!1,this._maximumScreenSpaceError=this.options.maximumScreenSpaceError,this._maximumMemoryUsage=this.options.maximumMemoryUsage,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._readyPromise=Promise.resolve(),this._classificationType=this.options.classificationType,this._ellipsoid=this.options.ellipsoid,this._dynamicScreenSpaceErrorComputedDensity=0,this._initializeTileSet(t,this.options)}return Object(C.a)(e,[{key:"destroy",value:function(){this._destroy()}},{key:"getTileUrl",value:function(e,t){return e.startsWith("data:")?e:"".concat(t||this.basePath,"/").concat(e).concat(this.queryParams)}},{key:"hasExtension",value:function(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)}},{key:"update",value:function(e){var t;t="frameNumber"in e?e:Nr(e),this._updatedVisibilityFrame++,this._cache.reset(),this._traverser.traverse(this.root,t,this.options),this._requestedTiles=Object.values(this._traverser.requestedTiles),this.selectedTiles=Object.values(this._traverser.selectedTiles),this._emptyTiles=Object.values(this._traverser.emptyTiles);var r=this._requestedTiles,n=!0,i=!1,a=void 0;try{for(var o,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;this._loadTile(u,t)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}this._unloadTiles();var c=0,h=0,l=!0,f=!1,d=void 0;try{for(var y,v=this.selectedTiles[Symbol.iterator]();!(l=(y=v.next()).done);l=!0){var p=y.value;p.contentAvailable&&(c++,p.content.pointCount&&(h+=p.content.pointCount))}}catch(e){f=!0,d=e}finally{try{l||null==v.return||v.return()}finally{if(f)throw d}}return this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=c,this.stats.get("Points").count=h,t.frameNumber}},{key:"trimLoadedTiles",value:function(){this._cache.trim()}},{key:"addTileToCache",value:function(e){this._cache.add(this,e,(function(e,t){return e._addTileToCache(t)}))}},{key:"_initializeTileSet",value:function(e,t){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:t.attributions||[]},this._properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this._extras=e.extras,this._root=this._initializeTileHeaders(e,null,this.basePath),this._calculateViewProps()}},{key:"_calculateViewProps",value:function(){var e=this._root,t=e.boundingVolume.center;if(!t)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new _e.e,void(this.zoom=16);this.cartographicCenter=ot.WGS84.cartesianToCartographic(t,new _e.e),this.cartesianCenter=t,this.zoom=function(e){var t=e.halfAxes,r=e.radius,n=e.width,i=e.height;if(t){t.getColumn(0,as);var a=as.len();t.getColumn(1,as);var o=as.len();t.getColumn(2,as);var s=as.len();return(Math.log2(rs/a/2)+Math.log2(ns/o/2)+Math.log2(is/s/2))/3}return r?Math.log2(is/r):i&&n?(Math.log2(rs/n)+Math.log2(ns/i))/2:18}(e.boundingVolume)}},{key:"_initializeStats",value:function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")}},{key:"_initializeTileHeaders",value:function(e,t,r){var n=new Go(this,e.root,t,r);t&&(t.children.push(n),n._depth=t._depth+1);var i=[];for(i.push(n);i.length>0;){var a=i.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();var o=a._header.children||[],s=!0,u=!1,c=void 0;try{for(var h,l=o[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var f=h.value,d=new Go(this,f,a,r);a.children.push(d),d._depth=a._depth+1,i.push(d)}}catch(e){u=!0,c=e}finally{try{s||null==l.return||l.return()}finally{if(u)throw c}}}return n}},{key:"_destroyTileHeaders",value:function(e){this._destroySubtree(e)}},{key:"_loadTile",value:function(e,t){var r,n,i;return Me.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.stats.get("Tiles Loading").incrementCount(),a.prev=1,a.next=4,Me.a.awrap(e.loadContent(t));case 4:r=a.sent,a.next=16;break;case 7:return a.prev=7,a.t0=a.catch(1),this.stats.get("Tiles Loading").decrementCount(),this.stats.get("Failed Tile Loads").incrementCount(),n=a.t0.message||a.t0.toString(),i=e.url,console.error("A 3D tile failed to load: ".concat(e.url," ").concat(n)),this.options.onTileError(e,n,i),a.abrupt("return");case 16:if(this.stats.get("Tiles Loading").decrementCount(),r){a.next=19;break}return a.abrupt("return");case 19:e&&e._content&&Cr(e,e._content),this.options.onTileLoad(e);case 21:case"end":return a.stop()}}),null,this,[[1,7]])}},{key:"_addTileToCache",value:function(e){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=e._content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes}},{key:"_unloadTile",value:function(e){this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.gpuMemoryUsageInBytes-=e._content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}},{key:"_unloadTiles",value:function(){this._cache.unloadTiles(this,(function(e,t){return e._unloadTile(t)}))}},{key:"_destroy",value:function(){var e=[];for(this._root&&e.push(this._root);e.length>0;){var t=e.pop(),r=!0,n=!1,i=void 0;try{for(var a,o=t.children[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;e.push(s)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}t.destroy()}this._root=null}},{key:"_destroySubtree",value:function(e){var t=e,r=[];for(r.push(t);r.length>0;){e=r.pop();var n=!0,i=!1,a=void 0;try{for(var o,s=e.children[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;r.push(u)}}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}e!==t&&this._destroyTile(e)}t.children=[]}},{key:"_destroyTile",value:function(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}},{key:"traverser",get:function(){return this._traverser}},{key:"properties",get:function(){return this._properties}},{key:"ready",get:function(){return Boolean(this._root)}},{key:"readyPromise",get:function(){return this._readyPromise.promise}},{key:"tilesLoaded",get:function(){return this._tilesLoaded}},{key:"queryParams",get:function(){return function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push("".concat(i,"=").concat(e[i]))}switch(t.length){case 0:return"";case 1:return"?".concat(t[0]);default:return"?".concat(t.join("&"))}}(this._queryParams)}},{key:"root",get:function(){return this._root}},{key:"boundingSphere",get:function(){return this._checkReady(),this._root.updateTransform(this.modelMatrix),this._root.boundingSphere}},{key:"timeSinceLoad",get:function(){return this._timeSinceLoad}},{key:"maximumMemoryUsage",get:function(){return this._maximumMemoryUsage},set:function(e){lt(e>0),this._maximumMemoryUsage=e}},{key:"ellipsoid",get:function(){return this.options.ellipsoid}},{key:"extras",get:function(){return this._extras}}]),e}();function us(e){var t;return Me.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): "),r.prev=1,!e.headers.get("Content-Type").includes("application/json")){r.next=10;break}return r.t0=t,r.next=7,Me.a.awrap(e.text());case 7:t=r.t0+=r.sent,r.next=11;break;case 10:t+=e.statusText;case 11:r.next=16;break;case 13:return r.prev=13,r.t1=r.catch(1),r.abrupt("return",t);case 16:return r.abrupt("return",t);case 17:case"end":return r.stop()}}),null,null,[[1,13]])}function cs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cs(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ls="https://api.cesium.com/v1/assets";function fs(e,t){var r,n,i,a,o,s,u,c,h,l;return Me.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(t){f.next=23;break}return f.next=3,Me.a.awrap(ds(e));case 3:for(r=f.sent,n=!0,i=!1,a=void 0,f.prev=7,o=r.items[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)"3DTILES"===(u=s.value).type&&(t=u.id);f.next=15;break;case 11:f.prev=11,f.t0=f.catch(7),i=!0,a=f.t0;case 15:f.prev=15,f.prev=16,n||null==o.return||o.return();case 18:if(f.prev=18,!i){f.next=21;break}throw a;case 21:return f.finish(18);case 22:return f.finish(15);case 23:return f.next=25,Me.a.awrap(ys(e,t));case 25:return c=f.sent,h=c.type,l=c.url,lt("3DTILES"===h&&l),c.headers={Authorization:"Bearer ".concat(c.accessToken)},f.abrupt("return",c);case 30:case"end":return f.stop()}}),null,null,[[7,11,15,23],[16,,18,22]])}function ds(e){var t,r,n;return Me.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return lt(e),t=ls,r={Authorization:"Bearer ".concat(e)},i.next=5,Me.a.awrap(fetch(t,{headers:r}));case 5:if((n=i.sent).ok){i.next=12;break}return i.t0=Error,i.next=10,Me.a.awrap(us(n));case 10:throw i.t1=i.sent,new i.t0(i.t1);case 12:return i.next=14,Me.a.awrap(n.json());case 14:return i.abrupt("return",i.sent);case 15:case"end":return i.stop()}}))}function ys(e,t){var r,n,i,a,o;return Me.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return lt(e,t),r={Authorization:"Bearer ".concat(e)},n="".concat(ls,"/").concat(t),s.next=5,Me.a.awrap(fetch("".concat(n),{headers:r}));case 5:if((i=s.sent).ok){s.next=12;break}return s.t0=Error,s.next=10,Me.a.awrap(us(i));case 10:throw s.t1=s.sent,new s.t0(s.t1);case 12:return s.next=14,Me.a.awrap(i.json());case 14:return a=s.sent,s.next=17,Me.a.awrap(fetch("".concat(n,"/endpoint"),{headers:r}));case 17:if((i=s.sent).ok){s.next=24;break}return s.t2=Error,s.next=22,Me.a.awrap(us(i));case 22:throw s.t3=s.sent,new s.t2(s.t3);case 24:return s.next=26,Me.a.awrap(i.json());case 26:return o=s.sent,a=hs({},a,{},o),s.abrupt("return",a);case 29:case"end":return s.stop()}}))}function vs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ps(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vs(r,!0).forEach((function(t){Le()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vs(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var gs=function(e){function t(){return u()(this,t),f()(this,y()(t).apply(this,arguments))}var r,n;return m()(t,e),h()(t,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&b.log.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,n=e.changeFlags;if(t.data&&t.data!==r.data?this._loadTileset(t.data):!t._ionAccessToken&&!t._ionAssetId||t._ionAccessToken===r._ionAccessToken&&t._ionAssetId===r._ionAssetId||this._loadTilesetFromIon(t._ionAccessToken,t._ionAssetId),n.viewportChanged){var i=this.state.tileset3d;this._updateTileset(i)}}},{key:"_loadTileset",value:(n=Ne()(Me.a.mark((function e(t,r,n){var i,a,o,s,u=this;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,r);case 2:return i=e.sent,e.next=5,i.json();case 5:a=e.sent,o=this.getLoadOptions(),s=new ss(a,t,ps({onTileLoad:function(e){u.props.onTileLoad(e),u._updateTileset(s)},onTileUnload:this.props.onTileUnload,onTileLoadFail:this.props.onTileError,fetchOptions:r},n,{},o)),this.setState({tileset3d:s,layerMap:{}}),s&&(this._updateTileset(s),this.props.onTilesetLoad(s));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_loadTilesetFromIon",value:(r=Ne()(Me.a.mark((function e(t,r){var n,i,a;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fs(t,r);case 2:return n=e.sent,i=n.url,a=n.headers,e.next=6,this._loadTileset(i,{headers:a},n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"_updateTileset",value:function(e){var t=this.context,r=t.timeline,n=t.viewport;if(r&&n&&e){var i=e.update(n);this._updateLayerMap(i)}}},{key:"_updateLayerMap",value:function(e){var t=this.state,r=t.tileset3d,n=t.layerMap,i=r.selectedTiles.filter((function(e){return!n[e.fullUri]})),a=!0,o=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var h=u.value;r.addTileToCache(h),n[h.fullUri]={layer:this._create3DTileLayer(h),tile:h}}}catch(e){o=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw s}}this._selectLayers(e)}},{key:"_selectLayers",value:function(e){for(var t=this.state.layerMap,r=0,n=Object.values(t);r<n.length;r++){var i=n[r],a=i.tile,o=i.layer;a.selectedFrame===e?o&&o.props&&!o.props.visible&&(o=o.clone({visible:!0}),t[a.fullUri].layer=o):a.contentUnloaded?delete t[a.fullUri]:o&&o.props&&o.props.visible&&(o=o.clone({visible:!1}),t[a.fullUri].layer=o)}this.setState({layers:Object.values(t).map((function(e){return e.layer}))})}},{key:"_create3DTileLayer",value:function(e){if(!e.content)return null;switch(e.content.type){case"pnts":return this._createPointCloudTileLayer(e);case"i3dm":case"b3dm":return this._create3DModelTileLayer(e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}},{key:"_create3DModelTileLayer",value:function(e){var t=e.content,r=t.gltf,n=t.instances,i=t.cartographicOrigin,a=t.modelMatrix;return new(this.getSubLayerClass("scenegraph",b.ScenegraphLayer))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.fullUri),data:n||[{}],scenegraph:r,coordinateSystem:b.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:i,modelMatrix:a,getTransformMatrix:function(e){return e.modelMatrix},getPosition:function(e){return[0,0,0]}})}},{key:"_createPointCloudTileLayer",value:function(e){var t=e.content,r=t.attributes,n=t.pointCount,i=t.constantRGBA,a=t.cartographicOrigin,o=t.modelMatrix,s=r.positions,u=r.normals,c=r.colors;if(!s)return null;var h=this.props,l=h.pointSize,f=h.getPointColor;return new(this.getSubLayerClass("pointcloud",b.PointCloudLayer))({pointSize:l},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.fullUri),data:{header:{vertexCount:n},attributes:{POSITION:s,NORMAL:u,COLOR_0:c}},coordinateSystem:b.COORDINATE_SYSTEM.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:i||f})}},{key:"renderLayers",value:function(){return this.state.layers}}]),t}(b.CompositeLayer);gs.layerName="Tile3DLayer",gs.defaultProps={getPointColor:[0,0,0],pointSize:1,data:null,_ionAssetId:null,_ionAccessToken:null,loadOptions:{throttleRequests:!0},onTilesetLoad:function(e){},onTileLoad:function(e){},onTileUnload:function(e){},onTileError:function(e,t,r){}},r.d(t,"GreatCircleLayer",(function(){return w})),r.d(t,"S2Layer",(function(){return L})),r.d(t,"TileLayer",(function(){return ve})),r.d(t,"TripsLayer",(function(){return pe})),r.d(t,"H3ClusterLayer",(function(){return be})),r.d(t,"H3HexagonLayer",(function(){return Se})),r.d(t,"Tile3DLayer",(function(){return gs}))},,,function(e,t,r){"use strict";(function(e,n){r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var i=r(10),a=("undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof document&&document,"object"!==(void 0===n?"undefined":Object(i.a)(n))||"[object process]"!==String(n)||n.browser),o=void 0!==n&&n.version&&n.version.match(/v([0-9]*)/),s=o&&parseFloat(o[1])||0}).call(this,r(38),r(43))}])}));